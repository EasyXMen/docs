==============
UdpNm
==============

ç›®çš„
====

æœ¬é›†æˆæ‰‹å†Œç”¨äºæŒ‡å¯¼å®¢æˆ·è¿›è¡ŒUdpNmé›†æˆï¼Œæ–‡æ¡£ä¸»è¦åŒ…æ‹¬çš„å†…å®¹ä¸ºï¼šåè®®æ ˆé›†æˆæŒ‡å¯¼ã€åŸºäºæ™®é€šåº”ç”¨çš„é›†æˆç¤ºä¾‹è®²è§£ã€é¡¹ç›®é›†æˆç‰¹æ®Šè¯´æ˜ã€‚

ç”±äºå„é¡¹ç›®çš„éœ€æ±‚ä¸åŒï¼Œé›†æˆç¤ºä¾‹ä¸ä¼šé’ˆå¯¹äºç‰¹å®šçš„å•†ä¸šé¡¹ç›®åšè¯¦ç»†è®²è§£ã€‚

ç¼©å†™è¯å’Œæœ¯è¯­
============

.. table:: è¡¨ ç¼©å†™è¯å’Œæœ¯è¯­

   +-----------------+---------------------------------------------------------+
   | **ç¼©å†™è¯/æœ¯è¯­** | **æè¿°**                                                |
   +=================+=========================================================+
   | SoAd            | Socket Adapter å¥—æ¥å­—é€‚é…æ¨¡å—                           |
   +-----------------+---------------------------------------------------------+
   | UdpNm           | UDP Network Management ä»¥å¤ªç½‘ç½‘ç»œç®¡ç†æ¨¡å—               |
   +-----------------+---------------------------------------------------------+
   | EthSM           | Ethernet State Manager ä»¥å¤ªç½‘çŠ¶æ€æ§åˆ¶æ¨¡å—               |
   +-----------------+---------------------------------------------------------+
   | Nm              | Generic Network Management Interface                    |
   |                 | é€šç”¨ç½‘ç»œç®¡ç†æ¥å£æ¨¡å—                                    |
   +-----------------+---------------------------------------------------------+
   | ComM            | Communication Manager é€šä¿¡ç®¡ç†æ¨¡å—                      |
   +-----------------+---------------------------------------------------------+
   | RTE             | Runtime Enviroment è™šæ‹Ÿè¿è¡Œç¯å¢ƒ                         |
   +-----------------+---------------------------------------------------------+
   | SWC             | Software Component è½¯ä»¶ç»„ä»¶                             |
   +-----------------+---------------------------------------------------------+

å‚è€ƒæ–‡æ¡£
========

[1] å‚è€ƒæ‰‹å†Œ_EthIf.pdf

[2] å‚è€ƒæ‰‹å†Œ_EthSM.pdf

[3] å‚è€ƒæ‰‹å†Œ_TcpIp.pdf

[4] å‚è€ƒæ‰‹å†Œ_SoAd.pdf

[5] å‚è€ƒæ‰‹å†Œ_NmIf.pdf

[6] å‚è€ƒæ‰‹å†Œ_UdpNm.pdf

[7] å‚è€ƒæ‰‹å†Œ_ComM.pdf

åè®®æ ˆé›†æˆ
==========

æ–°å»ºORIENTAISå·¥ç¨‹
-----------------

#. å®‰è£…ORIENTAIS Studioè½¯ä»¶åï¼ŒåŒå‡»è½¯ä»¶å›¾æ ‡æ‰“å¼€è½¯ä»¶ã€‚

   |image1|

   å›¾ æ–°å»ºå·¥ç¨‹-1

#. èœå•æ FileğŸ¡ªNewğŸ¡ªProjectï¼Œæ–°å»ºå·¥ç¨‹ã€‚

   |image2|

   å›¾ æ–°å»ºå·¥ç¨‹-2

#. åœ¨å¼¹å‡ºçš„æ–°å»ºçª—å£ä¸­é€‰æ‹©Autosarä¸‹çš„ [BSW Project]ï¼Œé€‰æ‹©Nextã€‚

   |image3|

   å›¾ æ–°å»ºå·¥ç¨‹-3

#. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥å·¥ç¨‹åï¼Œé€‰æ‹©Finishã€‚

   |image4|
   
   å›¾ æ–°å»ºå·¥ç¨‹-4

#. åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©Yesã€‚

   |image5|

   å›¾ æ–°å»ºå·¥ç¨‹-5

#. é€‰æ‹©[Bsw_Builder]ï¼Œå³é”®å•å‡»ï¼Œé€‰æ‹©New ECU Configurationã€‚

   |image6|

   å›¾ æ–°å»ºå·¥ç¨‹-6

#. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥ECUåï¼Œç„¶åé€‰æ‹©Nextã€‚

   |image7|

   å›¾ æ–°å»ºå·¥ç¨‹-7

#. åœ¨å¼¹å‡ºçš„çª—å£ä¸­å‹¾é€‰éœ€æ·»åŠ çš„æ¨¡å—ï¼Œç‚¹å‡»Finishã€‚

   |image8|

   å›¾ æ–°å»ºå·¥ç¨‹-8

é…ç½®æ–‡ä»¶ç”Ÿæˆ
------------

æ¨¡å—é…ç½®
~~~~~~~~

æ¨¡å—çš„å…·ä½“é…ç½®ï¼Œå–å†³äºå…·ä½“çš„é¡¹ç›®éœ€æ±‚ã€‚UdpNmå„æ¨¡å—é…ç½®é¡¹çš„è¯¦ç»†ä»‹ç»ï¼Œå‚è§ã€Šå‚è€ƒæ‰‹å†Œ_UdpNm.pdfã€‹ã€‚

é…ç½®ä»£ç ç”Ÿæˆ
~~~~~~~~~~~~

#. åœ¨ORIENTAIS
   Stuidoä¸»ç•Œé¢å·¦æ–¹ï¼Œé€‰æ‹©å¯¹åº”çš„åè®®æ ˆï¼Œæˆ–è€…é€‰æ‹©æ•´ä¸ªECUï¼Œå•å‡»å³é”®å¼¹å‡ºValidate
   Allå’ŒGenerate Allèœå•ã€‚

   |image9|

   å›¾ é…ç½®ä»£ç çš„ç”Ÿæˆ-1

#. é€‰æ‹©Validate
   Allå¯¹æœ¬åè®®æ ˆå„é…ç½®é€‰é¡¹è¿›è¡Œæ ¡éªŒï¼Œæ²¡æœ‰é”™è¯¯æç¤ºä¿¡æ¯å³æ ¡éªŒé€šè¿‡ã€‚è‹¥æœ‰é”™è¯¯ä¿¡æ¯ï¼Œè¯·æŒ‰ç…§é”™è¯¯æç¤ºä¿®æ”¹ã€‚

#. é€‰æ‹©Generate
   Allï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚å³ä¸‹è§’çš„Consoleçª—å£è¾“å‡ºç”Ÿæˆçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚

   |image10|

   å›¾ é…ç½®ä»£ç çš„ç”Ÿæˆ-2

#. å°†ORIENTAIS Studioåˆ‡æ¢åˆ°Resourceæ¨¡å¼ï¼Œå³å¯æŸ¥çœ‹ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

   |image11|

   å›¾ é…ç½®ä»£ç çš„ç”Ÿæˆ-3

åŠŸèƒ½é›†æˆ
--------

ä»£ç é›†æˆ
~~~~~~~~

åè®®æ ˆä»£ç åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šé¡¹ç›®æä¾›çš„åè®®æ ˆæºç å’ŒORIENTAIS
Studioé…ç½®ç”Ÿæˆä»£ç ã€‚

ç”¨æˆ·é¡»å°†åè®®æ ˆæºç å’Œç« èŠ‚ï¼ˆé…ç½®ä»£ç ç”Ÿæˆï¼‰ç”Ÿæˆçš„æºä»£ç æ·»åŠ åˆ°é›†æˆå¼€å‘å·¥å…·çš„å¯¹åº”æ–‡ä»¶å¤¹ã€‚åè®®æ ˆé›†æˆçš„æ–‡ä»¶ç»“æ„ï¼Œè§ç« èŠ‚ï¼ˆæºä»£ç é›†æˆï¼‰ã€‚

.. note::
   **åè®®æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬åè®®æ ˆç›¸å…³çš„å…¶ä»–åè®®æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

é›†æˆæ³¨æ„äº‹é¡¹
~~~~~~~~~~~~

å¯¹äºé›†æˆè¿‡ç¨‹ä¸­ï¼Œåè®®æ ˆç‰¹æ®Šè¦æ±‚å’Œç”¨æˆ·ç»å¸¸å‡ºç°çš„é—®é¢˜ï¼Œå½’ç±»æ€»ç»“å½¢æˆä¸‹è¡¨ã€‚ç”¨æˆ·éœ€é€ä¸€æ’æŸ¥è¡¨ä¸­çš„çº¦æŸé¡¹ï¼Œä»¥é¿å…é›†æˆé—®é¢˜å‡ºç°ã€‚

è¡¨ UDPNMé›†æˆçº¦æŸæ¸…å•

+----------+----------+-------------------------------------------------------------------------------------+
| **ç¼–å·** | **ç±»åˆ«** | **çº¦æŸé™åˆ¶**                                                                        |
+==========+==========+=====================================================================================+
| **1**    | å †æ ˆ     | ç”¨æˆ·éœ€ç¡®ä¿ä¸ºä»»åŠ¡å †æ ˆå’Œä¸­æ–­å †æ ˆåˆ†é…è¶³å¤Ÿçš„å †æ ˆç©ºé—´ã€‚                                  |
+----------+----------+-------------------------------------------------------------------------------------+
| **2**    | å¤´æ–‡ä»¶   | - æ·»åŠ åè®®æ ˆä»£ç ä¹‹åï¼Œç”¨æˆ·éœ€æ›´æ–°é›†æˆå¼€å‘å·¥å…·ä¸­çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚                        |
|          |          |                                                                                     |
|          |          | - è°ƒç”¨åè®®æ ˆAPIçš„æºæ–‡ä»¶ï¼Œéœ€è¦åŒ…å«åè®®æ ˆçš„å¤´æ–‡ä»¶ã€‚                                   |
+----------+----------+-------------------------------------------------------------------------------------+
| **3**    | åˆå§‹åŒ–   | UdpNmè¯Šæ–­æ ˆçš„åˆå§‹åŒ–é¡ºåºä¸ºï¼šEthIf_Initã€TcpIp_Initã€SoAd_Initã€                      |
|          |          | EthSM_Initã€UdpNm_Initã€ Nm_Initå’ŒComM_Initã€‚                                       |
+----------+----------+-------------------------------------------------------------------------------------+
| **4**    | å‘¨æœŸå‡½æ•° | UdpNm_MainFunctionï¼ŒEthSM_MainFunctionå’ŒComM_MainFunctionéœ€è¦è¢«å‘¨æœŸæ€§ä»»åŠ¡å‡½æ•°è°ƒç”¨ã€‚ |
|          |          |                                                                                     |
|          |          | EthSMçš„è°ƒåº¦å‘¨æœŸå¿…é¡»å¤§äºComMçš„è°ƒåº¦å‘¨æœŸ                                               |
+----------+----------+-------------------------------------------------------------------------------------+

é›†æˆç¤ºä¾‹
========

é›†æˆç›®æ ‡
--------

æœ¬æ‰‹å†Œä¼šä»¥ä»¥ä¸‹å‚æ•°ä½œä¸ºç¤ºä¾‹ï¼Œè¿›è¡Œé›†æˆæ¼”ç¤ºã€‚

è¡¨ UDPNMé›†æˆå‚æ•°è¡¨

+-------------------------+--------------------------------------------+
| **å‚æ•°**                | **å€¼**                                     |
+=========================+============================================+
| å¿«å‘å‘¨æœŸ                | 50ms                                       |
+-------------------------+--------------------------------------------+
| å¿«å‘æ¬¡æ•°                | 10                                         |
+-------------------------+--------------------------------------------+
| æ­£å¸¸å‘é€å‘¨æœŸ            | 500ms                                      |
+-------------------------+--------------------------------------------+
| èŠ‚ç‚¹Id                  | 50                                         |
+-------------------------+--------------------------------------------+
| RepeatStateæ—¶é—´         | 2s                                         |
+-------------------------+--------------------------------------------+
| Nm-Timeoutæ—¶é—´          | 5s                                         |
+-------------------------+--------------------------------------------+
| WaitBusSleepæ—¶é—´        | 1.5s                                       |
+-------------------------+--------------------------------------------+
| Socketä¿¡æ¯              | æœ¬åœ°ï¼š172.31.30.78/ UDP/30500              |
|                         |                                            |
|                         | è¿œç«¯ï¼š239.192.255.250/UDP/30500            |
+-------------------------+--------------------------------------------+


æ¨¡å—é…ç½®
--------

EcuCæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. åŒå‡»EcuCæ¨¡å—ï¼Œæ‰“å¼€EcuCæ¨¡å—é…ç½®ç•Œé¢ã€‚

#. åœ¨EcucConfigSetsæ ç›®ä¸Šå³é”®ï¼Œé€‰æ‹©EcucConfigSetã€‚å†åœ¨EcucConfigSetä¸Šå³é”®ï¼Œé€‰æ‹©NewğŸ¡ª
   EcucConfigSetã€‚å†åœ¨EcucPduCollectionsä¸Šå³é”®ï¼Œé€‰æ‹©New
   EcucPduCollectionã€‚

   #. PduIdTypeEnum é€‰æ‹©UINT16ã€‚

   #. PduLengthTypeEnum é€‰æ‹©UINT16ã€‚

   |image12|

   å›¾ é…ç½®EcucPduCollection

#. åœ¨EcucPduCollectionä¸Šå³é”®ï¼Œé€‰æ‹©Pduï¼Œä¼šç”Ÿæˆä¸€ä¸ªPduçš„é…ç½®ç•Œé¢ã€‚

   #. å»ºè®®ä¸è¦ä½¿ç”¨é»˜è®¤ç”Ÿæˆçš„Pduåå­—ï¼ˆå¦‚ï¼šPdu_0ï¼‰ï¼Œå°†Pduåå­—æ”¹æˆæœ‰æ„ä¹‰çš„åå­—å¯¹åç»­çš„é…ç½®è¿‡ç¨‹å°†ä¼šæœ‰å¾ˆå¤§å¸®åŠ©ã€‚

   #. è¿™é‡ŒæŒ‰ç…§å‘é€å’Œæ¥æ”¶ï¼Œå¯ä»¥å°†Pduåå­—æ”¹ä¸ºæŠ¥æ–‡çš„åå­—ã€‚PduLengthï¼šPdué•¿åº¦ï¼Œæ ¹æ®å®é™…ä½¿ç”¨å¸§çš„é•¿åº¦è®¾ç½®ã€‚

   #. ç”±äºUdpNmçš„æ”¶å‘æŠ¥æ–‡ä¸éœ€è¦PduRæ¥è·¯ç”±ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘ï¼ˆå‘é€/æ¥æ”¶ï¼‰åªéœ€è¦é…ç½®ä¸€ä¸ªPduã€‚å¯¹äºéœ€è¦PduRè·¯ç”±çš„æŠ¥æ–‡ï¼Œæ¯ä¸ªæ–¹å‘éœ€è¦åˆ›å»º2ä¸ªPduã€‚

   |image13|

   å›¾ é…ç½®Pdu-1

   |image14|

   å›¾ é…ç½®Pdu-2

#. ECUCæ¨¡å—åˆ°æ­¤é…ç½®ç»“æŸã€‚å¯ä»¥åœ¨æ¨¡å—ä¸Šå³é”®ï¼Œç„¶åé€‰æ‹©æ ¡éªŒï¼ŒæŸ¥çœ‹æ˜¯å¦é…ç½®æœ‰é”™è¯¯ã€‚

#. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

SoAdæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. é…ç½®SoAdGeneralï¼Œä¸€èˆ¬é…ç½®è°ƒåº¦å‘¨æœŸï¼ŒSocketä¸ªæ•°å’ŒSocketGroupçš„ä¸ªæ•°ã€‚

   |image15|

   å›¾é…ç½®SoAdGeneral

#. é…ç½®SoAdBswModulesï¼Œè‹¥æ•°æ®æµéœ€è¦é€šè¿‡SoAdæ¨¡å—ï¼Œåˆ™éœ€è¦é…ç½®ã€‚æœ¬ä¾‹ä¸­åªæœ‰UdpNmã€‚æ‰€ä»¥åªéœ€è¦é…ç½®UdpNmã€‚

   |image16|

   å›¾ é…ç½®SoAdBswModules

#. é…ç½®SoAdConfigã€‚

   #. é…ç½®SoAdSocketGroupã€‚

      |image17|

      å›¾ é…ç½®SoAdSocketGroup

   #. é…ç½®SoAdSocketConnectionGroupã€‚UdpNmé‡‡ç”¨å¤šæ’­æ”¶å‘ï¼Œéœ€è¦é…ç½®2ä¸ªSocketã€‚åˆ†åˆ«ç”¨äºå‘é€å’Œæ¥æ”¶ã€‚

      |image18|

      å›¾ é…ç½®SoAdSocketConnectionGroup-1

      |image19|

      å›¾ é…ç½®SoAdSocketConnectionGroup-2

      |image20|

      å›¾ é…ç½®SoAdSocketConnectionGroup-3

      |image21|

      å›¾ é…ç½®SoAdSocketConnectionGroup-4

      |image22|

      å›¾ SoAdSocketConnectionGroup-5

      |image23|

      å›¾ é…ç½®SoAdSocketConnectionGroup-6

   #. é…ç½®SoAdRouteï¼Œå³æŠ¥æ–‡å‘é€ã€‚

      |image24|

      å›¾ é…ç½®SoAdRoute-1

      |image25|

      å›¾ é…ç½®SoAdRoute-2

   #. é…ç½®SoAdSocketRouteï¼Œå³æŠ¥æ–‡æ¥æ”¶ã€‚

      |image26|

      å›¾ é…ç½®SoAdSocketRoute-1

      |image27|

      å›¾ é…ç½®SoAdSocketRoute-2

#. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

ComMæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. ComMGeneralé¡µé¢ä¸€èˆ¬ä¸éœ€è¦é…ç½®ï¼Œä¿æŒé»˜è®¤å³å¯ã€‚

#. é…ç½®ComMConfigSeté¡µé¢ã€‚

   #. é¦–å…ˆé…ç½®ä¸€ä¸ªComMUserï¼Œé»˜è®¤å°±åˆ›å»ºäº†ä¸€ä¸ªã€‚

      |image28|

      å›¾ é…ç½®ComMUser

   #. é…ç½®ComMChannelï¼Œé»˜è®¤å°±åˆ›å»ºäº†ä¸€ä¸ªã€‚

   #. é…ç½®ComMBusTypeï¼Œé€‰æ‹©æœ¬é€šé“çš„æ€»çº¿ç±»å‹ã€‚è¿˜éœ€è¦é…ç½®ComMMainFunctionPeriodï¼Œè¡¨ç¤ºæœ¬é€šé“çš„è°ƒåº¦å‘¨æœŸã€‚

      |image29|

      å›¾ é…ç½®ComMChannels

   #. é…ç½®ComMNmVariantï¼Œè¡¨ç¤ºæœ¬é€šé“çš„ç±»å‹ã€‚FULLè¡¨ç¤ºé€šé“ç”±ç½‘ç»œç®¡ç†æ¥ç®¡ç†ã€‚LIGHTè¡¨ç¤ºæœ¬é€šé“æ²¡æœ‰ç½‘ç»œç®¡ç†ã€‚

      |image30|

      å›¾ é…ç½®ComMNmVariant

   #. æ¯ä¸ªChanneléœ€è¦å…³è”ä¸€ä¸ªUserï¼Œå¯¹äºå¤§å¤šæ•°å¸¸è§ï¼Œä¸€ä¸ªUserå°±ç­‰äºä¸€ä¸ªChannelã€‚

      |image31|

      å›¾ é…ç½®ComMUserPerChannel

#. ComMé…ç½®å®Œæˆï¼Œæ ¡éªŒã€‚

EthSMæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. é…ç½®EthSMGeneralã€‚è¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸ªè°ƒåº¦å‘¨æœŸï¼Œå°½å¯èƒ½å¿«ã€‚

   |image32|

   å›¾ é…ç½®EthSMGeneral

#. é…ç½®EthSMNetworkã€‚

   |image33|

   å›¾ é…ç½®EthSMNetwork

#. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

Nmæ¨¡å—é…ç½®
~~~~~~~~~~

#. é…ç½®NmChannelConfigï¼Œéœ€è¦é…ç½®2ä¸ªåœ°æ–¹ã€‚ç¬¬ä¸€ä¸ªæ˜¯NmChannelConfigï¼Œå…³è”åˆ°ComMçš„channelï¼Œç¬¬äºŒä¸ªéœ€è¦åˆ›å»ºNmStandardBusNmConfigï¼Œé€‰æ‹©ç½‘ç»œç®¡ç†ç±»å‹ã€‚

   |image34|

   å›¾ é…ç½®NmChannelConfig-1

   |image35|

   å›¾ é…ç½®NmChannelConfig-2

#. é…ç½®NmGlobalConfigï¼Œéœ€è¦é…ç½®NmGlobalConstantså’ŒNmGlobalFeaturesã€‚é…ç½®çš„é‡ç‚¹åœ¨NmGlobalFeaturesã€‚è¿™é‡Œä¸»è¦æ˜¯å…¨å±€é€‰æ‹©ç½‘ç»œç®¡ç†çš„åŠŸèƒ½ã€‚éƒ¨åˆ†åŠŸèƒ½è¿˜éœ€è¦åœ¨OsekNmä¸­é…ç½®ã€‚

   |image36|

   å›¾ é…ç½®NmGlobalConfig-1

   |image37|

   å›¾ é…ç½®NmGlobalConfig-2

#. Nmé…ç½®å®Œæˆï¼Œæ ¡éªŒã€‚

UdpNmæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. é…ç½®UdpNmGlobalConfigã€‚

   |image38|

   å›¾ é…ç½®UdpNmGlobalConfig

#. é…ç½®UdpNmChannelConfigï¼Œè¿™é‡Œä¸»è¦é…ç½®æ—¶é—´å‚æ•°ã€‚

   |image39|
   |image40|

   å›¾ é…ç½®UdpNmChannleConfig

#. é…ç½®æŠ¥æ–‡çš„æ”¶å‘ã€‚

   |image41|

   å›¾ é…ç½®UdpNmRxPdu

   |image42|

   å›¾ é…ç½®UdpNmTxPdu

#. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

æºç é›†æˆ
--------

é¡¹ç›®äº¤ä»˜ç»™ç”¨æˆ·çš„å·¥ç¨‹ç»“æ„å¦‚ä¸‹ï¼š

   |image43|

   å›¾ å·¥ç¨‹ç»“æ„ç›®å½•

- BSW_Cfgç›®å½•ï¼Œè¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾é…ç½®å·¥å…·ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼Œç½‘ç»œç®¡ç†æœ‰å…³çš„é…ç½®æ–‡ä»¶æ”¾åœ¨NMå’ŒUdpNmæ–‡ä»¶å¤¹ä¸­ã€‚

- srcç›®å½•ï¼Œå­˜æ”¾æ¨¡å—ç›¸å…³çš„æºä»£ç ã€‚å¯ä»¥çœ‹åˆ°Sourceç›®å½•ä¸‹å„ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯å„ä¸ªæ¨¡å—çš„æºä»£ç ã€‚

ç½‘ç»œç®¡ç†æºä»£ç é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. å°†ç« èŠ‚ï¼ˆæ¨¡å—çš„é…ç½®ï¼‰ä¸­ORIENTAIS
   Studioç”Ÿæˆçš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°Configæ–‡ä»¶å¤¹ä¸‹çš„å„ä¸ªæ¨¡å—çš„å¯¹åº”æ–‡ä»¶å¤¹ä¸­ã€ä¾‹å¦‚ï¼šConfig\\inc\\NMã€‘ã€‚

#. å°†é¡¹ç›®æä¾›çš„åè®®æ ˆæºä»£ç æ–‡ä»¶å¤åˆ¶åˆ°Sourceæ–‡ä»¶å¤¹ä¸‹çš„å¯¹åº”æ¨¡å—çš„æ–‡ä»¶å¤¹ä¸­ã€ä¾‹å¦‚ï¼šSourceS\\NMã€‘ã€‚

#. å°†æ‰€éœ€çš„å¤´æ–‡ä»¶åŒ…å«è¿›å·¥ç¨‹è®¾ç½®ä¸­ï¼Œå¦‚ä¸‹æ­¥éª¤ï¼š

   #. æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„ã€‚

   #. æ·»åŠ æ‰€éœ€çš„å¤´æ–‡ä»¶ã€‚

   #. æ·»åŠ è°ƒåº¦æ–‡ä»¶ï¼Œç‚¹å‡»åº”ç”¨ä¿å­˜ã€‚

   #. ç¼–è¯‘å·¥ç¨‹ã€‚

è°ƒåº¦é›†æˆ
--------

è°ƒåº¦é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. åè®®æ ˆè°ƒåº¦é›†æˆã€‚

#. ç¼–è¯‘é“¾æ¥ä»£ç ï¼Œå°†ç”Ÿæˆçš„elfæ–‡ä»¶çƒ§å†™è¿›èŠ¯ç‰‡ã€‚

UdpNmæœ‰å…³çš„ä»£ç ï¼Œåœ¨ä¸‹æ–¹çš„main.cæ–‡ä»¶ä¸­ç»™å‡ºé‡ç‚¹æ ‡æ³¨ã€‚

.. note::
   **æœ¬ç¤ºä¾‹ä¸­ï¼ŒUdpNmç½‘ç»œç®¡ç†åˆå§‹åŒ–çš„ä»£ç å’Œå¯åŠ¨é€šä¿¡çš„ä»£ç ç½®äºmain.cæ–‡ä»¶ï¼Œå¹¶ä¸ä»£è¡¨å…¶ä»–é¡¹ç›®åŒæ ·é€‚ç”¨äºå°†å…¶ç½®äºmain.cæ–‡ä»¶ä¸­ã€‚**

.. code-block:: c
   :linenos:
   :emphasize-lines: 6-14, 23-29, 32-33, 45, 61-63, 79-80

   #include "Timer.h"
   #include "Led.h"
   #include "Mcal.h"
   #include "UserTimer.h"
   // UdpNmåè®®æ ˆç›¸å…³æ¨¡å—å¤´æ–‡ä»¶
   #include "EthIf.h"
   #include "TcpIp.h"
   #include "SoAd.h"
   #include "EthSM.h"
   #include "Nm.h"
   #include "UdpNm.h"
   #include "ComM.h"
   #include "ComM_Internal.h"

   Com_IpduGroupVector g_ComIpduGroupVector;

   int main(void) 
   {
       McalUser_Init();
       Led_Init();

       // åˆå§‹åŒ–EthIfã€EthSMã€TcpIpã€SoAdã€Nmã€UdpNmã€ComMæ¨¡å—
       EthIf_Init(&EthIf_ConfigData);
       EthSM_Init();
       TcpIp_Init(&TcpIp_Config);
       SoAd_Init(&SoAd_Config);
       Nm_Init(&Nm_Config);
       UdpNm_Init(&UdpNm_Config);
       ComM_Init(&ComM_Config);
       
       // æ‰“å¼€é€šä¿¡ï¼šåˆå§‹åŒ–ç½‘ç»œç®¡ç†åŠUdpNmæ¨¡å—
       ComM_Channel[ComMChannel_Eth].CommunicationAllowed = TRUE;
       ComM_RequestComMode(ComMUser_Eth, COMM_FULL_COMMUNICATION);

       StartOS(OSDEFAULTAPPMODE);

       while (1);
   }

   /* OsTask_c0_1ms: Core0(CPU0), Type = BASIC, Priority = 8*/        
   TASK(OsTask_c0_1ms)
   {
       /* please insert your code here ... */
       // EthSMæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°
       EthSM_MainFunction();

       if (E_OK != TerminateTask())
       {
           while (1)
           {
               /* dead loop */
           }
       }
   }                             

   /* OsTask_c0_5ms: Core0(CPU0), Type = BASIC, Priority = 6*/        
   TASK(OsTask_c0_5ms)
   {
       /* please insert your code here ... */
       // ComMã€EthIfã€UdpNmæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°
       ComM_MainFunction(ComMUser_Eth);
       EthIf_MainFunctionState();
       UdpNm_MainFunction(0);

       if (E_OK != TerminateTask())
       {
           while (1)
           {
               /* dead loop */
           }
       }
   }      

   /* OsTask_c0_20ms: Core0(CPU0), Type = BASIC, Priority = 6*/ 
   TASK(OsTask_c0_20ms)
   {
       /* please insert your code here ... */
       // SoAdã€TcpIpæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°
       SoAd_MainFunction();
       TcpIp_MainFunction();
       
       if (E_OK != TerminateTask())
       {
           while (1)
           {
               /* dead loop */
           }
       }
   }

éªŒè¯ç»“æœ
--------

æ ¹æ®é›†æˆç›®æ ‡ï¼Œä½¿ç”¨Wiresharkå·¥å…·æŸ¥çœ‹æŠ¥æ–‡å‘é€æ–¹å¼æ˜¯å¦æ­£ç¡®ã€‚å‰10ä¸ªæŠ¥æ–‡å‘é€é—´éš”50msï¼Œåé¢æŠ¥æ–‡çš„é—´éš”æ˜¯500msï¼Œç¬¦åˆé›†æˆç›®æ ‡ã€‚

   |image44|

   å›¾ UdpNmæŠ¥æ–‡å‘é€ç¤ºä¾‹

.. |image1| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image2.png
   :width: 5.76736in
   :height: 2.9125in


.. |image2| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image3.png
   :width: 5.76736in
   :height: 2.9125in


.. |image3| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image4.png
   :width: 5.76736in
   :height: 2.9125in


.. |image4| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image5.png
   :width: 5.76736in
   :height: 2.9125in


.. |image5| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image6.png
   :width: 5.76736in
   :height: 2.9125in


.. |image6| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image7.png
   :width: 5.76736in
   :height: 2.9125in


.. |image7| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image8.png
   :width: 5.76736in
   :height: 2.9125in


.. |image8| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image9.png
   :width: 5.76736in
   :height: 6.9125in


.. |image9| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image10.png
   :width: 5.76736in
   :height: 2.9125in


.. |image10| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image11.png
   :width: 5.76736in
   :height: 2.9125in


.. |image11| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image12.png
   :width: 5.76736in
   :height: 2.9125in


.. |image12| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image13.png
   :width: 5.76736in
   :height: 2.9125in


.. |image13| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image14.png
   :width: 5.76736in
   :height: 2.9125in


.. |image14| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image15.png
   :width: 5.76736in
   :height: 2.9125in


.. |image15| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image16.png
   :width: 5.76736in
   :height: 2.9825in


.. |image16| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image17.png
   :width: 5.96736in
   :height: 2.9125in


.. |image17| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image18.png
   :width: 5.76736in
   :height: 2.9825in

.. |image18| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image19.png
   :width: 5.76736in
   :height: 2.9125in


.. |image19| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image20.png
   :width: 5.76736in
   :height: 2.9125in


.. |image20| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image21.png
   :width: 5.76736in
   :height: 2.9125in


.. |image21| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image22.png
   :width: 5.76736in
   :height: 2.9125in


.. |image22| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image23.png
   :width: 5.76736in
   :height: 2.9125in


.. |image23| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image24.png
   :width: 5.76736in
   :height: 2.9125in


.. |image24| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image25.png
   :width: 5.76736in
   :height: 2.9125in


.. |image25| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image26.png
   :width: 5.76736in
   :height: 2.9125in


.. |image26| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image27.png
   :width: 5.76736in
   :height: 2.9125in


.. |image27| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image28.png
   :width: 5.76736in
   :height: 2.9125in


.. |image28| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image29.png
   :width: 5.76736in
   :height: 2.9125in


.. |image29| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image30.png
   :width: 5.76736in
   :height: 2.9125in


.. |image30| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image31.png
   :width: 5.76736in
   :height: 2.9125in


.. |image31| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image32.png
   :width: 5.76736in
   :height: 2.9125in


.. |image32| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image33.png
   :width: 5.76736in
   :height: 2.9125in


.. |image33| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image34.png
   :width: 5.76736in
   :height: 2.9125in


.. |image34| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image35.png
   :width: 5.76736in
   :height: 2.9125in


.. |image35| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image36.png
   :width: 5.76736in
   :height: 2.9125in


.. |image36| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image37.png
   :width: 5.76736in
   :height: 2.9125in


.. |image37| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image38.png
   :width: 5.76736in
   :height: 2.9125in


.. |image38| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image39.png
   :width: 5.76736in
   :height: 2.9125in


.. |image39| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image40.png
   :width: 5.76736in
   :height: 2.9125in


.. |image40| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image41.png
   :width: 5.76736in
   :height: 2.9125in


.. |image41| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image42.png
   :width: 5.76736in
   :height: 2.9125in


.. |image42| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image43.png
   :width: 5.76736in
   :height: 2.9125in


.. |image43| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image44.png
   :width: 5.76736in
   :height: 3.9125in


.. |image44| image:: /_static/é›†æˆæ‰‹å†Œ/é›†æˆæ‰‹å†Œ_UdpNm/image45.png
   :width: 5.76736in
   :height: 4.9125in