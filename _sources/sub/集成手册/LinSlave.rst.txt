===================
LINSlave_é›†æˆæ‰‹å†Œ
===================





ç›®çš„
====

æœ¬æ–‡æ¡£æ—¨åœ¨é€šè¿‡ä¸€ä¸ªLINé€šä¿¡çš„ç¤ºä¾‹å·¥ç¨‹çš„é…ç½®ï¼Œå‘ç”¨æˆ·å±•ç¤ºé€šä¿¡æ ˆçš„é›†æˆè¿‡ç¨‹ã€‚

ç”±äºå„é¡¹ç›®çš„éœ€æ±‚ä¸åŒï¼Œé›†æˆç¤ºä¾‹ä¸ä¼šé’ˆå¯¹äºç‰¹å®šçš„å•†ä¸šé¡¹ç›®åšè¯¦ç»†è®²è§£ã€‚

ç¼©å†™è¯å’Œæœ¯è¯­
============

.. table:: è¡¨æ ¼ 2â€‘1 ç¼©å†™è¯å’Œæœ¯è¯­

   +---------------+------------------------------------------------------+
   | **            | **æè¿°**                                             |
   | ç¼©å†™è¯/æœ¯è¯­** |                                                      |
   +---------------+------------------------------------------------------+
   | BSW           | Basic Software åŸºç¡€è½¯ä»¶                              |
   +---------------+------------------------------------------------------+
   | BswM          | Basic Software Mode Manager åŸºç¡€è½¯ä»¶æ¨¡å¼ç®¡ç†         |
   +---------------+------------------------------------------------------+
   | MCAL          | Microcontroller Abstraction Layer å¾®æ§åˆ¶å™¨æŠ½è±¡å±‚     |
   +---------------+------------------------------------------------------+
   | LinIF         | LIN Interface LINæ¥å£                                |
   +---------------+------------------------------------------------------+
   | LinSM         | LIN State Manager LINçŠ¶æ€ç®¡ç†                        |
   +---------------+------------------------------------------------------+
   | ComM          | Communication Manager é€šä¿¡ç®¡ç†                       |
   +---------------+------------------------------------------------------+
   | EcuM          | ECU State Manager ECUçŠ¶æ€ç®¡ç†                        |
   +---------------+------------------------------------------------------+
   | SchM          | Scheduler Manager è°ƒåº¦ç®¡ç†                           |
   +---------------+------------------------------------------------------+

å‚è€ƒæ–‡æ¡£
========

[1]å‚è€ƒæ‰‹å†Œ_PduR.pdf

[2]å‚è€ƒæ‰‹å†Œ_Com.pdf

[3]å‚è€ƒæ‰‹å†Œ_EcuC.pdf

[4]å‚è€ƒæ‰‹å†Œ_ComM.pdf

[5]å‚è€ƒæ‰‹å†Œ_LinSM.pdf

[6]å‚è€ƒæ‰‹å†Œ_LinIf.pdf

åè®®æ ˆé›†æˆ
==========

é¡¹ç›®äº¤ä»˜çš„å†…å®¹ä¸ºï¼šé€šä¿¡æ ˆæºç å’ŒORIENTAIS
Configuratoré…ç½®å·¥å…·ã€‚é€šä¿¡æ ˆç»†åˆ†ä¸ºé€šä¿¡æ ˆçš„å„æ¨¡å—åŠå…¶å¯¹åº”çš„é…ç½®å·¥å…·æ¨¡å—ã€‚

é€šä¿¡æ ˆå„é…ç½®æ¨¡å—çš„åŠŸèƒ½ä»‹ç»ï¼Œå‚è§è¡¨ 4 1é€šä¿¡æ ˆå„é…ç½®æ¨¡å—ä»‹ç»ã€‚

ä½¿ç”¨é€šä¿¡æ ˆæºç å’Œé…ç½®å·¥å…·ï¼Œè¿›è¡Œé€šä¿¡æ ˆçš„é›†æˆçš„æ­¥éª¤ï¼Œå‚è§è¡¨ 4 2
é€šä¿¡æ ˆé›†æˆçš„æ­¥éª¤ã€‚

.. table:: 4â€‘1æ¨¡å—åŠŸèƒ½ä»‹ç»

   +---------+------------------------------------------------------------+
   | **æ¨¡    | **åŠŸèƒ½**                                                   |
   | å—å**  |                                                            |
   +---------+------------------------------------------------------------+
   | Lin     | Liné©±åŠ¨é…ç½®ã€‚(ç”±MCALå·¥å…·å¯¼å…¥)                              |
   +---------+------------------------------------------------------------+
   | LinIf   | LinIfæ¨¡å—ä¸»è¦å¤„ç†ä¸Šå±‚æ¨¡å—ä¸åº•å±‚é©±åŠ¨çš„ä¹‹é—´                  |
   |         | PDUçš„ä¼ é€’ï¼Œä¸ºä¸Šå±‚æ¨¡å—æä¾›ç»Ÿä¸€çš„æ¥å£æ¥ç®¡ç†ä¸åŒçš„Linç¡¬ä»¶æ¨¡å— |
   +---------+------------------------------------------------------------+
   | EcuC    | ç”¨äºè¾…åŠ©é…ç½®å·¥å…·å®Œæˆé…ç½®çš„æ¨¡å—ã€‚ä¸»                         |
   |         | è¦æä¾›Pduçš„å®šä¹‰ï¼Œå…¶å®ƒæ¨¡å—é€šè¿‡å…³è”EcuCä¸­Pduï¼Œç›¸äº’å…³è”èµ·æ¥ã€‚ |
   +---------+------------------------------------------------------------+
   | PduR    | PDU Routerä¸»è¦ä¸ºé€šè®¯æ¥å£æ¨¡å—ï¼ˆLINIFï¼‰ã€ä¼ è¾“åè®®æ¨¡å—ï¼ˆLIN   |
   |         | TPã€J1939                                                  |
   |         | TPï¼‰ã€è¯Šæ–­é€šè®¯ç®¡ç†æ¨¡å—ï¼ˆDCMã€J1939DCMï¼‰ä»¥åŠé€šè®¯æ¨¡å—ï¼ˆC     |
   |         | OMã€LDCOMï¼‰ä»¥åŠIPDUMã€SECOCç­‰æ¨¡å—æä¾›åŸºäºI-PDUçš„è·¯ç”±æœåŠ¡ã€‚ |
   +---------+------------------------------------------------------------+
   | Com     | COMæ¨¡å—ä¸»è¦æä¾›I-PDUå’Œä¿¡å·ç›¸å…³ç®¡ç†åŠŸèƒ½                     |
   +---------+------------------------------------------------------------+
   | ComM    | ComMæ¨¡å—ä¸»è¦è¿›è¡Œé€šä¿¡çš„ç®¡ç†åŠŸèƒ½ã€‚                           |
   |         | ComMæ¨¡å—æ”¶é›†ç”¨æˆ·çš„æ€»çº¿è®¿é—®è¯·æ±‚ï¼Œå¹¶æŠŠè¯·æ±‚è½¬å‘åˆ°ä¸åŒçš„æ€»çº¿ã€‚ |
   +---------+------------------------------------------------------------+
   | LinSM   | ä¸»è¦åŠŸ                                                     |
   |         | èƒ½æ˜¯ä¸é€šä¿¡ç¡¬ä»¶æŠ½è±¡å±‚å’Œç³»ç»ŸæœåŠ¡å±‚äº§ç”Ÿäº¤äº’ï¼Œä¸ºæ¯ä¸€ä¸ªLiné€šä¿¡  |
   |         | æ€»çº¿å®šä¹‰ä¸€ä¸ªæ€»çº¿ç›¸å…³çš„çŠ¶æ€ç®¡ç†ï¼Œå¹¶ä¸ºç›¸å…³çš„æ€»çº¿æä¾›æµæ§åˆ¶ã€‚ |
   +---------+------------------------------------------------------------+

.. table:: 4â€‘2 é›†æˆæ­¥éª¤ä»‹ç»

   +-----+--------------------------+------------------------------------+
   | *   | **æ“ä½œ**                 | **è¯´æ˜**                           |
   | *æ­¥ |                          |                                    |
   | éª¤  |                          |                                    |
   | **  |                          |                                    |
   +-----+--------------------------+------------------------------------+
   | 1   | ORIENTAIS                | è‹¥é…ç½®å·¥å…·å·²ç»æ­å»º                 |
   |     | Configuratoré…ç½®å·¥å…·     | ï¼Œåˆ™ä»…éœ€è¿›è¡Œé€šä¿¡æ ˆæ¨¡å—çš„åŠ è½½æ“ä½œã€‚ |
   |     | å·¥ç¨‹æ­å»ºå’Œé€šä¿¡æ ˆæ¨¡å—åŠ è½½ |                                    |
   +-----+--------------------------+------------------------------------+
   | 2   | æ¨¡å—é…ç½®åŠé…ç½®æ–‡ä»¶ç”Ÿæˆ   | NA                                 |
   +-----+--------------------------+------------------------------------+
   | 3   | ä»£ç é›†æˆ                 | ç°æœ‰å·¥ç¨‹ã€                         |
   |     |                          | é€šä¿¡æ ˆæºä»£ç å’Œé…ç½®ç”Ÿæˆæ–‡ä»¶çš„é›†æˆã€‚ |
   +-----+--------------------------+------------------------------------+
   | 4   | éªŒè¯æµ‹è¯•                 | NA                                 |
   +-----+--------------------------+------------------------------------+

**æ³¨æ„ï¼šé€šä¿¡æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬é€šä¿¡æ ˆç›¸å…³çš„å…¶ä»–é€šä¿¡æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

æ–°å»ºORIENTAISå·¥ç¨‹
-----------------

#. å®‰è£…è½¯ä»¶åï¼ŒåŒå‡»è½¯ä»¶å›¾æ ‡æ‰“å¼€è½¯ä»¶

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image1.png
   :width: 5.77153in
   :height: 2.61944in

   4â€‘1 æ–°å»ºå·¥ç¨‹-1

2. èœå•æ FileğŸ¡ªNewğŸ¡ªProjectï¼Œæ–°å»ºå·¥ç¨‹

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image2.png
   :width: 4.92431in
   :height: 3.55972in

   4â€‘2 æ–°å»ºå·¥ç¨‹-2

3. åœ¨å¼¹å‡ºçš„æ–°å»ºçª—å£ä¸­é€‰æ‹©Autosarä¸‹çš„ [BSW Project]ï¼Œé€‰æ‹©Next

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image3.png
   :width: 4.07097in
   :height: 3.88665in

   4â€‘3 æ–°å»ºå·¥ç¨‹-3

4. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥å·¥ç¨‹åï¼Œé€‰æ‹©Finish

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image4.png
   :width: 4.75695in
   :height: 3.96308in

   4â€‘4 æ–°å»ºå·¥ç¨‹-4

5. åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©Yesã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image5.png
   :width: 3.21789in
   :height: 1.49669in

   4â€‘5 æ–°å»ºå·¥ç¨‹-5

6. åœ¨å·¥ç¨‹çš„[Bsw_Builder]é¡¹ç›®ä¸Šå³é”®ï¼Œé€‰æ‹©New ECU Configurationã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image6.png
   :width: 3.64675in
   :height: 2.42708in

   4â€‘6 æ–°å»ºå·¥ç¨‹-6

7. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥ä¸€ä¸ªECUåï¼Œç„¶åé€‰æ‹©Next

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image7.png
   :width: 3.20593in
   :height: 3.08507in

   4â€‘7 æ–°å»ºå·¥ç¨‹-7

8. åœ¨å¼¹å‡ºçš„çª—å£ä¸­å‹¾é€‰éœ€è¦æ·»åŠ çš„æ¨¡å—ï¼Œç‚¹å‡»Finishã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image8.png
   :width: 2.36in
   :height: 3.2652in

   4â€‘8 æ–°å»ºå·¥ç¨‹-8

9. æ–°å»ºå®Œæˆçš„å·¥ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¥éª¤â‘¦ä¸­æ·»åŠ çš„æ¨¡å—å·²ç»è¢«åŠ å…¥åˆ°å·¥ç¨‹ä¸­ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image9.png
   :width: 2.125in
   :height: 3.48958in

   4â€‘9 æ–°å»ºå·¥ç¨‹-9

æ¨¡å—é…ç½®åŠä»£ç ç”Ÿæˆ
------------------

4.2.1æ¨¡å—é…ç½®
~~~~~~~~~~~~~

æ¨¡å—çš„é…ç½®ï¼Œå–å†³äºå…·ä½“çš„é¡¹ç›®éœ€æ±‚ã€‚é€šä¿¡æ ˆå„æ¨¡å—é…ç½®é¡¹çš„è¯¦ç»†ä»‹ç»ï¼Œå‚è§è¡¨4-3ç›¸å…³æ–‡æ¡£

.. table:: 4â€‘3 æ¨¡å—å‚è€ƒæ–‡æ¡£

   +--------+---------------------------------------------+--------------+
   | **     | **å‚è€ƒæ–‡æ¡£åŠå…¶ç« èŠ‚**                        | **è¯´æ˜**     |
   | æ¨¡å—** |                                             |              |
   +--------+---------------------------------------------+--------------+
   | LIN    | MCALå¯¹åº”çš„LINé…ç½®æ‰‹å†Œ                       |              |
   +--------+---------------------------------------------+--------------+
   | LinIf  | LinIf.pdf ç« èŠ‚5                    |              |
   +--------+---------------------------------------------+--------------+
   | PduR   | PduR.pdf ç« èŠ‚5                     |              |
   +--------+---------------------------------------------+--------------+
   | Com    | Com.pdf ç« èŠ‚5                      |              |
   +--------+---------------------------------------------+--------------+
   | LinSM  | LinSM.pdf ç« èŠ‚5                    |              |
   +--------+---------------------------------------------+--------------+
   | EcuC   | EcuC.pdf ç« èŠ‚5                     |              |
   +--------+---------------------------------------------+--------------+
   | ComM   | ComM.pdf ç« èŠ‚5                     |              |
   +--------+---------------------------------------------+--------------+

4.2.2é…ç½®ä»£ç ç”Ÿæˆ
~~~~~~~~~~~~~~~~~

#. åœ¨å·¥ç¨‹ä¸Šå³é”®ä¼šå¼¹å‡ºæ ¡éªŒæ•´ä¸ªå·¥ç¨‹å’Œç”Ÿæˆæ•´ä¸ªå·¥ç¨‹æ‰€æœ‰æ¨¡å—é…ç½®æ–‡ä»¶çš„èœå•ã€‚

#. é¦–å…ˆé€‰æ‹©Validate Allï¼Œæ²¡æœ‰é”™è¯¯æç¤ºä¿¡æ¯å³æ ¡éªŒé€šè¿‡ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image10.png
   :width: 3.66718in
   :height: 4.96944in

   4â€‘10 é…ç½®æ ¡éªŒ

3. ç„¶åé€‰æ‹©Generate
   Allï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚å³ä¸‹è§’çš„è¾“å‡ºæ¡†ä¸­ä¼šè¾“å‡ºç”Ÿæˆçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image11.png
   :width: 4.02153in
   :height: 3.04893in

   4â€‘11 é…ç½®ç”Ÿæˆä¿¡æ¯

4. åœ¨å·¥ç¨‹Configæ–‡ä»¶å¤¹ä¸‹å³å¯æŸ¥çœ‹ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image12.png
   :width: 3.04521in
   :height: 4.66669in

   4â€‘12 Configä»£ç ç”Ÿæˆ

åŠŸèƒ½é›†æˆ
--------

4.3.1ä»£ç é›†æˆ
~~~~~~~~~~~~~

é€šä¿¡æ ˆä»£ç åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šé¡¹ç›®æä¾›çš„é€šä¿¡æ ˆæºç å’ŒORIENTAIS
Configuratoré…ç½®ç”Ÿæˆä»£ç ã€‚é€šä¿¡æ ˆé›†æˆåŒ…æ‹¬é€šä¿¡æ ˆæºç ï¼ˆLINã€LinIfã€PduRã€ComMã€LinSMç­‰ï¼‰ã€å®šæ—¶å™¨æºç å’Œéƒ¨åˆ†å…¶ä»–æ¨¡å—æºç ï¼Œå…·ä½“æ–‡ä»¶è§è¡¨4-4ã€‚

ç”¨æˆ·é¡»å°†é€šä¿¡æ ˆæºç å’Œç« èŠ‚4.2.2ç”Ÿæˆçš„æºä»£ç æ·»åŠ åˆ°é›†æˆå¼€å‘å·¥å…·çš„å¯¹åº”æ–‡ä»¶å¤¹ã€‚é€šä¿¡æ ˆé›†æˆçš„æ–‡ä»¶ç»“æ„ï¼Œå‚è§ç« èŠ‚5.3ã€‚

.. table:: 4â€‘4 é€šä¿¡æ ˆæºç æ–‡ä»¶

   +-----------+-------------------------------------------+--------------+
   | **ç§»åº“    | **ç§»åº“æ–‡ä»¶**                              | **è¯´æ˜**     |
   | æ–‡ä»¶å¤¹**  |                                           |              |
   +-----------+-------------------------------------------+--------------+
   | ComM      | ComM.c                                    | é€šä¿¡æ ˆæºç    |
   |           | ã€ComM.hã€ComM_BusSM.hã€ComM_Com.hã€ComM_ |              |
   |           | Dcm.hã€ComM_Internal.cã€ComM_EcuMBswM.hã€ |              |
   |           | ComM_Internal.hã€ComM_MemMap.hã€ComM_Nm.h |              |
   +-----------+-------------------------------------------+--------------+
   | LinIf     | LinIf.cã€LinIf.h                          |              |
   |           | ã€LinIf_Cbk.hã€LinIf_Internal.hã€LinIf_Sl |              |
   |           | ave.cã€LinIf_Slave.hã€LinIf_MemMap.hã€Lin |              |
   |           | If_Types.hã€LinTp.cã€LinTp.hã€LinTp_Inter |              |
   |           | nal.cã€LinTp_Internal.hã€LinTp_Slave.cã€L |              |
   |           | inTp_Slave.hã€LinTp_Types.hã€SchM_LinIf.h |              |
   +-----------+-------------------------------------------+--------------+
   | LinSM     | LinSM.                                    |              |
   |           | cã€LinSM.hã€LinSM_Cbk.hã€LinSM_MemMap.hã€ |              |
   +-----------+-------------------------------------------+--------------+
   | PDUR      | PduR_LinIf.hã€PduR_Co                     |              |
   |           | m.hã€PduR_Internal.cã€PduR_Internal.hã€Pd |              |
   |           | uR_MemMap.hã€PduR_Types.hã€PduR.cã€PduR.h |              |
   +-----------+-------------------------------------------+--------------+
   | Com       | Com.cã€Com.hã€                            |              |
   |           | Com_Cbk.hã€Com_GwInternal.cã€Com_Interna  |              |
   |           | l.cã€Com_Internal.hã€Com_MemMap.hã€Com_Rx |              |
   |           | Internal.cã€Com_TxInternal.cã€Com_Types.h |              |
   +-----------+-------------------------------------------+--------------+
   | F         | FreeRTimer.cã€FreeRTimer.h                | å®šæ—¶å™¨æºç    |
   | reeRTimer |                                           |              |
   +-----------+-------------------------------------------+--------------+
   | SchM      | SchM.cã€SchM.hã€SchM_Com.hã€              | SchMéƒ¨åˆ†æºç  |
   |           | SchM_ComM.hã€SchM_LinIf.hã€SchM_PduR.hã€  |              |
   +-----------+-------------------------------------------+--------------+
   | BswM      | Bs                                        | BswMéƒ¨åˆ†æºç  |
   |           | wM.cã€BswM.hã€BswM_LinSM.hã€BswM_ComM.hã€ |              |
   +-----------+-------------------------------------------+--------------+
   | EcuM      | EcuM_Types.hã€EcuM.hã€                    | EcuMéƒ¨åˆ†æºç  |
   +-----------+-------------------------------------------+--------------+

**æ³¨æ„ï¼šé€šä¿¡æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬é€šä¿¡æ ˆç›¸å…³çš„å…¶ä»–é€šä¿¡æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

4.3.2é›†æˆæ³¨æ„äº‹é¡¹
~~~~~~~~~~~~~~~~~

å¯¹äºé›†æˆè¿‡ç¨‹ä¸­ï¼Œé€šä¿¡æ ˆç‰¹æ®Šè¦æ±‚å’Œç”¨æˆ·ç»å¸¸å‡ºç°çš„é—®é¢˜ï¼Œå½’ç±»æ€»ç»“å½¢æˆè¡¨
4â€‘5é€šä¿¡æ ˆé›†æˆçº¦æŸæ¸…å•ã€‚ç”¨æˆ·éœ€é€ä¸€æ’æŸ¥è¡¨ä¸­çš„çº¦æŸé¡¹ï¼Œä»¥é¿å…é›†æˆé—®é¢˜å‡ºç°ã€‚

.. table:: 4â€‘5 é›†æˆçº¦æŸæ¸…å•

   +-----+---------+-----------------------------------------------------+
   | *   | *       | **çº¦æŸé™åˆ¶**                                        |
   | *ç¼– | *ç±»åˆ«** |                                                     |
   | å·  |         |                                                     |
   | **  |         |                                                     |
   +-----+---------+-----------------------------------------------------+
   | 1   | ä¸­æ–­    | é€šä¿¡æ ˆ                                              |
   |     |         | æœ‰ä¸­æ–­ã€è½®è¯¢æˆ–æ··åˆä¸‰ç§å·¥ä½œæ¨¡å¼ã€‚è‹¥é€‰å–ä¸­æ–­æˆ–æ··åˆæ¨¡  |
   |     |         | å¼ï¼Œç”¨æˆ·éœ€åœ¨é€šä¿¡æ ˆé…ç½®å¯¹åº”çš„ä¸­æ–­å¹¶å¡«å……ä¸­æ–­æœåŠ¡APIã€‚ |
   +-----+---------+-----------------------------------------------------+
   | 2   | å †æ ˆ    | ç”¨æˆ·éœ€ç¡®ä¿ä¸ºä»»åŠ¡å †æ ˆå’Œä¸­æ–­å †æ ˆåˆ†é…è¶³å¤Ÿçš„å †æ ˆç©ºé—´ã€‚  |
   +-----+---------+-----------------------------------------------------+
   | 3   | å¤´æ–‡ä»¶  | -  æ·»åŠ é€šä¿¡                                         |
   |     |         | æ ˆä»£ç ä¹‹åï¼Œç”¨æˆ·éœ€æ›´æ–°é›†æˆå¼€å‘å·¥å…·ä¸­çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚  |
   |     |         |                                                     |
   |     |         | -  è°ƒç”¨é€šä¿¡æ ˆAPIçš„æºæ–‡ä»¶ï¼Œéœ€è¦åŒ…å«é€šä¿¡æ ˆçš„å¤´æ–‡ä»¶ã€‚  |
   +-----+---------+-----------------------------------------------------+
   | 4   | åˆå§‹åŒ–  | ä»¥LINé€šä¿¡                                           |
   |     |         | ä¸ºä¾‹ï¼Œé€šä¿¡æ ˆçš„åˆå§‹åŒ–é¡ºåºä¸ºï¼šLin_Initã€LinIf_Initã€  |
   |     |         | PduR_Initã€Com_Initã€LinSM_Initã€‚                   |
   +-----+---------+-----------------------------------------------------+
   | 5   | å‘¨      | Co                                                  |
   |     | æœŸå‡½æ•°  | m_MainFunctionRxã€Com_MainFunctionTxã€LinIf_MainFun |
   |     |         | ctionã€LinSM_MainFunctionéœ€è¦è¢«å‘¨æœŸæ€§ä»»åŠ¡å‡½æ•°è°ƒç”¨ã€‚ |
   +-----+---------+-----------------------------------------------------+

é›†æˆç¤ºä¾‹
========

é›†æˆç›®æ ‡
--------

é›†æˆåçš„å·¥ç¨‹ä¸ºä¸»èŠ‚ç‚¹LINï¼Œé›†æˆå®Œæˆåçš„å·¥ç¨‹å¯ä»¥è¿›è¡Œä¸€ä¸ªæ— æ¡ä»¶å¸§å‘é€å’Œä¸€ä¸ªæ— æ¡ä»¶å¸§æ¥æ”¶ã€‚

é€šä¿¡æŠ¥æ–‡é…ç½®å¦‚è¡¨5-1ï¼š

.. table:: 5â€‘1 é€šä¿¡æŠ¥æ–‡é…ç½®

   +--------------+----------+-----+--------+---------------------------+
   | **å¸§åç§°     | **       | **I | **Tx   | **å…³è”å¸§**                |
   | **           | å¸§ç±»å‹** | D** | \\Rx** |                           |
   +--------------+----------+-----+--------+---------------------------+
   | Li           | æ— æ¡ä»¶å¸§ | 0x0 | Tx     |                           |
   | nIfFrame_Tx1 |          |     |        |                           |
   +--------------+----------+-----+--------+---------------------------+
   | Li           | æ— æ¡ä»¶å¸§ | 0x1 | Rx     |                           |
   | nIfFrame_Rx1 |          |     |        |                           |
   +--------------+----------+-----+--------+---------------------------+

.. _æ¨¡å—é…ç½®-1:

æ¨¡å—é…ç½®
--------

5.2.1 EcuCæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~~

10. åŒå‡»EcuCæ¨¡å—ï¼Œæ‰“å¼€EcuCæ¨¡å—é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image13.png
   :width: 5.09964in
   :height: 3.88532in

   5â€‘1 EcuCé…ç½®-1

11. åœ¨EcucConfigSetsæ ç›®ä¸Šå³é”®ï¼Œé€‰æ‹©EcucConfigSetã€‚å†åœ¨EcucConfigSetä¸Šå³é”®ï¼Œé€‰æ‹©NewğŸ¡ªEcucPduCollectionã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image14.png
   :width: 5.77153in
   :height: 3.23264in

   5â€‘2 EcuCé…ç½®-2

-  PduIdTypeEnum é€‰æ‹©UINT16.

-  PduLengthTypeEnum é€‰æ‹©UINT16ã€‚

12. åœ¨EcucPduCollectionä¸Šå³é”®ï¼Œé€‰æ‹©Pduï¼Œä¼šç”Ÿæˆä¸€ä¸ªPduçš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image15.png
   :width: 5.77153in
   :height: 3.46181in

   5â€‘3 EcuCé…ç½®-3

è¿™é‡ŒæŒ‰ç…§å‘é€å’Œæ¥æ”¶ï¼Œå°†Pduåå­—æ”¹ä¸ºæŠ¥æ–‡çš„åå­—ã€‚

PduLengthï¼šPdué•¿åº¦ï¼Œæ ¹æ®å®é™…ä½¿ç”¨å¸§çš„é•¿åº¦è®¾ç½®ã€‚

13. æ ¹æ®æ­¥éª¤â‘¢çš„æè¿°ï¼Œé…ç½®å…¶ä½™æŠ¥æ–‡çš„Pduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image16.png
   :width: 5.77153in
   :height: 2.44514in

   5â€‘4 EcuCé…ç½®-4

14. æŠ¥æ–‡éœ€è¦PDURè·¯ç”±ï¼Œæ¯ä¸ªæ–¹å‘éœ€è¦é…ç½®2ä¸ªPduã€‚

15. ECUCæ¨¡å—åˆ°æ­¤é…ç½®ç»“æŸã€‚åœ¨æ¨¡å—ä¸Šå³é”®ï¼Œç„¶åé€‰æ‹©æ ¡éªŒï¼ŒæŸ¥çœ‹æ˜¯å¦é…ç½®æœ‰é”™è¯¯ã€‚

5.2.2 Linæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~

å¦‚æœLiné©±åŠ¨ä½¿ç”¨çš„æ˜¯MCALé…ç½®ï¼Œé‚£ä¹ˆå°†MCALç”Ÿæˆçš„arxmlé…ç½®æ–‡ä»¶å¯¼å…¥åˆ°BSWå·¥å…·é€‰æ‹©å¯¹åº”çš„Linæ¨¡å—å³å¯ã€‚

5.2.3 LinIfæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~~~

#. åŒå‡»LinIfæ¨¡å—ï¼Œæ‰“å¼€LinIfæ¨¡å—çš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image17.png
   :width: 4.35209in
   :height: 5.51429in

   5â€‘5 LinIfé…ç½®-1

2. LinIfGeneralæ ‡ç­¾é¡µä¿æŒé»˜è®¤å€¼å³å¯ã€‚

3. åœ¨LinIfGlobalConfigæ ‡ç­¾é¡µä¸‹ä¾æ¬¡æ‰“å¼€LinIfGlobalConfigs
   ->LinIfGlobalConfig ->LinIfChannel_0è¿›è¡Œå¦‚ä¸‹é…ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image18.png
   :width: 5.77153in
   :height: 3.09236in

   5â€‘6 LinIfé…ç½®-2

LinIfChannel_0é…ç½®å‚æ•°è¯´æ˜ï¼š

.. table:: 5â€‘2 LinIfChannel_0é…ç½®å‚æ•°è¯´æ˜

   +--------------------------+--------------+---------------------------+
   | **å‚æ•°å**               | **è®¾ç½®å€¼**   | **è¯´æ˜**                  |
   +--------------------------+--------------+---------------------------+
   | LinI                     | LINSM        | Go-to-sleepå‘½ä»¤çš„         |
   | fGotoSleepConfirmationUL |              | ç¡®è®¤é€šçŸ¥ï¼Œé€šçŸ¥çš„ä¸Šå±‚æ¨¡å—  |
   +--------------------------+--------------+---------------------------+
   | Li                       | LINSM        | Go-to-sleepå‘½ä»¤æ”¶         |
   | nIfGotoSleepIndicationUL |              | åˆ°çš„é€šçŸ¥ï¼Œé€šçŸ¥çš„ä¸Šå±‚æ¨¡å—  |
   +--------------------------+--------------+---------------------------+
   | LinIfSched               | LINSM        | è°ƒåº¦è¡¨åˆ‡æ¢æˆåŠŸæ‰§è¡Œåçš„    |
   | uleRequestConfirmationUL |              | é€šçŸ¥å‡½æ•°ï¼Œé€šçŸ¥çš„ä¸Šå±‚æ¨¡å—  |
   +--------------------------+--------------+---------------------------+
   | LinIfStartupState        | NORMAL       | Liné€šé“åœ¨å¯åŠ¨åæ‰€å¤„çš„çŠ¶æ€ |
   +--------------------------+--------------+---------------------------+
   | L                        | LINSM        | Wakeu                     |
   | inIfWakeupConfirmationUL |              | pé€šçŸ¥å‡½æ•°ï¼Œé€šçŸ¥çš„ä¸Šå±‚æ¨¡å— |
   +--------------------------+--------------+---------------------------+
   | LinIfChannelRef          | LinChannel_0 | LinIf                     |
   |                          |              | çš„é€šé“å¯¹åº”çš„Liné©±åŠ¨çš„é€šé“ |
   +--------------------------+--------------+---------------------------+
   | L                        | C            | Li                        |
   | inIfComMNetworkHandleRef | omMChannel_0 | nIfçš„é€šé“å¯¹åº”çš„ComMçš„é€šé“ |
   +--------------------------+--------------+---------------------------+

4. ç„¶åå³å‡»LinIfChannel_0æ–°å»ºLinIfFrameå¯¹è±¡ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image19.png
   :width: 5.77153in
   :height: 3.07083in

   5â€‘7 LinIfé…ç½®-3

5. æŒ‰ç…§æ­¥éª¤åˆ›å»º2ä¸ªå¯¹è±¡ï¼Œæ ¹æ®ç« èŠ‚5.1é›†æˆç›®æ ‡ä¿®æ”¹åå­—ï¼Œå¹¶å°†LinIfFrameIdè®¾ç½®ä¸ºå¯¹åº”å€¼ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image20.png
   :width: 5.77153in
   :height: 3.46319in

   5â€‘8 LinIfé…ç½®-4

ä¸‹é¢å¯¹ä¸åŒåç§°çš„å¸§å„ä¸¾ä¸€ä¾‹è¯´æ˜é…ç½®å‚æ•°ã€‚

LinIfFrame_Tx1æŠ¥æ–‡LinFrameé…ç½®è¯´æ˜ï¼š

.. table:: 5â€‘3 LinIfFrame_Tx1æŠ¥æ–‡LinFrameé…ç½®è¯´æ˜

   +----------------+-----------------+-----------------------------------+
   | **å‚æ•°å**     | **è®¾ç½®å€¼**      | **è¯´æ˜**                          |
   +----------------+-----------------+-----------------------------------+
   | Lin            | ENHANCED        | æŠ¥æ–‡ä½¿ç”¨çš„c                       |
   | IfChecksumType |                 | hecksumç±»å‹ï¼ˆæ­¤å¤„ä½¿ç”¨å¢å¼ºå‹æ ¡éªŒï¼‰ |
   +----------------+-----------------+-----------------------------------+
   | LinIfFrameType | UNCONDITIONAL   | æŠ¥                                |
   |                |                 | æ–‡å¸§çš„ç±»å‹ï¼ˆæ­¤å¤„è®¾ç½®ä¸ºæ— æ¡ä»¶å¸§ï¼‰  |
   +----------------+-----------------+-----------------------------------+
   | LinIfFrameId   | 0x0             | æŠ¥æ–‡ID                            |
   +----------------+-----------------+-----------------------------------+

LinIfFrame_Rx1æŠ¥æ–‡LinFrameé…ç½®è¯´æ˜ï¼š

.. table:: 5â€‘4 LinIfFrame_Rx1æŠ¥æ–‡LinFrameé…ç½®è¯´æ˜

   +----------------+-----------------+-----------------------------------+
   | **å‚æ•°å**     | **è®¾ç½®å€¼**      | **è¯´æ˜**                          |
   +----------------+-----------------+-----------------------------------+
   | Lin            | ENHANCED        | æŠ¥æ–‡ä½¿ç”¨çš„c                       |
   | IfChecksumType |                 | hecksumç±»å‹ï¼ˆæ­¤å¤„ä½¿ç”¨å¢å¼ºå‹æ ¡éªŒï¼‰ |
   +----------------+-----------------+-----------------------------------+
   | LinIfFrameType | UNCONDITIONAL   | æŠ¥                                |
   |                |                 | æ–‡å¸§çš„ç±»å‹ï¼ˆæ­¤å¤„è®¾ç½®ä¸ºæ— æ¡ä»¶å¸§ï¼‰  |
   +----------------+-----------------+-----------------------------------+
   | LinIfFrameId   | 0x1             | æŠ¥æ–‡ID                            |
   +----------------+-----------------+-----------------------------------+

6. å±•å¼€LinIfFrame_Tx1å­é…ç½®é¡µé¢ï¼Œå³é”®æ–°å»ºä¸€ä¸ªLinPduDirectionå¯¹è±¡ï¼Œå¦‚æœçš„LinIfFrameä¸ºTxç±»å‹ï¼Œåˆ™é€‰æ‹©LinTxPduï¼Œå¦‚æœå‰é¢çš„LinIfFrameä¸ºRxç±»å‹ï¼Œåˆ™é€‰æ‹©LinRxPduã€‚

5â€‘9 LinIfé…ç½®-5

7. ç‚¹å‡»æ–°å»ºçš„LinTxPduç„¶åé€‰æ‹©å³è¾¹LinIfTxPduRefå¯¹è±¡ï¼Œè¦æ±‚å’ŒLinIfFrameåç§°å¯¹åº”ï¼Œå¦‚LinIfFrame_Tx1å¯¹åº”LinIfFrame_Tx1ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image22.png
   :width: 5.46081in
   :height: 2.94756in

   5â€‘10 LinIfé…ç½®-6

ä»¥LinIfFrame_Tx1ä¸ºä¾‹é…ç½®LinTxPdué…ç½®å‚æ•°ï¼š

.. table:: 5â€‘5 LinIfFrame_Tx1æŠ¥æ–‡LinTxPdué…ç½®è¯´æ˜

   +---------------+--------------+---------------------------------------+
   | **å‚æ•°å**    | **è®¾ç½®å€¼**   | **è¯´æ˜**                              |
   +---------------+--------------+---------------------------------------+
   | LinIfUserTxUL | PDUR         | ç”¨äºç¡®å®šè§¦å‘LinTxPduå‘é€çš„            |
   |               |              | ä¸Šå±‚æ¨¡å—ï¼Œå¹¶åœ¨å‘é€æˆåŠŸåé€šçŸ¥è¯¥æ¨¡å—ã€‚  |
   +---------------+--------------+---------------------------------------+
   | LinIfTxPduRef | Li           | æŒ‡å‘ä¸€ä¸ªECUCä¸­                        |
   |               | nIfFrame_Tx1 | å®šä¹‰çš„PDUï¼Œå°†LinIfTxPduå’ŒPduå…³è”èµ·æ¥  |
   +---------------+--------------+---------------------------------------+

8. æŒ‰ç…§ä¸Šé¢çš„æ­¥éª¤å®Œæˆå‰©ä¸‹LinIfFrameçš„é…ç½®ã€‚

.. table:: 5â€‘6 å…¶ä»–æŠ¥æ–‡LinIfFrameé…ç½®è¯´æ˜

   +-----------------------------------+----------------------------------+
   | **æŠ¥æ–‡å**                        | **LinIfTxPdu\\LinIfRxPdu**       |
   +-----------------------------------+----------------------------------+
   | LinIfFrame_Tx1                    | LinIfTxPdu                       |
   +-----------------------------------+----------------------------------+
   | LinIfFrame_Rx1                    | LinIfRxPdu                       |
   +-----------------------------------+----------------------------------+

9. é€‰æ‹©LinèŠ‚ç‚¹æ¨¡å¼ï¼Œå½“å‰é…ç½®ä¸ºä»æœºã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image23.png
   :width: 5.77153in
   :height: 4.08333in

   5â€‘11 LinIfé…ç½®-7

10. é€‰æ‹©å½“å‰ä½¿ç”¨çš„Linåè®®ç‰ˆæœ¬ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image24.png
   :width: 5.77153in
   :height: 3.11181in

   5â€‘12 LinIfé…ç½®-8

11. æ–°å»ºä¸€ä¸ªLinä»èŠ‚ç‚¹çš„é…ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image25.png
   :width: 5.77153in
   :height: 3.11528in

   5â€‘13 LinIfé…ç½®-9

LinSlaveå‚æ•°é…ç½®è¯´æ˜

5â€‘7 LinSlaveé…ç½®

+---------------------+--------------+--------------------------------+
| **å‚æ•°å**          | **è®¾ç½®å€¼**   | **è¯´æ˜**                       |
+---------------------+--------------+--------------------------------+
| LinIfConfiguredNAD  | 4            | ä»èŠ‚ç‚¹é…ç½®çš„NAD                |
+---------------------+--------------+--------------------------------+
| LinIfFunctionId     | 0            | Function Id                    |
+---------------------+--------------+--------------------------------+
| LinIfFrameId        | 4            | ä»æœºèŠ‚ç‚¹åˆå§‹åŒ–Id               |
+---------------------+--------------+--------------------------------+
| LinIfNasTimeout     | 1.0          | N_Asè¶…æ—¶æ—¶é—´ï¼Œå•ä½ä¸ºç§’ã€‚       |
+---------------------+--------------+--------------------------------+
| LinIfSupplierId     | 5            | Supplier Id                    |
+---------------------+--------------+--------------------------------+
| LinIfVariantID      | 0            | Variant Id                     |
+---------------------+--------------+--------------------------------+
| LinIfConfiguredNAD  | 4            | ä»èŠ‚ç‚¹é…ç½®çš„NAD                |
+---------------------+--------------+--------------------------------+
| LinIfFunctionId     | 0            | Function Id                    |
+---------------------+--------------+--------------------------------+

12. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼Œå³é…ç½®å®Œæˆã€‚

5.2.4 Comæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~

#. åŒå‡»Comæ¨¡å—ï¼Œæ‰“å¼€Comæ¨¡å—çš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image26.png
   :width: 5.04355in
   :height: 6.07247in

   5â€‘14 Comé…ç½®-1

2. ComGeneralæ ‡ç­¾é¡µé‡Œé¢åªéœ€è¦é…ç½®ComSupportedIPduGroupså‚æ•°ï¼Œå…¶ä½™å‚æ•°ä¿æŒé»˜è®¤å³å¯ã€‚ComSupportedIPduGroupsæ˜¯æŒ‡IPduGroupçš„ä¸ªæ•°ã€‚IPduGroupsä¼šåœ¨ComConfigæ ‡ç­¾é¡µä¸­é…ç½®ã€‚åé¢çš„é…ç½®ä¸­å°†ä¼šé…ç½®2ä¸ªIPduGroupï¼Œæ‰€ä»¥å°†è¿™ä¸ªå‚æ•°é…ç½®ä¸º2ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image27.png
   :width: 5.76736in
   :height: 4.03819in

   5â€‘15 Comé…ç½®-2

3. ComConfigä¸‹çš„ä¸¤ä¸ªå‚æ•°ä¸éœ€è¦é…ç½®ï¼Œä¿æŒé»˜è®¤å³å¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image28.png
   :width: 5.77153in
   :height: 2.07083in

   5â€‘16 Comé…ç½®-3

4. ComGwMappingä¸ºä¿¡å·è·¯ç”±çš„é…ç½®ï¼Œæœ¬æ¬¡ç¤ºä¾‹ä¸éœ€è¦ä¿¡å·è·¯ç”±ï¼Œä¸éœ€è¦åˆ›å»ºå¯¹åº”å¯¹è±¡ã€‚

5. æ–°å»º2ä¸ªComIPduå¯¹è±¡ï¼Œå¹¶ä¿®æ”¹åå­—ã€‚

æ ¹æ®å‰æ–‡ä¸­å®šä¹‰çš„æŠ¥æ–‡ï¼Œåˆ›å»º2ä¸ªComIPduå¯¹è±¡ã€‚ç”±äºComIPduå±æ€§é…ç½®éœ€è¦å…³è”å…¶ä»–çš„å¯¹è±¡ï¼ŒComIPduçš„å±æ€§å…ˆæš‚æ—¶ä¸é…ç½®ï¼Œå¾…æ·»åŠ äº†å…¶å®ƒå¯¹è±¡åå†é…ç½®ComIPduå±æ€§ã€‚ï¼ˆå‚ç…§æ­¥éª¤ï¼‰

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image29.png
   :width: 5.77153in
   :height: 2.91042in

   5â€‘17 Comé…ç½®-4

6. é…ç½®ComIPduGroupã€‚

å°†IPduåŠ å…¥IPduGroupå¯ä»¥æ–¹ä¾¿çš„æ§åˆ¶IPduçš„çŠ¶æ€ï¼Œæ ¹æ®éœ€è¦ä½¿èƒ½å’Œç¦æ­¢IPduçš„æ”¶å‘ã€‚

æ·»åŠ ä¸¤ä¸ªComIPduGroupå¯¹è±¡ï¼Œä¸€ä¸ªç”¨äºç®¡ç†å‘é€æŠ¥æ–‡ï¼Œä¸€ä¸ªç”¨äºç®¡ç†æ¥æ”¶æŠ¥æ–‡ï¼Œå‚æ•°ä¿æŒé»˜è®¤å³å¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image30.png
   :width: 5.77153in
   :height: 2.49792in

   5â€‘18 Comé…ç½®-5

7. é…ç½®ComSignalã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image31.png
   :width: 5.77153in
   :height: 4.17014in

   5â€‘19 Comé…ç½®-6

ComSignalå¯¹è±¡å±æ€§çš„é…ç½®ï¼ˆä»¥ä¿¡å·ComSignal_Tx1ä¸ºä¾‹ï¼‰ï¼š

.. table:: 5â€‘8 ComSignalå±æ€§é…ç½®è¯´æ˜

   +---------------------+--------------+--------------------------------+
   | **å‚æ•°å**          | **è®¾ç½®å€¼**   | **è¯´æ˜**                       |
   +---------------------+--------------+--------------------------------+
   | ComBitPosition      | 0            | æ ¹                             |
   |                     |              | æ®å®é™…ä½¿ç”¨å¸§çš„Startbitå‚æ•°å¡«å†™ |
   +---------------------+--------------+--------------------------------+
   | ComBitSize          | 64           | æ ¹æ®å®é™…ä½¿ç”¨å¸§çš„Lengthå‚æ•°å¡«å†™ |
   +---------------------+--------------+--------------------------------+
   | ComSignalEndianness | L            | Motorolaæ ¼å¼è®¾ä¸ºBIG_ENDIAN     |
   |                     | ITTLE_ENDIAN |                                |
   |                     |              | Intelæ ¼å¼è®¾ç½®ä¸ºLITTLE_ENDIAN   |
   +---------------------+--------------+--------------------------------+
   | ComSignalInitValue  | 0x00         | æ ¹æ®å®é™…ä½¿ç”¨å¸§çš„Initial        |
   |                     |              | Valueå‚æ•°å¡«å†™                  |
   +---------------------+--------------+--------------------------------+
   | ComSignalType       | UINT64       | æ ¹æ®å®é™…ä½¿ç”¨å¸§çš„Lengthå‚æ•°å¡«å†™ |
   +---------------------+--------------+--------------------------------+
   | Com                 | NONE         | å½“ä¿¡å·å±                       |
   | RxDataTimeoutAction |              | äºå‘é€æŠ¥æ–‡æ—¶ï¼Œè®¾ç½®ä¸ºNONEå½“ä¿¡å· |
   |                     |              | å±äºæ¥æ”¶æŠ¥æ–‡æ—¶ï¼Œé…ç½®ä¸ºNONEï¼Œè¶… |
   |                     |              | æ—¶åä¸åšå¤„ç†ï¼Œé…ç½®ä¸ºREPLACEï¼Œ  |
   |                     |              | è¶…æ—¶åç”¨åˆå§‹åŒ–å€¼ä»£æ›¿æ¥æ”¶å€¼ï¼Œé… |
   |                     |              | ç½®ä¸ºSUBSTITUTEï¼Œè¶…æ—¶åä½¿ç”¨Com  |
   |                     |              | TimeoutSubstitutionValueå€¼æ›¿æ¢ |
   +---------------------+--------------+--------------------------------+
   | ComInitialValueOnly | False        | è®¾ç½®ä¸ºTrueåï¼Œ                 |
   |                     |              | åˆå§‹åŒ–åä¸ä¼šå†æ›´æ–°è¿™ä¸ªä¿¡å·çš„å€¼ |
   +---------------------+--------------+--------------------------------+
   | ComTransferProperty | PENDING      | æ ¹æ®                           |
   |                     |              | DBCä¸­GenSigSendTypeå‚æ•°è®¾ç½®ï¼š  |
   |                     |              |                                |
   |                     |              | Cycle å¯¹åº” PENDING             |
   |                     |              |                                |
   |                     |              | OnWrite å¯¹åº” TRIGGER           |
   |                     |              |                                |
   |                     |              | OnChange å¯¹TRIGGER_ON_CHANGE   |
   +---------------------+--------------+--------------------------------+

8. é…ç½®ComTimeBaseï¼Œ
   ComGwTimeBaseå®šä¹‰ä¿¡å·ç½‘å…³å¤„ç†å‡½æ•°çš„å‘¨æœŸï¼ŒComRxTimeBaseå®šä¹‰æ¥æ”¶å¤„ç†çš„å‘¨æœŸï¼ŒComTxTimeBaseå®šä¹‰å‘é€å¤„ç†çš„å‘¨æœŸã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image32.png
   :width: 5.77153in
   :height: 2.13472in

   5â€‘20 Comé…ç½®-7

9. é…ç½®ComIPduå±æ€§ã€‚ä»¥IPDU_COM_LIN_Tx1ä¸ºä¾‹è¯´æ˜ï¼š

.. table:: 5â€‘9 ComIPduå±æ€§é…ç½®è¯´æ˜

   +--------------------+--------------+---------------------------------+
   | **å‚æ•°å**         | **è®¾ç½®å€¼**   | **è¯´æ˜**                        |
   +--------------------+--------------+---------------------------------+
   | ComIPduDirection   | SEND         | æŠ¥æ–‡ä¸ºå‘é€æŠ¥æ–‡                  |
   +--------------------+--------------+---------------------------------+
   | ComIP              | DEFERRED     | åœ¨å‘¨æœŸå‡½æ•°ä¸­å¤„ç†ä¿¡å·            |
   | duSignalProcessing |              |                                 |
   +--------------------+--------------+---------------------------------+
   | ComIPduType        | NORMAL       | æ­£å¸¸æŠ¥æ–‡ï¼ˆéTPæŠ¥æ–‡ï¼‰            |
   +--------------------+--------------+---------------------------------+
   | ComIPduGroupRef    | Com_Tx       | å±äº                            |
   |                    | PduGroup_Lin | Com_TxPduGroup_LinController_0  |
   |                    | Controller_0 |                                 |
   +--------------------+--------------+---------------------------------+
   | Com                | -            | æ²¡æœ‰ä¿¡å·ç»„ï¼Œä¸éœ€è¦é…ç½®          |
   | IPduSignalGroupRef |              |                                 |
   +--------------------+--------------+---------------------------------+
   | ComIPduSignalRef   | C            | å°†å±äº                          |
   |                    | omSignal_Tx1 | IPDU_COM_LIN_Tx1çš„ä¿¡å·å…³è”è¿›æ¥  |
   +--------------------+--------------+---------------------------------+
   | ComPduIdRef        | Com_Li       | æŒ‡å‘EcuCä¸­å®šä¹‰çš„Pdu             |
   |                    | nIfFrame_Tx1 |                                 |
   +--------------------+--------------+---------------------------------+

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image33.png
   :width: 5.77153in
   :height: 2.91042in

   5â€‘21 Comé…ç½®-8

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image34.png
   :width: 5.77153in
   :height: 3.33819in

   5â€‘22 Comé…ç½®-9

10. ä¸ºå‘é€æŠ¥æ–‡é…ç½®ComTxIPduï¼Œæ¯ä¸ªå‘é€IPduï¼Œå¿…é¡»è¦é…ç½®ä¸€ä¸ªComTxIPduï¼Œå‚æ•°ä¿æŒé»˜è®¤å€¼å³å¯ã€‚åªå‘é€æŠ¥æ–‡éœ€è¦é…ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image35.png
   :width: 5.77153in
   :height: 3.35972in

   5â€‘23 Comé…ç½®-10

11. æ·»åŠ ComTxModeTrueå¯¹è±¡ï¼Œå¹¶å°†ComTxModeModeé…ç½®ä¸ºNoneã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image36.png
   :width: 5.41459in
   :height: 3.18387in

   5â€‘24 Comé…ç½®-11

12. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼ŒComæ¨¡å—å³é…ç½®å®Œæˆã€‚

5.2.5 PduRæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~~

#. åŒå‡»PduRæ¨¡å—ï¼Œæ‰“å¼€PduRæ¨¡å—é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image37.png
   :width: 3.40848in
   :height: 2.54269in

   5â€‘25 PduRé…ç½®-1

2. PduRGeneralé…ç½®ã€‚

..

   ä¿æŒé»˜è®¤å³å¯ã€‚

3. PduRBswModuleré…ç½®ã€‚

PduRæ¨¡å—çš„ç›®çš„æ˜¯å®ç°ä¸Šå±‚æ¨¡å—åˆ°ä¸‹å±‚æ¨¡å—çš„è·¯ç”±ã€‚PduRBswModulerå¯¹è±¡ç”¨æ¥æè¿°ä¸Šå±‚æ¨¡å—å’Œä¸‹å±‚æ¨¡å—å±æ€§ã€‚æœ¬ç¤ºä¾‹ä¸­ä¸Šå±‚æ¨¡å—ä¸ºComï¼Œä¸‹å±‚æ¨¡å—ä¸ºLinIfï¼ŒPduRæ¨¡å—å°†Comä¸­çš„Pduè·¯ç”±åˆ°LinIfä¸­ã€‚æ‰€ä»¥éœ€è¦æ–°å»º2ä¸ªPduRBswModulerå¯¹è±¡ï¼Œåˆ†åˆ«å¯¹åº”Comå’ŒLinIfã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image38.png
   :width: 5.00198in
   :height: 2.78055in

   5â€‘26 PduRé…ç½®-2

4. PduRRoutingTablesé…ç½®ã€‚

è¯¥å®¹å™¨æœ‰4ä¸ªé…ç½®é€‰é¡¹ï¼Œä¿æŒé»˜è®¤å³å¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image39.png
   :width: 5.77153in
   :height: 3.21458in

   5â€‘27 PduRé…ç½®-3

5. é…ç½®è·¯ç”±è¡¨ã€‚

ç”±äºæœ‰2ä¸ªæŠ¥æ–‡éœ€è¦æ”¶å‘ï¼Œæ‰€ä»¥éœ€è¦é…ç½®2ä¸ªè·¯ç”±è·¯å¾„ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image40.png
   :width: 5.77153in
   :height: 2.2875in

   5â€‘28 PduRé…ç½®-4

6. é…ç½®å‘é€è·¯ç”±è¡¨ã€‚

æ¯ä¸ªè·¯ç”±è¡¨ä¸‹æœ‰ä¸€ä¸ªSrcPduï¼Œæœ‰ä¸€ä¸ªDestPduã€‚å‘é€æŠ¥æ–‡ï¼Œæ˜¯ä»Comåˆ°LinIfï¼Œæ‰€ä»¥SrcPdué€‰æ‹©Comæ¨¡å—ä¸­å…³è”çš„Pduï¼ŒDestPdué€‰æ‹©LinIfä¸­å…³è”çš„Pduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image41.png
   :width: 5.77153in
   :height: 2.50069in

   5â€‘29 PduRé…ç½®-5

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image42.png
   :width: 5.77153in
   :height: 2.44722in

   5â€‘30 PduRé…ç½®-6

7. é…ç½®æ¥æ”¶è·¯ç”±è¡¨ã€‚

å‘é€æŠ¥æ–‡ï¼Œæ˜¯ä»LinIfåˆ°Comï¼Œæ‰€ä»¥SrcPdué€‰æ‹©LinIfæ¨¡å—ä¸­å…³è”çš„Pduï¼ŒDestPdué€‰æ‹©Comä¸­å…³è”çš„Pduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image43.png
   :width: 5.77153in
   :height: 2.49167in

   5â€‘31 PduRé…ç½®-7

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image44.png
   :width: 5.77153in
   :height: 2.45903in

   5â€‘32 PduRé…ç½®-8

8. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼ŒPduRæ¨¡å—å³é…ç½®å®Œæˆã€‚

5.2.6 ComMæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~~

#. åŒå‡»ComMæ¨¡å—ï¼Œæ‰“å¼€ComMæ¨¡å—é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image45.png
   :width: 5.75in
   :height: 5.61458in

   5â€‘33 ComMé…ç½®-1

2. ComMGeneralæ ‡ç­¾é¡µä¸­çš„å‚æ•°ä¿æŒé»˜è®¤å³å¯ã€‚

3. ComMConfigSeté…ç½®ã€‚

é»˜è®¤å·²ç»ç”Ÿæˆäº†ä¸€ä¸ªComMChannelå¯¹è±¡ComMChannel_0å’Œä¸€ä¸ªComMUserå¯¹è±¡ComMUser_0ï¼Œä¿®æ”¹ä»¥ä¸‹å‡ ä¸ªå‚æ•°ï¼Œå…¶ä½™å‚æ•°ä¿æŒé»˜è®¤å€¼ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image46.png
   :width: 5.77153in
   :height: 2.65625in

   5â€‘34 ComMé…ç½®-2

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image47.png
   :width: 5.77153in
   :height: 2.67917in

   5â€‘35 ComMé…ç½®-3

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image48.png
   :width: 5.77153in
   :height: 2.69653in

   5â€‘36 ComMé…ç½®-4

4. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼ŒComMæ¨¡å—å³é…ç½®å®Œæˆã€‚

5.2.7 LinSMæ¨¡å—é…ç½®
~~~~~~~~~~~~~~~~~~~

#. åŒå‡»LinSMæ¨¡å—ï¼Œæ‰“å¼€LinSMæ¨¡å—é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image49.png
   :width: 5.77153in
   :height: 1.96667in

   5â€‘37 LinSMé…ç½®-1

2. LinSMGeneralæ ‡ç­¾é¡µå†…å„å‚æ•°ä¿æŒé»˜è®¤å€¼ã€‚

3. LinSMConfigSetæ ‡ç­¾é¡µå‚æ•°è¯´æ˜å¦‚è¡¨5-11ã€‚å…¶ä½™å‚æ•°ä¿æŒé»˜è®¤å€¼ã€‚

.. table:: 5â€‘10 LINSMé…ç½®å‚æ•°è¯´æ˜

   +-------------------------+-----------------+-------------------------+
   | **å‚æ•°å**              | **è®¾ç½®å€¼**      | **è¯´æ˜**                |
   +-------------------------+-----------------+-------------------------+
   | ComMNetwork Handle Ref  | ComMChannel_0   | æŒ‡å‘ComMé…ç½®çš„é€šé“      |
   +-------------------------+-----------------+-------------------------+

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image50.png
   :width: 5.77153in
   :height: 1.72153in

   5â€‘38 LinSMé…ç½®-2

4. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼ŒLinSMæ¨¡å—å³é…ç½®å®Œæˆã€‚

ä»£ç å·¥ç¨‹ä»‹ç»
------------

é¡¹ç›®äº¤ä»˜ç»™ç”¨æˆ·çš„å·¥ç¨‹ç›®å½•ç»“æ„å¦‚ä¸‹ï¼š

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image51.png
   :width: 2.5in
   :height: 2.60417in

   5â€‘39 å·¥ç¨‹ç›®å½•ç»“æ„

#. Configç›®å½•ï¼Œè¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾åŸºç¡€è½¯ä»¶é…ç½®å·¥å…·ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

#. æ¨¡å—ç›¸å…³çš„é™æ€æºä»£ç ï¼Œå­˜æ”¾åœ¨å„ä¸ªæ¨¡å—çš„æ–‡ä»¶å¤¹ä¸‹ã€‚

åº”ç”¨é…ç½®æ–‡ä»¶
------------

#. å°†4.2ç« èŠ‚ç”Ÿæˆçš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°Configæ–‡ä»¶å¤¹ä¸­ã€‚

#. æ·»åŠ åˆå§‹åŒ–å‡½æ•°å’Œå‘¨æœŸè°ƒç”¨å‡½æ•°ã€‚

+-----------------------------------------------------------------------+
| Lin_Init(&Lin_Config);                                                |
|                                                                       |
| åˆå§‹åŒ–Linã€LinIfã€LinSMæ¨¡å—                                           |
|                                                                       |
| LinIf_Init(NULL_PTR);                                                 |
|                                                                       |
| LinSM_Init(NULL_PTR);                                                 |
|                                                                       |
| /\* Initialize the *Pdur* module \*/                                  |
|                                                                       |
| åˆå§‹åŒ–PduRæ¨¡å—                                                        |
|                                                                       |
| PduR_Init(&PduR_PBConfigData);                                        |
|                                                                       |
| /\* Initialize the *Com* module \*/                                   |
|                                                                       |
| åˆå§‹åŒ–Comæ¨¡å—                                                         |
|                                                                       |
| Com_Init(&Com_PBConfigData);                                          |
|                                                                       |
| Com_SetIpduGroup(ipduGroupVector,Com_RxPduGroup_LinController_0,      |
| TRUE);                                                                |
|                                                                       |
| Com_SetIpduGroup(ipduGroupVector,Com_TxPduGroup_LinController_0,      |
| TRUE);                                                                |
|                                                                       |
| Com_ReceptionDMControl(ipduGroupVector);                              |
|                                                                       |
| ä½¿èƒ½æ¥æ”¶å’Œå‘é€IPduGroup                                               |
|                                                                       |
| Com_IpduGroupControl(ipduGroupVector, TRUE);                          |
|                                                                       |
| /\* Initialize the ComM module \*/                                    |
|                                                                       |
| åˆå§‹åŒ–ComMæ¨¡å—                                                        |
|                                                                       |
| ComM_Init(&ComM_Config);                                              |
|                                                                       |
| ComM_RequestComMode(ComMUser_0, COMM_FULL_COMMUNICATION);             |
|                                                                       |
| ComM_CommunicationAllowed(ComMChannel_0, TRUE);                       |
|                                                                       |
| å°†é…ç½®çš„é€šé“åˆ‡æ¢åˆ°FULL_COMMUNICATION                                  |
+-----------------------------------------------------------------------+

3. æ·»åŠ MainFunctionå‡½æ•°

+-----------------------------------------------------------------------+
| /\*Task_5ms_Dcpd: Core0(CPU0),Type = BASIC, Priority = 6*/            |
|                                                                       |
| TASK(Task_5ms_Dcpd)                                                   |
|                                                                       |
| å¯ç”¨linåè®®æ ˆé€šä¿¡                                                     |
|                                                                       |
| {                                                                     |
|                                                                       |
| /\* please insert your code here ... \*/                              |
|                                                                       |
| ComM_MainFunction_ComMChannel_0();                                    |
|                                                                       |
| Com_ReceiveSignal(ComSignal_Rx1,&u1_ComTest);                         |
|                                                                       |
| Com_SendSignal(ComSignal_Tx1,&u1_ComTest);                            |
|                                                                       |
| LINä¿¡å·çš„å‘é€å’Œæ¥æ”¶                                                   |
|                                                                       |
| **if** (E_OK != TerminateTask())                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| **while** (1)                                                         |
|                                                                       |
| {                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| /\*Task_50ms_Psc: Core0(CPU0),Type = BASIC, Priority = 5*/            |
|                                                                       |
| TASK(Task_50ms_Psc)                                                   |
|                                                                       |
| {                                                                     |
|                                                                       |
| /\* please insert your code here ... \*/                              |
|                                                                       |
| è°ƒç”¨LinIfä¸»å‡½æ•°å’ŒLinSMä¸»å‡½æ•°                                          |
|                                                                       |
| LinIf_MainFunction();                                                 |
|                                                                       |
| LinSM_MainFunction();                                                 |
|                                                                       |
| **if** (E_OK != TerminateTask())                                      |
|                                                                       |
| {                                                                     |
|                                                                       |
| **while** (1)                                                         |
|                                                                       |
| {                                                                     |
|                                                                       |
| /\* dead loop \*/                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
|                                                                       |
| }                                                                     |
+-----------------------------------------------------------------------+

éªŒè¯ç»“æœ
--------

æ ¹æ®é›†æˆç›®æ ‡ï¼Œç¬¬5ç« ä¸€å…±é…ç½®äº†2ä¸ªæŠ¥æ–‡å¸§ï¼Œå…¶ä¸­1ä¸ªå‘¨æœŸå‘é€æŠ¥æ–‡ï¼Œ1ä¸ªå‘¨æœŸæ¥æ”¶æŠ¥æ–‡ã€‚

#. æ ¹æ®å‰æ–‡çš„é…ç½®ï¼Œè¿™é‡Œå°†PLINè¿›è¡Œå¦‚ä¸‹è®¾ç½®:

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image52.png
   :width: 4.73958in
   :height: 5.13542in

   5â€‘40 PLINé…ç½®

2. æ¥é€šPLINå¯ä»¥åœ¨Receiveçª—å£çœ‹åˆ°æ¥æ”¶å’Œå‘é€çš„æŠ¥æ–‡ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/LinSlave/image53.png
   :width: 5.75764in
   :height: 3.14514in

   5â€‘41 æ¥æ”¶æŠ¥æ–‡éªŒè¯
