===================
CAN_é›†æˆæ‰‹å†Œ
===================

ç›®æ ‡
====

æœ¬é›†æˆæ‰‹å†Œç”¨äºæŒ‡å¯¼å®¢æˆ·è¿›è¡Œé€šä¿¡æ ˆé›†æˆï¼Œæ–‡æ¡£ä¸»è¦åŒ…æ‹¬çš„å†…å®¹ä¸ºï¼šé€šä¿¡æ ˆé›†æˆæŒ‡å¯¼ã€‚

ç”±äºå„é¡¹ç›®çš„éœ€æ±‚ä¸åŒï¼Œé›†æˆç¤ºä¾‹ä¸ä¼šé’ˆå¯¹äºç‰¹å®šçš„å•†ä¸šé¡¹ç›®åšè¯¦ç»†è®²è§£ã€‚

ç¼©å†™è¯å’Œæœ¯è¯­
============

.. table:: è¡¨ 2â€‘1 ç¼©å†™è¯å’Œæœ¯è¯­

   +---------------+------------------------------------------------------+
   | **\           | **æè¿°**                                             |
   | ç¼©å†™è¯/æœ¯è¯­** |                                                      |
   +---------------+------------------------------------------------------+
   | BSW           | Basic Software åŸºç¡€è½¯ä»¶å±‚                            |
   +---------------+------------------------------------------------------+
   | BswM          | Basic Software Mode ManageråŸºç¡€è½¯ä»¶æ¨¡å¼ç®¡ç†å™¨        |
   +---------------+------------------------------------------------------+
   | MCAL          | Microcontroller Abstraction Layer å¾®æ§åˆ¶å™¨æŠ½è±¡å±‚     |
   +---------------+------------------------------------------------------+
   | CANIF         | CAN Interface module CANæ¥å£æ¨¡å—                     |
   +---------------+------------------------------------------------------+
   | CanSm         | CAN State Manager module CANçŠ¶æ€ç®¡ç†å™¨æ¨¡å—           |
   +---------------+------------------------------------------------------+
   | ComM          | Communication Manager moduleé€šä¿¡ç®¡ç†å™¨æ¨¡å—           |
   +---------------+------------------------------------------------------+
   | EcuM          | ECU State Manager module ECUçŠ¶æ€ç®¡ç†å™¨æ¨¡å—           |
   +---------------+------------------------------------------------------+
   | SchM          | Scheduler Moduleè°ƒåº¦ç¨‹åºæ¨¡å—                         |
   +---------------+------------------------------------------------------+

å‚è€ƒæ–‡æ¡£
========

[1]å‚è€ƒæ‰‹å†Œ_CanIf.pdf

[2]å‚è€ƒæ‰‹å†Œ_Com.pdf

[3]å‚è€ƒæ‰‹å†Œ_EcuC.pdf

[4]å‚è€ƒæ‰‹å†Œ_PduR.pdf

[5]å‚è€ƒæ‰‹å†Œ_CanSM.pdf

Cané€šä¿¡æ ˆé›†æˆ
=============

é¡¹ç›®äº¤ä»˜çš„å†…å®¹ä¸ºï¼šCané€šä¿¡æ ˆæºç å’ŒORIENTAIS
Configuratoré…ç½®å·¥å…·ã€‚é€šä¿¡æ ˆç»†åˆ†ä¸ºé€šä¿¡æ ˆçš„å„æ¨¡å—åŠå…¶å¯¹åº”çš„é…ç½®å·¥å…·æ¨¡å—ã€‚

é€šä¿¡æ ˆå„é…ç½®æ¨¡å—çš„åŠŸèƒ½ä»‹ç»ï¼Œå‚è§è¡¨ 4â€‘1é€šä¿¡æ ˆå„é…ç½®æ¨¡å—ä»‹ç»ã€‚

ä½¿ç”¨é€šä¿¡æ ˆæºç å’Œé…ç½®å·¥å…·ï¼Œè¿›è¡Œé€šä¿¡æ ˆçš„é›†æˆçš„æ­¥éª¤ï¼Œå‚è§è¡¨ 4â€‘2
é€šä¿¡æ ˆé›†æˆçš„æ­¥éª¤ã€‚

.. table:: è¡¨ 4â€‘1é€šä¿¡æ ˆå„é…ç½®æ¨¡å—ä»‹ç»

   +---------+------------------------------------------------------------+
   | **æ¨¡\   | **åŠŸèƒ½**                                                   |
   | å—å**  |                                                            |
   +---------+------------------------------------------------------------+
   | Can     | CANé©±åŠ¨é…ç½®ã€‚(ç”±mcalé…ç½®å·¥å…·å¯¼å…¥ï¼Œè¯¦è§ç« èŠ‚5.2.1)           |
   +---------+------------------------------------------------------------+
   | CanIf   | CanIfæ¨¡å—ä¸»è¦å¤„ç†ä¸Šå±‚æ¨¡å—ä¸åº•å±‚é©±åŠ¨çš„ä¹‹é—´                  |
   |         | PDUçš„ä¼ é€’ï¼Œä¸ºä¸Šå±‚æ¨¡å—æä¾›ç»Ÿä¸€çš„æ¥å£æ¥ç®¡ç†ä¸åŒçš„CANç¡¬ä»¶æ¨¡å— |
   +---------+------------------------------------------------------------+
   | EcuC    | ç”¨äºè¾…åŠ©é…ç½®å·¥å…·å®Œæˆé…ç½®çš„æ¨¡å—ã€‚ä¸»                         |
   |         | è¦æä¾›Pduçš„å®šä¹‰ï¼Œå…¶å®ƒæ¨¡å—é€šè¿‡å…³è”EcuCä¸­Pduï¼Œç›¸äº’å…³è”èµ·æ¥ã€‚ |
   +---------+------------------------------------------------------------+
   | PduR    | PDU                                                        |
   |         | Routerä¸»è¦ä¸ºé€šè®¯æ¥å£æ¨¡å—ï¼ˆCANIFï¼‰ã€ä¼ è¾“åè®®æ¨¡              |
   |         | å—ã€è¯Šæ–­é€šè®¯ç®¡ç†æ¨¡å—ä»¥åŠé€šè®¯æ¨¡å—æä¾›åŸºäºI-PDUçš„è·¯ç”±æœåŠ¡ã€‚  |
   +---------+------------------------------------------------------------+
   | Com     | COMæ¨¡å—ä¸»è¦æä¾›I-PDUå’Œä¿¡å·ç›¸å…³ç®¡ç†åŠŸèƒ½                     |
   +---------+------------------------------------------------------------+
   | CanSM   | ä¸»è¦åŠŸ                                                     |
   |         | èƒ½æ˜¯ä¸é€šä¿¡ç¡¬ä»¶æŠ½è±¡å±‚å’Œç³»ç»ŸæœåŠ¡å±‚äº§ç”Ÿäº¤äº’ï¼Œä¸ºæ¯ä¸€ä¸ªCANé€šä¿¡  |
   |         | æ€»çº¿å®šä¹‰ä¸€ä¸ªæ€»çº¿ç›¸å…³çš„çŠ¶æ€ç®¡ç†ï¼Œå¹¶ä¸ºç›¸å…³çš„æ€»çº¿æä¾›æµæ§åˆ¶ã€‚ |
   +---------+------------------------------------------------------------+

.. table:: è¡¨ 4â€‘2 é€šä¿¡æ ˆé›†æˆçš„æ­¥éª¤

   +-----+--------------------------+------------------------------------+
   |     | **æ“ä½œ**                 | **è¯´æ˜**                           |
   |**æ­¥\|                          |                                    |
   |éª¤** |                          |                                    |
   |     |                          |                                    |
   +-----+--------------------------+------------------------------------+
   | 1   | ORIENTAIS                | è‹¥é…ç½®å·¥å…·å·²ç»æ­å»º                 |
   |     | Stuidoé…ç½®å·¥å…·           | ï¼Œåˆ™ä»…éœ€è¿›è¡Œé€šä¿¡æ ˆæ¨¡å—çš„åŠ è½½æ“ä½œã€‚ |
   |     | å·¥ç¨‹æ­å»ºå’Œé€šä¿¡æ ˆæ¨¡å—åŠ è½½ |                                    |
   +-----+--------------------------+------------------------------------+
   | 2   | æ¨¡å—é…ç½®åŠé…ç½®æ–‡ä»¶ç”Ÿæˆ   | NA                                 |
   +-----+--------------------------+------------------------------------+
   | 3   | ä»£ç é›†æˆ                 | ç°æœ‰å·¥ç¨‹ã€                         |
   |     |                          | é€šä¿¡æ ˆæºä»£ç å’Œé…ç½®ç”Ÿæˆæ–‡ä»¶çš„é›†æˆã€‚ |
   +-----+--------------------------+------------------------------------+
   | 4   | éªŒè¯æµ‹è¯•                 | NA                                 |
   +-----+--------------------------+------------------------------------+

**æ³¨æ„ï¼šé€šä¿¡æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬é€šä¿¡æ ˆç›¸å…³çš„å…¶ä»–é€šä¿¡æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

æ–°å»ºORIENTAIS Configuratoré…ç½®å·¥ç¨‹åŠæ¨¡å—åŠ è½½
--------------------------------------------

#. å®‰è£…ORIENTAIS Configuratorè½¯ä»¶åï¼ŒåŒå‡»è½¯ä»¶å›¾æ ‡æ‰“å¼€è½¯ä»¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image1.png
   :width: 5.63542in
   :height: 4.11528in

å›¾ 4â€‘1 é…ç½®å·¥ç¨‹-1

2. èœå•æ FileğŸ¡ªNewğŸ¡ªProjectï¼Œæ–°å»ºå·¥ç¨‹ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image2.png
   :width: 5.65625in
   :height: 4.19167in

å›¾ 4â€‘2 é…ç½®å·¥ç¨‹-2

3. åœ¨å¼¹å‡ºçš„æ–°å»ºçª—å£ä¸­é€‰æ‹©Autosarä¸‹çš„ [BSW Project]ï¼Œé€‰æ‹©Nextã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image3.png
   :width: 5.67708in
   :height: 4.14375in

å›¾ 4â€‘3 é…ç½®å·¥ç¨‹-3

4. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥å·¥ç¨‹åï¼Œé€‰æ‹©Finishã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image4.png
   :width: 5.76736in
   :height: 4.18611in

å›¾ 4â€‘4 é…ç½®å·¥ç¨‹-4

5. åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©Yesã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image5.png
   :width: 5.4375in
   :height: 2.55208in

å›¾ 4â€‘5 é…ç½®å·¥ç¨‹-5

6. é€‰æ‹©[Bsw_Builder]ï¼Œå³é”®å•å‡»ï¼Œé€‰æ‹©New ECU Configurationã€‚

|image1|

å›¾ 4â€‘6 é…ç½®å·¥ç¨‹-6

7. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥ECUåï¼Œç„¶åé€‰æ‹©Nextã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image7.png
   :width: 4.56173in
   :height: 4.32713in

å›¾ 4â€‘7 é…ç½®å·¥ç¨‹-7

8. åœ¨å¼¹å‡ºçš„çª—å£ä¸­å‹¾é€‰éœ€æ·»åŠ çš„æ¨¡å—ï¼Œç‚¹å‡»Finishã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image8.png
   :width: 5.46875in
   :height: 5.1875in

å›¾ 4â€‘8 é…ç½®å·¥ç¨‹-8

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image9.png
   :width: 5.52235in
   :height: 1.32451in

å›¾ 4â€‘9 é…ç½®å·¥ç¨‹-9

9. æ–°å»ºå·¥ç¨‹å¦‚ä¸‹æ‰€ç¤ºï¼Œæ­¥éª¤â‘¦ä¸­æ·»åŠ çš„æ¨¡å—å·²ç»è¢«åŠ å…¥åˆ°å·¥ç¨‹ä¸­ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image10.png
   :width: 5.76736in
   :height: 2.10069in

å›¾ 4â€‘10 é…ç½®å·¥ç¨‹-10

æ¨¡å—é…ç½®åŠä»£ç ç”Ÿæˆ
------------------

æ¨¡å—é…ç½®
~~~~~~~~

æ¨¡å—çš„å…·ä½“é…ç½®ï¼Œå–å†³äºå…·ä½“çš„é¡¹ç›®éœ€æ±‚ã€‚è¯¥é€šä¿¡æ ˆå„æ¨¡å—é…ç½®é¡¹çš„è¯¦ç»†ä»‹ç»ï¼Œå‚è§è¡¨
4 3é€šä¿¡æ ˆå„æ¨¡å—é…ç½®å‚è€ƒæ–‡æ¡£ã€‚

.. table:: è¡¨ 4â€‘3é€šä¿¡æ ˆå„æ¨¡å—é…ç½®å‚è€ƒæ–‡æ¡£

   +--------+---------------------------------------------+--------------+
   |**æ¨¡å—**| **å‚è€ƒæ–‡æ¡£åŠå…¶ç« èŠ‚**                        | **è¯´æ˜**     |
   |        |                                             |              |
   +--------+---------------------------------------------+--------------+
   | Can    | MCALå¯¹åº”çš„Cané…ç½®æ‰‹å†Œ                       |              |
   +--------+---------------------------------------------+--------------+
   | CanIf  | å‚è€ƒæ‰‹å†Œ_CanIf.pdf                          |              |
   +--------+---------------------------------------------+--------------+
   | PduR   | å‚è€ƒæ‰‹å†Œ_PduR.pdf                           |              |
   +--------+---------------------------------------------+--------------+
   | Com    | å‚è€ƒæ‰‹å†Œ_Com.pdf                            |              |
   +--------+---------------------------------------------+--------------+
   | CanSM  | å‚è€ƒæ‰‹å†Œ_CanSM.pdf                          |              |
   +--------+---------------------------------------------+--------------+
   | EcuC   | å‚è€ƒæ‰‹å†Œ_EcuC.pdf                           |              |
   +--------+---------------------------------------------+--------------+
   | ComM   | å‚è€ƒæ‰‹å†Œ_ComM.pdf                           |              |
   +--------+---------------------------------------------+--------------+

é…ç½®ä»£ç ç”Ÿæˆ
~~~~~~~~~~~~

#. åœ¨ORIENTAIS Stuidoä¸»ç•Œé¢å·¦æ–¹ï¼Œé€‰æ‹©å¯¹åº”çš„é€šä¿¡æ ˆï¼Œå•å‡»å³é”®å¼¹å‡ºValidate
   Allå’ŒGenerate Allèœå•ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image11.png
   :width: 5.76736in
   :height: 2.96111in

å›¾ 4â€‘11 æ¨¡å—é…ç½®

2. é€‰æ‹©Validate
   Allå¯¹æœ¬é€šä¿¡æ ˆå„é…ç½®é€‰é¡¹è¿›è¡Œæ ¡éªŒï¼Œæ²¡æœ‰é”™è¯¯æç¤ºä¿¡æ¯å³æ ¡éªŒé€šè¿‡ã€‚è‹¥æœ‰é”™è¯¯ä¿¡æ¯ï¼Œè¯·æŒ‰ç…§é”™è¯¯æç¤ºä¿®æ”¹ã€‚

3. é€‰æ‹©Generate
   Allï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚å³ä¸‹è§’çš„Consoleçª—å£è¾“å‡ºç”Ÿæˆçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image12.png
   :width: 4.54236in
   :height: 1.31458in

å›¾ 4â€‘12 æ¨¡å—é…ç½®

4. å°†ORIENTAIS Configuratoråˆ‡æ¢åˆ°Resourceæ¨¡å¼ï¼Œå³å¯æŸ¥çœ‹ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image13.png
   :width: 5.77153in
   :height: 2.04097in

å›¾ 4â€‘13 æ¨¡å—é…ç½®

åŠŸèƒ½é›†æˆ
--------

ä»£ç é›†æˆ
~~~~~~~~

é€šä¿¡æ ˆä»£ç åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šé¡¹ç›®æä¾›çš„é€šä¿¡æ ˆæºç å’ŒORIENTAIS
Configuratoré…ç½®ç”Ÿæˆä»£ç ã€‚é€šä¿¡æ ˆé›†æˆåŒ…æ‹¬é€šä¿¡æ ˆæºç ï¼ˆCANã€CanIfã€PduRã€ComMã€CanSMç­‰ï¼‰ã€å®šæ—¶å™¨æºç å’Œéƒ¨åˆ†å…¶ä»–æ¨¡å—æºç ï¼Œå…·ä½“æ–‡ä»¶è§è¡¨4-4ã€‚

ç”¨æˆ·é¡»å°†é€šä¿¡æ ˆæºç å’Œç« èŠ‚4.2.2ç”Ÿæˆçš„æºä»£ç æ·»åŠ åˆ°é›†æˆå¼€å‘å·¥å…·çš„å¯¹åº”æ–‡ä»¶å¤¹ã€‚é€šä¿¡æ ˆé›†æˆçš„æ–‡ä»¶ç»“æ„ï¼Œè§ç« èŠ‚â‘£ã€‚

è¡¨4-4é€šä¿¡æ ˆæºç æ–‡ä»¶

+-----------------+---------------------------------+-----------------+
| ç§»åº“æ–‡ä»¶å¤¹      | ç§»åº“æ–‡ä»¶                        | è¯´æ˜            |
+-----------------+---------------------------------+-----------------+
| ComM            | ComM.cã€ComM_MemMap.hã€         | é€šä¿¡æ ˆæºç       |
|                 |                                 |                 |
|                 | ComM.hã€ã€ComM_Internal.cã€     |                 |
|                 |                                 |                 |
|                 | ComM_BusSM.hã€ComM_Nm.h         |                 |
|                 |                                 |                 |
|                 | ComM_Com.hã€ComM_Internal.hã€   |                 |
|                 |                                 |                 |
|                 | ComM_Dcm.hã€ComM_EcuMBswM.h     |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 |                                 |                 |
+-----------------+---------------------------------+-----------------+
| CanIf           | CanIf.cã€CanIf_Types.h          |                 |
|                 |                                 |                 |
|                 | CanIf.hã€ã€CanIf_MemMap.hã€     |                 |
|                 |                                 |                 |
|                 | CanIf_Cbk.h                     |                 |
|                 |                                 |                 |
+-----------------+---------------------------------+-----------------+
| CanSM           | CanSM.cã€CanSM_MemMap.hã€       |                 |
|                 |                                 |                 |
|                 | CanSM.hã€CanSM_BswM.hã€         |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 | CanSM_Cbk.hã€CanSM_ComM.hã€     |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 | CanSM_TxTimeoutException.h      |                 |
+-----------------+---------------------------------+-----------------+
| PDUR            | PduR_CanIf.hã€PduR_Com.hã€      |                 |
|                 |                                 |                 |
|                 | P\                              |                 |
|                 | duR_Internal.cã€PduR_Internal.h |                 |
|                 |                                 |                 |
|                 |                                 |                 |
|                 | PduR.cã€PduR_Types.hã€          |                 |
|                 |                                 |                 |
|                 | PduR.hã€PduR_MemMap.hã€         |                 |
+-----------------+---------------------------------+-----------------+
| Com             | Com.cã€Com_Types.hã€Com_Cbk.hã€ |                 |
|                 |                                 |                 |
|                 | Com.hã€Com_TxInternal.c         |                 |
|                 |                                 |                 |
|                 | Com_GwInternal.cã€Com_Internal.c|                 |
|                 |                                 |                 |
|                 | Com_Internal.hã€                |                 |
|                 | Com_MemMap.hã€Com_RxInternal.c  |                 |
+-----------------+---------------------------------+-----------------+
| SchM            | SchM.cã€                        | SchMéƒ¨åˆ†æºç     |
|                 |                                 |                 |
|                 | SchM.hã€                        |                 |
|                 |                                 |                 |
|                 | SchM_Com.hã€                    |                 |
|                 |                                 |                 |
|                 | SchM_ComM.hã€                   |                 |
|                 |                                 |                 |
|                 | SchM_CanIf.hã€                  |                 |
|                 |                                 |                 |
|                 | SchM_PduR.hã€                   |                 |
+-----------------+---------------------------------+-----------------+
| BswM            | BswM.cã€                        | BswMéƒ¨åˆ†æºç     |
|                 |                                 |                 |
|                 | BswM.hã€                        |                 |
|                 |                                 |                 |
|                 | BswM_CanSM.hã€                  |                 |
|                 |                                 |                 |
|                 | BswM_ComM.hã€                   |                 |
+-----------------+---------------------------------+-----------------+
| EcuM            | EcuM_Types.hã€                  | EcuMéƒ¨åˆ†æºç     |
|                 |                                 |                 |
|                 | EcuM.hã€                        |                 |
+-----------------+---------------------------------+-----------------+

**æ³¨æ„ï¼šé€šä¿¡æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬é€šä¿¡æ ˆç›¸å…³çš„å…¶ä»–é€šä¿¡æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

é›†æˆæ³¨æ„äº‹é¡¹
~~~~~~~~~~~~

å¯¹äºé›†æˆè¿‡ç¨‹ä¸­ï¼Œé€šä¿¡æ ˆç‰¹æ®Šè¦æ±‚å’Œç”¨æˆ·ç»å¸¸å‡ºç°çš„é—®é¢˜ï¼Œå½’ç±»æ€»ç»“å½¢æˆ è¡¨
4â€‘5é€šä¿¡æ ˆé›†æˆçº¦æŸæ¸…å•ã€‚ç”¨æˆ·éœ€é€ä¸€æ’æŸ¥è¡¨ä¸­çš„çº¦æŸé¡¹ï¼Œä»¥é¿å…é›†æˆé—®é¢˜å‡ºç°ã€‚

.. table:: è¡¨ 4â€‘5 é€šä¿¡æ ˆé›†æˆçº¦æŸæ¸…å•

   +-----+---------+-----------------------------------------------------+
   |**ç¼–\|         | **çº¦æŸé™åˆ¶**                                        |
   |å·** | **ç±»åˆ«**|                                                     |
   |     |         |                                                     |
   |     |         |                                                     |
   +-----+---------+-----------------------------------------------------+
   |**1**| ä¸­æ–­    | é€šä¿¡æ ˆ                                              |
   |     |         | æœ‰ä¸­æ–­ã€è½®è¯¢æˆ–æ··åˆä¸‰ç§å·¥ä½œæ¨¡å¼ã€‚è‹¥é€‰å–ä¸­æ–­æˆ–æ··åˆæ¨¡  |
   |     |         | å¼ï¼Œç”¨æˆ·éœ€åœ¨é€šä¿¡æ ˆé…ç½®å¯¹åº”çš„ä¸­æ–­å¹¶å¡«å……ä¸­æ–­æœåŠ¡APIã€‚ |
   +-----+---------+-----------------------------------------------------+
   |**2**| å †æ ˆ    | ç”¨æˆ·éœ€ç¡®ä¿ä¸ºä»»åŠ¡å †æ ˆå’Œä¸­æ–­å †æ ˆåˆ†é…è¶³å¤Ÿçš„å †æ ˆç©ºé—´ã€‚  |
   |     |         |                                                     |
   +-----+---------+-----------------------------------------------------+
   |**3**| å¤´æ–‡ä»¶  |æ·»åŠ é€šä¿¡æ ˆä»£ç ä¹‹åï¼Œç”¨æˆ·éœ€æ›´æ–°é›†æˆå¼€å‘å·¥å…·ä¸­çš„å¤´æ–‡ä»¶ |
   |     |         |è·¯å¾„ã€‚                                               |
   |     |         |                                                     |
   |     |         |è°ƒç”¨é€šä¿¡æ ˆAPIçš„æºæ–‡ä»¶ï¼Œéœ€è¦åŒ…å«é€šä¿¡æ ˆçš„å¤´æ–‡ä»¶ã€‚      |
   +-----+---------+-----------------------------------------------------+
   |**4**| åˆå§‹åŒ–  | ä»¥CANé€šä¿¡ä¸ºä¾‹ï¼Œé€šä¿¡æ ˆçš„åˆå§‹åŒ–é¡ºåºä¸ºï¼šCan_Initï¼Œ     |
   |     |         | CanIf_Initï¼Œ PduR_Initï¼Œ Com_Initï¼ŒCanSM_Initã€‚     |
   +-----+---------+-----------------------------------------------------+
   |**5**| å‘¨\     | Com_MainFunctionRxï¼ŒCom_MainFunctionRouteSi         |
   |     | æœŸå‡½æ•°  | gnalså’ŒCom_MainFunctionTxéœ€è¦è¢«å‘¨æœŸæ€§ä»»åŠ¡å‡½æ•°è°ƒç”¨ã€‚ |
   +-----+---------+-----------------------------------------------------+

é›†æˆç¤ºä¾‹
========

æœ¬ç« èŠ‚é€šè¿‡æ™®é€šçš„CANé€šä¿¡æ ˆä¸ºä¾‹ï¼Œå‘ç”¨æˆ·å±•ç¤ºé€šä¿¡æ ˆçš„é›†æˆè¿‡ç¨‹ã€‚ç”¨æˆ·å¯ä»¥æ®æ­¤ç†Ÿæ‚‰é€šä¿¡æ ˆé…ç½®å·¥å…·çš„é…ç½®è¿‡ç¨‹ï¼Œä»¥åŠå¦‚ä½•åº”ç”¨é…ç½®å·¥å…·ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

ä¸ºè®©ç”¨æˆ·æ›´æ¸…æ™°çš„äº†è§£å·¥å…·çš„ä½¿ç”¨ï¼Œæ‰€ç”¨çš„é…ç½®å‡é€ä¸€æ‰‹åŠ¨å®Œæˆã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨å·¥å…·ä¸­çš„DBCå¯¼å…¥åŠŸèƒ½ï¼Œå¿«é€Ÿå®Œæˆé…ç½®ã€‚DBCå¯¼å…¥åŠŸèƒ½ä¸å±äºæœ¬æ–‡æ¡£ä»‹ç»èŒƒç•´ï¼Œå…·ä½“æ“ä½œè¯·å‚ç…§ã€Šå‚è€ƒæ‰‹å†Œ_ORIENTAIS Studio_ä½¿ç”¨æŒ‡å—.pdfã€‹ã€‚

**æ³¨æ„ï¼šæœ¬ç¤ºä¾‹ä¸ä»£è¡¨ç”¨æˆ·çš„å®é™…é…ç½®æƒ…å†µï¼Œç”¨æˆ·éœ€è¦æ ¹æ®è‡ªå·±çš„å®é™…éœ€æ±‚ï¼Œå†³å®šå„ä¸ªå‚æ•°çš„é…ç½®ã€‚**

é›†æˆç›®æ ‡
--------

**CANæŠ¥æ–‡éœ€æ±‚ï¼š**

.. table:: è¡¨ 5â€‘1

   +--------+------------------+------+------+-------+----------+-------+
   | **æŠ¥\  | **æŠ¥æ–‡**\        | **å‘\| **å‘\|  **æŠ¥\| **æŠ¥æ–‡\  | **å·¥\ |
   | æ–‡ID** | **åç§°**         | é€** | é€**\|  æ–‡**\| é•¿åº¦**   | ä½œ**\ |
   |        |                  | **æ¥\| **æ¨¡\|  **å‘¨\|          | **æ¨¡\ |
   |        |                  | æ”¶** | å¼** |  æœŸ** |          | å¼**  |
   |        |                  |      |      |       |          |       |
   |        |                  |      |      |       |          |       |
   +--------+------------------+------+------+-------+----------+-------+
   | 0x100  | CAN_Tx_Message1  | å‘é€ | å‘¨æœŸ | 50ms  | 8\       | è½®è¯¢  |
   |        |                  |      |      |       | **å­—èŠ‚** |       |
   +--------+------------------+------+------+-------+----------+-------+
   | 0x105  | CAN_Tx_Message2  | å‘é€ | è§¦å‘ | -     | 8\       | è½®è¯¢  |
   |        |                  |      |      |       | **å­—èŠ‚** |       |
   +--------+------------------+------+------+-------+----------+-------+
   | 0x120  | CAN_Rx_Message1  | æ¥æ”¶ | NA   | 100ms | 8\       | è½®è¯¢  |
   |        |                  |      |      |       | **å­—èŠ‚** |       |
   +--------+------------------+------+------+-------+----------+-------+
   | 0x125  | CAN_Rx_Message2  | æ¥æ”¶ | NA   | -     | 8\       | è½®è¯¢  |
   |        |                  |      |      |       | **å­—èŠ‚** |       |
   +--------+------------------+------+------+-------+----------+-------+

**CANæŠ¥æ–‡ä¿¡å·éœ€æ±‚ï¼š**

-  CAN_Tx_Message1(0x100)åŒ…å«çš„ä¿¡å·

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image14.png
   :width: 5.77153in
   :height: 0.87708in

å›¾ 5â€‘1 é›†æˆç¤ºä¾‹-1

-   CAN_Tx_Message2(0x105) åŒ…å«çš„ä¿¡å·

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image15.png
   :width: 5.77153in
   :height: 0.37708in

å›¾ 5â€‘2 é›†æˆç¤ºä¾‹-2

-  CAN_Rx_Message1(0x120) åŒ…å«çš„ä¿¡å·

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image16.png
   :width: 5.77153in
   :height: 0.89583in

å›¾ 5â€‘3 é›†æˆç¤ºä¾‹-3

-  CAN_Rx_Message1(0x125) åŒ…å«çš„ä¿¡å·

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image17.png
   :width: 5.77153in
   :height: 0.35in

å›¾ 5â€‘4 é›†æˆç¤ºä¾‹-4

æ¨¡å—çš„é…ç½®
----------

æ–°å»ºé…ç½®å·¥ç¨‹åŠæ¨¡å—åŠ è½½æ“ä½œï¼Œè¯·å‚è€ƒæœ¬æ–‡æ¡£4.2ç« èŠ‚ã€‚

Canæ¨¡å—é…ç½®
~~~~~~~~~~~

æœ‰å¤šç§å·¥å…·å¯ä»¥ç”¨äºé…ç½®mcalï¼Œæœ¬ç« ä»‹ç»å¦‚ä½•ä½¿ç”¨EBå·¥å…·é…ç½®Canæ¨¡å—ï¼Œä½†æ˜¯åªæ¶‰åŠåˆ°ä¸é€šä¿¡æ ˆä¸­æŠ¥æ–‡æ”¶å‘æœ‰å…³ç³»çš„éƒ¨åˆ†ï¼ˆä¸»è¦æ˜¯HardwareObejectï¼‰ï¼Œå…¶ä½™é…ç½®é€‰é¡¹è¯·å‚è€ƒEBå·¥å…·çš„å¸®åŠ©æ‰‹å†Œè¿›è¡Œé…ç½®ã€‚

#. æ‰“å¼€EBå·¥å…·ï¼Œæ–°å»ºCANæ¨¡å—åï¼Œåœ¨ä»¥ä¸‹è·¯å¾„é…ç½®HardwareObjectï¼š

CANæ¨¡å—ğŸ¡ªCanConfigSetğŸ¡ªCanHardwareObjectã€‚

æ ¹æ®æœ¬æ¬¡é…ç½®ç¤ºä¾‹çš„ç›®æ ‡ï¼Œéœ€è¦é…ç½®4ä¸ªHardwareObjectï¼Œå¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image18.png
   :width: 5.50839in
   :height: 1.08545in

å›¾ 5â€‘5 æ¨¡å—é…ç½®-1

**æ³¨æ„ï¼šHardwareObjectå®šä¹‰çš„æ—¶å€™ï¼Œå¿…é¡»æ¥æ”¶æŠ¥æ–‡æ”¾åœ¨å‘é€æŠ¥æ–‡å‰é¢ã€‚**

2. å®ŒæˆEBé…ç½®åï¼Œç”ŸæˆCanæ¨¡å—çš„é…ç½®æ–‡ä»¶ï¼Œæ›¿æ¢å·¥ç¨‹ä¸­åŸæœ‰çš„Canæ¨¡å—çš„é…ç½®æ–‡ä»¶ã€‚

3. å¯¼å‡ºEBçš„é…ç½®æ–‡ä»¶ã€‚

4. å°†â‘¢å¯¼å‡ºçš„é…ç½®æ–‡ä»¶ï¼Œå¯¼å…¥åˆ°ORIENTAIS Configuratorä¸­ã€‚

..

   å¯¼å…¥åå·¥ç¨‹å¦‚ä¸‹å›¾æ‰€ç¤ºï¼š

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image19.png
   :width: 5.57292in
   :height: 2.40296in

å›¾ 5â€‘6 æ¨¡å—é…ç½®-2

CanIfæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. åŒå‡»CanIfæ¨¡å—ï¼Œæ‰“å¼€CanIfæ¨¡å—çš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image20.png
   :width: 5.76736in
   :height: 2.40972in

å›¾ 5â€‘7 æ¨¡å—é…ç½®-3

2. CanIfPublicCfgã€CanIfPrivateCfgã€CanIfDispatchCfgã€CanIfTrcvDrvCfgæ ‡ç­¾é¡µå‡ä¿æŒé»˜è®¤å€¼ï¼Œä¸éœ€è¦é…ç½®ã€‚

3. åœ¨CanIfInitCfgæ ‡ç­¾é¡µä¸‹çš„å®¹å™¨[CanIfInitCfg]ä¸Šï¼Œå³è¾¹æ–°å»ºä¸€ä¸ªCanIfInitHohCfgå¯¹è±¡ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image21.png
   :width: 5.76736in
   :height: 2.71597in

å›¾ 5â€‘8 æ¨¡å—é…ç½®-4

4. CanIfCtrlDrvCfgé…ç½®ã€‚

..

   [CanIfCtrlDrvCfg_0]çš„é…ç½®é¡¹CanIfCtrlDrvInitHohConfigReféœ€è¦å…³è”åˆ°æ­¥éª¤â‘¢ä¸­åˆ›å»ºçš„HOHå¯¹è±¡ã€‚

   [CanIfCtrlDrvNameRef]çš„é…ç½®é¡¹é€‰Canã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image22.png
   :width: 5.76736in
   :height: 3.48194in

å›¾ 5â€‘9 æ¨¡å—é…ç½®-5

5. CanIfCtrlCfgé…ç½®ï¼š

..

   å°†é»˜è®¤ç”Ÿæˆçš„[CanIfCtrlCfg_0]åå­—æ”¹ä¸º[CanIfCtrlCfg_Controller0]ã€‚

   å‚æ•°CanIfCtrlCanCtrlRefï¼Œé€‰æ‹©CanController_0ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image23.png
   :width: 5.76736in
   :height: 3.44792in

å›¾ 5â€‘10 æ¨¡å—é…ç½®-6

å¯åœ¨å®¹å™¨[CanIfInitCfg]ä¸Šå³é”®ï¼Œæ–°å»ºCanIfBufferCfgã€CanIfInitHohCfgã€CanIfRxPduCfgã€CanIfTxPduCfgã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image24.png
   :width: 5.77153in
   :height: 3.56736in

å›¾ 5â€‘11 æ¨¡å—é…ç½®-7

6. æ–°å»ºä¸€ä¸ªCanIfInitHohCfgï¼Œå†åœ¨æ–°å»ºçš„å®¹å™¨[CanIfInitHohCfg_0]ä¸Šå³é”®æ–°å»º2ä¸ªCanIfHrhCfgå’Œ2ä¸ªCanIfHthCfgã€‚ç„¶åå°†æ–°å»ºçš„å®¹å™¨æ”¹ä¸ºæœ‰æ„ä¹‰çš„åå­—ã€‚

..

   æ¯ä¸ªå‘é€æŠ¥æ–‡éœ€è¦ä¸€ä¸ªCanIfHrhCfgï¼Œæ¯ä¸ªæ¥æ”¶æŠ¥æ–‡éœ€è¦ä¸€ä¸ªCanIfHthCfgã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image25.png
   :width: 5.76736in
   :height: 3.06389in

å›¾ 5â€‘12 æ¨¡å—é…ç½®-8

7. é…ç½®CanIfHrhCfg_Rx_Message1å’ŒCanIfHrhCfg_Rx_Message2ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image26.png
   :width: 5.76736in
   :height: 3.33264in

å›¾ 5â€‘13 æ¨¡å—é…ç½®-9

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image27.png
   :width: 5.76736in
   :height: 3.35in

å›¾ 5â€‘14 æ¨¡å—é…ç½®-10

8. é…ç½®CanIfHthCfg_Tx_Message1å’ŒCanIfHthCfg_Tx_Message2ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image28.png
   :width: 5.76736in
   :height: 3.1375in

å›¾ 5â€‘15 æ¨¡å—é…ç½®-11

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image29.png
   :width: 5.76736in
   :height: 3.30486in

å›¾ 5â€‘16 æ¨¡å—é…ç½®-12

9. æ–°å»º2ä¸ªCanIfBufferCfgï¼Œå¹¶ä¿®æ”¹åå­—ã€‚æ¯ä¸ªå‘é€æŠ¥æ–‡éœ€è¦å»ºç«‹ä¸€ä¸ªCanIfBufferCfgã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image30.png
   :width: 5.76736in
   :height: 3.41319in

å›¾ 5â€‘17 æ¨¡å—é…ç½®-13

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image31.png
   :width: 5.76736in
   :height: 3.24236in

å›¾ 5â€‘18 æ¨¡å—é…ç½®-14

10. æ–°å»º2ä¸ªCanIfRxPduCfgï¼Œå¹¶ä¿®æ”¹åå­—ã€‚æ¯ä¸ªæ¥æ”¶æŠ¥æ–‡éœ€è¦åœ¨CanIfä¸­é…ç½®å¯¹åº”çš„CanIfRxPduCfgã€‚æŠ¥æ–‡CAN_Rx_Message1å¯¹åº”çš„CanIfRxPduCfgå‚æ•°é…ç½®å¦‚ä¸‹ï¼š

.. table:: è¡¨ 5â€‘2

   +----------------------+------------------+----------------------------+
   | **å‚æ•°å**           | **è®¾ç½®å€¼**       |**è¯´æ˜**                    |
   +----------------------+------------------+----------------------------+
   | CanIfRxPduCanId      | 0x120            | æŠ¥æ–‡IDï¼ˆå‚ç…§DBCï¼‰          |
   +----------------------+------------------+----------------------------+
   | CanIfRxPduCanIdType  | STANDARD_CAN     | å¸§ç±»å‹ï¼šæ ‡å‡†å¸§             |
   +----------------------+------------------+----------------------------+
   | CanIfRxPduDlc        | 8                | æŠ¥æ–‡é•¿åº¦ ï¼ˆå‚ç…§DBCï¼‰       |
   +----------------------+------------------+----------------------------+
   | CanIfRxP             | PDUR             | CanIf                      |
   | duUserRxIndicationUL |                  | æ¨¡å—æ”¶åˆ°æŠ¥æ–‡åé€šçŸ¥PduRæ¨¡å— |
   +----------------------+------------------+----------------------------+
   | CanIfRxPduHrhIdRef   | CanIfHr          | å…³è”åˆ°å¯¹                   |
   |                      | hCfg_Rx_Message1 | åº”çš„Hrhï¼ˆæœ¬ç« èŠ‚æ­¥éª¤â‘§åˆ›å»ºï¼‰ |
   +----------------------+------------------+----------------------------+
   | CanIfRxPduRef        | CAN_Rx_Message1  | å…³è”åˆ°EcuCä¸­å®šä¹‰çš„pdu,æ­¤   |
   |                      |                  | å¤„å‘½åè§„åˆ™ä¸ºXXXï¼ˆæŠ¥æ–‡åï¼‰  |
   +----------------------+------------------+----------------------------+

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image32.png
   :width: 5.76736in
   :height: 3.32986in

å›¾ 5â€‘19 æ¨¡å—é…ç½®-15

ç”¨åŒæ ·çš„æ–¹æ³•é…ç½®CanIfRxPduCfg_Rx_Message2

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image33.png
   :width: 5.76736in
   :height: 3.23264in

å›¾ 5â€‘20 æ¨¡å—é…ç½®-16

11. æ–°å»º2ä¸ªCanIfTxPduCfgï¼Œå¹¶ä¿®æ”¹åå­—ã€‚æ¯ä¸ªæ¥æ”¶æŠ¥æ–‡éœ€è¦åœ¨CanIfä¸­é…ç½®å¯¹åº”çš„CanIfTxPduCfgã€‚æŠ¥æ–‡CAN_Tx_Message1å¯¹åº”çš„CanIfTxPduCfgå‚æ•°é…ç½®å¦‚ä¸‹ï¼š

.. table:: è¡¨ 5â€‘3

   +----------------------+------------------------+----------------------+
   | å‚æ•°å               | è®¾ç½®å€¼                 | è¯´æ˜                 |
   +----------------------+------------------------+----------------------+
   | CanIfTxPduCanId      | 0x100                  | CAN ID               |
   +----------------------+------------------------+----------------------+
   | CanIfTxPduCanIdType  | STANDARD_CAN           | å¸§ç±»å‹ï¼šæ ‡å‡†å¸§       |
   +----------------------+------------------------+----------------------+
   | CanIfTxPduType       | STATIC                 | é™æ€CAN ID           |
   +----------------------+------------------------+----------------------+
   | CanIfTxPdu           | PDUR                   | æŠ¥æ–‡å‘é€æˆåŠŸç¡®       |
   | UserTxConfirmationUL |                        | è®¤é€šçŸ¥ä¼ é€’ç»™PDURæ¨¡å— |
   +----------------------+------------------------+----------------------+
   | CanIfTxPduBufferRef  | C                      | å…³è”åˆ°å¯¹åº”HtH        |
   |                      | anIfHthCfg_Tx_Message1 |                      |
   +----------------------+------------------------+----------------------+
   | CanIfTxPduRef        | CAN_Tx_Message1        | å…³è”åˆ°EcuCä¸­çš„Pdu    |
   +----------------------+------------------------+----------------------+

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image34.png
   :width: 5.76736in
   :height: 3.26944in

å›¾ 5â€‘21 æ¨¡å—é…ç½®-17

ç”¨åŒæ ·çš„æ–¹æ³•é…ç½®CanIfTxPduCfg_Tx_Message2

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image35.png
   :width: 5.76736in
   :height: 3.24514in

å›¾ 5â€‘22 æ¨¡å—é…ç½®-18

12. æ ¡éªŒé…ç½®ï¼Œæ— é”™è¯¯ä¿¡æ¯ï¼Œå³é…ç½®å®Œæˆã€‚

EcuCæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. åŒå‡»EcuCæ¨¡å—ï¼Œæ‰“å¼€EcuCæ¨¡å—çš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image36.png
   :width: 5.76736in
   :height: 2.88958in

å›¾ 5â€‘23 EcuCé…ç½®-1

2. å³å‡»EcucConfigSetsæ–°å»ºEcucConfigSetï¼Œå³å‡»EcucConfigSetæ–°å»ºEcucPduCollectionsï¼Œå³å‡»EcucPduCollectionsæ–°å»ºEcucPduCollectionï¼Œå³å‡»EcucPduCollectionsæ–°å»ºMetaDataTypeså’ŒPdusï¼ŒMetaDataTypesä¿æŒé»˜è®¤ã€‚

3. æ–°å»º8ä¸ªPduå¹¶ä¿®æ”¹åå­—ï¼Œé…ç½®æŠ¥æ–‡æ–¹å‘å’ŒæŠ¥æ–‡é•¿åº¦ã€‚

..

   æ³¨æ„ï¼š

   **æ­¤å¤„é…ç½®pduä¸ºä¸¤ç»„ï¼Œå‘½åéœ€è¦åˆ†å¼€ï¼Œæ–¹ä¾¿åç»­é…ç½®éœ€è¦ä½¿ç”¨ã€‚æ¨èè§„åˆ™ä¸ºCom_XXXå’ŒXXXä¸¤ç§(XXXä»£è¡¨æŠ¥æ–‡å)ã€‚**

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image37.png
   :width: 5.76736in
   :height: 3.38542in

å›¾ 5â€‘24 EcuCé…ç½®-2

4. å…¶ä»–é¡µé¢ä¿æŒé»˜è®¤å³å¯ã€‚

Comæ¨¡å—é…ç½®
~~~~~~~~~~~

#. åŒå‡»Comæ¨¡å—ï¼Œæ‰“å¼€Comæ¨¡å—çš„é…ç½®ç•Œé¢ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image38.png
   :width: 5.76736in
   :height: 2.64306in

å›¾ 5â€‘25 Comé…ç½®-1

2. ComSupportedIPduGroupså¡«å†™æ•°ç›®ï¼Œä¸”ä¸ComIPduGroupæ•°é‡ä¿æŒä¸€è‡´ï¼Œå…¶ä»–é…ç½®é€‰æ‹©é»˜è®¤ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image39.png
   :width: 5.76736in
   :height: 2.6375in

å›¾ 5â€‘26 Comé…ç½®-2

3. é€‰æ‹©ComConfigé¡µé¢é…ç½®ï¼Œæ–°å»ºç›®æ ‡æ•°é‡çš„ComIPduã€ComIPduGroupã€ComSignalå¹¶ä¿®æ”¹åç§°ã€‚

..

   å‘é€ComIPduçš„å±æ€§é…ç½®å¦‚å›¾ã€‚

   æ¥æ”¶ComIPduçš„å±æ€§é…ç½®ComIPduDirectionä¸ºRECEIVEå’ŒComIPduGroupRefæ–°å»ºé€‰æ‹©ComIPduGroup_Rxã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image40.png
   :width: 5.76736in
   :height: 2.61806in

å›¾ 5â€‘27 Comé…ç½®-3

4. é€‰ä¸­ComIPduï¼Œé…ç½®å‘é€ComIPduçš„å±æ€§é…ç½®å¦‚å›¾ã€‚

..

   æ¥æ”¶ComIPduçš„å±æ€§é…ç½®ComIPduDirectionä¸ºRECEIVEå’ŒComIPduGroupRefæ–°å»ºé€‰æ‹©ComIPduGroup_Rxã€‚

   æ³¨æ„ï¼šComPduIdRefé€‰æ‹©Com_XXçš„ç›¸åº”æŠ¥æ–‡ï¼Œæ­¤å¤„å¯¹åº”EcuCçš„é…ç½®ã€‚

   ComIPduSignalReféœ€è¦æ–°å»ºé€‰æ‹©è¯¥æŠ¥æ–‡æ‰€åŒ…å«çš„æ‰€æœ‰ä¿¡å·ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image41.png
   :width: 5.76736in
   :height: 2.59653in

å›¾ 5â€‘28 Comé…ç½®-4

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image42.png
   :width: 5.76736in
   :height: 2.63056in

å›¾ 5â€‘29 Comé…ç½®-5

5. åœ¨å‘é€IPDUæ–°å»ºComTxIPduï¼Œé…ç½®ComMinimumDelayTimeä¸º0.005sï¼Œå…¶ä»–ä¿æŒé»˜è®¤ã€‚

..

   åœ¨æ¥æ”¶IPDUä¸­ä¸éœ€è¦æ–°å»ºComTxIPduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image43.png
   :width: 5.76736in
   :height: 1.76597in

å›¾ 5â€‘30 Comé…ç½®-6

6. åœ¨å‘é€ComTxIPduæ–°å»ºComTxModeTrueï¼ŒæŒ‰ç…§éœ€æ±‚é€‰æ‹©ComTxModeModeä¸ºå‘¨æœŸã€äº‹ä»¶æˆ–è€…æ··åˆå‹å‘é€æ¨¡å¼æ­¤å¤„ä¸ºå‘¨æœŸå‹å‘é€ï¼ŒComTxModeNumberOfRepetitionsã€ComTxModeRepetitionPeriodã€ComTxModeTimeOffsetå’ŒComTxModeTimePeriodæŒ‰ç…§ä¸åŒå‘é€æ¨¡å¼é…ç½®å…·ä½“è¯·å‚ç…§éœ€æ±‚è®¾ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image44.png
   :width: 5.76736in
   :height: 2.19722in

å›¾ 5â€‘31 Comé…ç½®-7

7. é€‰å®šä¿¡å·åè®¾ç½®ComBitPositionã€ComBitSizeã€ComSignalEndiannessã€ComSignalInitValueã€ComSignalTypeå’ŒComTransferPropertyç­‰å‚æ•°ã€‚ComTransferPropertyçš„é…ç½®ï¼Œéœ€è¦è€ƒè™‘ä¸IPDUå‘é€æ¨¡å¼ç›¸é…åˆä»è€Œå®ç°ç›¸åº”çš„å‘é€ç±»å‹ï¼Œæ­¤å¤„ä¸ºå‘¨æœŸæŠ¥æ–‡é€‰æ‹©PENDINGã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image45.png
   :width: 5.76736in
   :height: 2.90833in

å›¾ 5â€‘32 Comé…ç½®-8

8. ComTimeBaseé…ç½®ä¿æŒé»˜è®¤ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image46.png
   :width: 5.76736in
   :height: 3.16389in

å›¾ 5â€‘33 Comé…ç½®-9

PduRæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. åŒå‡»PduRæ¨¡å—ï¼Œæ‰“å¼€PduRæ¨¡å—çš„é…ç½®ç•Œé¢ï¼ŒPduRGeneralä¿æŒé»˜è®¤é…ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image47.png
   :width: 5.76736in
   :height: 4.0625in

å›¾ 5â€‘34 PduRé…ç½®-1

2. æ‰“å¼€PduRBswModulesæ–°å»ºPduRBswModules_CanIfå’ŒPduRBswModules_Comï¼ŒPduRBswModuleRefåˆ†åˆ«é€‰æ‹©CanIfå’ŒComï¼Œå…¶ä»–é…ç½®ä¿æŒé»˜è®¤ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image48.png
   :width: 5.76736in
   :height: 2.6375in

å›¾ 5â€‘35 PduRé…ç½®-2

3. æ‰“å¼€PduRRoutingTablesæ–°å»ºä¸€ä¸ªPduRRoutingTableï¼Œå†PduRRoutingTableä¸­æ–°å»ºPduRRoutingPathå¦‚å›¾ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image49.png
   :width: 5.76736in
   :height: 2.64653in

å›¾ 5â€‘36 PduRé…ç½®-3

4. æ‰¾åˆ°å¹¶é€‰ä¸­PduRDestPduï¼Œé…ç½®å³è¾¹PduRDestPduRefã€‚

..

   æ³¨æ„ï¼š

   æ¥æ”¶æŠ¥æ–‡PduRDestPduRefé€‰æ‹©Com_XXXï¼ˆæ­¤å¤„å¯¹åº”EcuCçš„é…ç½®ï¼‰ï¼›

   å‘é€æŠ¥æ–‡PduRDestPduRefé€‰æ‹©XXXï¼ˆæ­¤å¤„å¯¹åº”EcuCçš„é…ç½®ï¼‰ï¼›

å¦‚ä¸‹å›¾ä¸ºå‘é€æŠ¥æ–‡é…ç½®ç›®æ ‡pduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image50.png
   :width: 5.76736in
   :height: 2.64306in

å›¾ 5â€‘37 PduRé…ç½®-4

5. æ‰¾åˆ°å¹¶é€‰ä¸­PduRSrcPduï¼Œé…ç½®å³è¾¹PduRSrcPduRefã€‚

..

   æ³¨æ„ï¼š

   æ¥æ”¶æŠ¥æ–‡PduRSrcPduRefé€‰æ‹©XXXï¼ˆæ­¤å¤„å¯¹åº”EcuCçš„é…ç½®ï¼‰ï¼›

   å‘é€æŠ¥æ–‡PduRDestPduRefé€‰æ‹©Com_XXXï¼ˆæ­¤å¤„å¯¹åº”EcuCçš„é…ç½®ï¼‰ï¼›

å¦‚ä¸‹å›¾ä¸ºå‘é€æŠ¥æ–‡é…ç½®æºpduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image51.png
   :width: 5.76736in
   :height: 2.63958in

å›¾ 5â€‘38 PduRé…ç½®-5

CanSMæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. æ‰¾åˆ°å¹¶é€‰ä¸­CanSMManagerNetworkï¼Œé…ç½®å³è¾¹CanSMComMNetworkHandleRefæ­¤é…ç½®ä¸ComMæ¨¡å—å…³è”ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image52.png
   :width: 5.76736in
   :height: 3.34653in

å›¾ 5â€‘39 CanSMpé…ç½®-1

2. æ‰¾åˆ°å¹¶é€‰ä¸­CanSMControllerï¼Œé…ç½®å³è¾¹CanSMControllerIdæ­¤é…ç½®ä¸CanIfæ¨¡å—å…³è”ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image53.png
   :width: 5.76736in
   :height: 3.34653in

å›¾ 5â€‘40 CanSMpé…ç½®-2

ComMæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. æ‰¾åˆ°å¹¶æ·»åŠ ComMUser

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image54.png
   :width: 5.76736in
   :height: 2.525in

å›¾ 5â€‘41 ComMæ¨¡å—é…ç½®-1

2. ä¿®æ”¹ComMChannelï¼Œé…ç½®å³è¾¹ComMBusTypeä¸ºCOMM_BUS_TYPE_CAN

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image55.png
   :width: 5.76736in
   :height: 2.88125in

å›¾ 5â€‘42 ComMæ¨¡å—é…ç½®-2

3. æ‰¾åˆ°ComMNetworkManagementé…ç½®ï¼ŒComMNmVariantè®¾ç½®ä¸ºNONE

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image56.png
   :width: 5.76736in
   :height: 2.1125in

å›¾ 5â€‘43 ComMæ¨¡å—é…ç½®-3

4. æ‰¾åˆ°ComMUserPreChannelsé…ç½®ï¼Œå°†ä¹‹å‰é…ç½®çš„userå…³è”åˆ°channel

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image57.png
   :width: 5.76736in
   :height: 2.88125in

å›¾ 5â€‘44 ComMæ¨¡å—é…ç½®-4

æºä»£ç é›†æˆ
----------

é¡¹ç›®äº¤ä»˜ç»™ç”¨æˆ·çš„å·¥ç¨‹ç»“æ„å¦‚ä¸‹ï¼š

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image58.png
   :width: 5.45833in
   :height: 5.30208in

å›¾ 5â€‘45 äº¤ä»˜å·¥ç¨‹

-  BSWç›®å½•ï¼Œè¿™ä¸ªç›®å½•æ”¾ç½®æ‰€æœ‰åŸºç¡€è½¯ä»¶ç›¸å…³ä»£ç ï¼Œé™¤äº†MCALã€Configæ–‡ä»¶å¤¹ä¹‹å¤–ï¼Œå‡æŒ‰bswæºç è·¯å¾„æ”¾ç½®

-  ASWç›®å½•ï¼Œå­˜æ”¾åº”ç”¨ä»£ç 

-  Configç›®å½•ï¼Œå­˜æ”¾mcalå’Œbswç”Ÿæˆçš„åŠ¨æ€ä»£ç ã€‚

-  MCALç›®å½•ï¼Œå­˜æ”¾mcalçš„é™æ€ä»£ç 

é€šä¿¡æ ˆæºä»£ç é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. å°†5.2ç« èŠ‚ä¸­EB MCALç”Ÿæˆçš„CANæ¨¡å—é…ç½®æ–‡ä»¶å’ŒORIENTAIS
   Configuratorç”Ÿæˆçš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°Config/BSW_Configæ–‡ä»¶å¤¹ä¸­ã€‚

#. å°†MCALæä¾›çš„CANæ¨¡å—æºç å’Œé¡¹ç›®æä¾›çš„é€šä¿¡æ ˆæºä»£ç æ–‡ä»¶å¤åˆ¶åˆ°BS
   Wå’ŒMCALæ–‡ä»¶å¤¹ä¸­ã€‚

é€šä¿¡æ ˆè°ƒåº¦é›†æˆ
--------------

é€šä¿¡æ ˆè°ƒåº¦é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. é€šä¿¡æ ˆè°ƒåº¦é›†æˆï¼Œéœ€è¦é€ä¸€æ’æŸ¥å¹¶å®ç°è¡¨ 5â€‘5é€šä¿¡æ ˆé›†æˆçº¦æŸæ¸…å•
   æ‰€ç½—åˆ—çš„é—®é¢˜ï¼Œä»¥é¿å…é›†æˆå‡ºç°å·®é”™ã€‚

#. ç¼–è¯‘é“¾æ¥ä»£ç ï¼Œå°†ç”Ÿæˆçš„elfæ–‡ä»¶çƒ§å†™è¿›èŠ¯ç‰‡ã€‚

é€šä¿¡æ ˆæœ‰å…³çš„ä»£ç ï¼Œåœ¨ä¸‹æ–¹çš„main.cæ–‡ä»¶ä¸­ç»™å‡ºé‡ç‚¹æ ‡æ³¨ã€‚

**æ³¨æ„ :
æœ¬ç¤ºä¾‹ä¸­ï¼Œé€šä¿¡æ ˆåˆå§‹åŒ–çš„ä»£ç å’Œå¯åŠ¨é€šä¿¡çš„ä»£ç ç½®äºmain.cæ–‡ä»¶ï¼Œå¹¶ä¸ä»£è¡¨å…¶ä»–é¡¹ç›®åŒæ ·é€‚ç”¨äºå°†å…¶ç½®äºmain.cæ–‡ä»¶ä¸­ã€‚**

**#include** <machine/wdtcon.h>

**#include** "Mcu.h"

**#include** "Port.h"

**#include** "Can_17_MCanP.h"

**#include** "CanIf.h"

**#include** "Com.h"

**#include** "PduR.h"

**#include** "ComM.h"

**#include** "CanSM.h"

**#include** "ComM_EcuMBswM.h"

**int** **main**\ (**void**)

{

/\*Initialize ECUM Module*/

EcuM_Init(&EcuM_ConfigAlternative[0]);

/\*Initialize FlsLoader*/

FlsLoader_Init(NULL_PTR);

/\*Dem module Pre_Init*/

Dem_PreInit();

Can_17_MCanP_Init(&Can_17_MCanP_ConfigRoot[0]);

CanIf_Init(&CanIf_InitCfgSet);

PduR_Init(&PduR_PBConfigData);

Com_Init(&Com_PBConfigData);

CanSM_Init(&CanSM_Config);

Com_IpduGroupVector ipduGroupVector;

Com_SetIpduGroup(ipduGroupVector, ComIPduGroup_CAN_Rx,TRUE);

Com_SetIpduGroup(ipduGroupVector, ComIPduGroup_CAN_Tx,TRUE);

Com_ReceptionDMControl(ipduGroupVector);

Com_IpduGroupControl(ipduGroupVector,TRUE);

ComM_RequestComMode(ComMChannel_0, COMM_FULL_COMMUNICATION);

ComM_CommunicationAllowed(ComMUser_0, TRUE);

Gpt_EnableNotification(GptConf_GptChannel_Gpt_1ms);

Gpt_StartTimer(GptConf_GptChannel_Gpt_1ms, 100000);

/\* infinite loop \*/

**while** (1)

{

**if**\ (Gpt_5msFlag == TRUE)

{

/\* please insert your code here ... \*/

uint64 u8_test = 0;

ComM_ModeType can_BusMode = COMM_NO_COMMUNICATION;

CanSM_MainFunction();

ComM_MainFunction\_ ComMChannel_0();

ComM_GetCurrentComMode(ComMUser_0,&can_BusMode);

**if** (COMM_FULL_COMMUNICATION == can_BusMode)

{

Com_MainFunctionRx();

Com_MainFunctionRouteSignals();

/\* Test Code \*/

**if** (TRUE == CAN_Rx_Message1_Signal1_Recevive_Flag)

{

CAN_Rx_Message1_Signal1_Recevive_Flag = FALSE;

Com_ReceiveSignal(CAN_Rx_Message1_Signal1,&u8_ComTest);

Com_SendSignal(CAN_Tx_Message1_Signal1,&u8_ComTest);

Com_ReceiveSignal(CAN_Rx_Message1_Signal2,&u8_ComTest);

Com_SendSignal(CAN_Tx_Message1_Signal2,&u8_ComTest);

Com_ReceiveSignal(CAN_Rx_Message1_Signal3,&u8_ComTest);

Com_SendSignal(CAN_Tx_Message1_Signal3,&u8_ComTest);

Com_ReceiveSignal(CAN_Rx_Message1_Signal4,&u8_ComTest);

Com_SendSignal(CAN_Tx_Message1_Signal4,&u8_ComTest);

}

if (TRUE == CAN_Rx_Message2_Signal1_Recevive_Flag)

{

CAN_Rx_Message2_Signal1_Recevive_Flag = FALSE;

Com_ReceiveSignal(CAN_Rx_Message2_Signal1,&u8_ComTest);

Com_SendSignal(CAN_Tx_Message2_Signal1,&u8_ComTest);

}

Com_MainFunctionTx();

}

}

**return** 1;

}

éªŒè¯ç»“æœ
--------

æ ¹æ®é›†æˆç›®æ ‡ï¼Œå…±é…ç½®äº†4ä¸ªæŠ¥æ–‡ï¼Œå…¶ä¸­1ä¸ªå‘¨æœŸå‘é€æŠ¥æ–‡ï¼Œ1ä¸ªè§¦å‘å‘é€æŠ¥æ–‡ï¼Œè¿˜æœ‰2ä¸ªä¸å‘é€æŠ¥æ–‡ä¿¡å·é…ç½®ä¸€è‡´çš„æ¥æ”¶æŠ¥æ–‡ã€‚

#. ç³»ç»Ÿå¯åŠ¨åæœ‰ä¸€ä¸ªæŠ¥æ–‡å‘é€ï¼ˆCAN_Tx_Message1ï¼‰ï¼ŒID
   0x100ï¼Œå‘¨æœŸ50msï¼Œåˆå§‹åŒ–å€¼å’Œè®¾ç½®ä¸€è‡´

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image59.png
   :width: 5.77153in
   :height: 0.41722in

å›¾ 5â€‘46 éªŒè¯ç»“æœ-1

2. æœ¬åœ°å‘é€ä¸€å¸§IDä¸º0x120çš„æŠ¥æ–‡(CAN_Rx_Message1)åï¼Œå‘é€æŠ¥æ–‡0x100(CAN_Tx_Message1)çš„å€¼å‘ç”Ÿå˜åŒ–

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image60.png
   :width: 5.77153in
   :height: 0.5476in

å›¾ 5â€‘47 éªŒè¯ç»“æœ-2

3. æœ¬åœ°å‘é€ä¸€å¸§IDä¸º0x125çš„æŠ¥æ–‡ï¼ˆCAN_Rx_Message2ï¼‰åï¼Œå¼€å‘æ¿å‘é€ä¸€å¸§IDä¸º0x105çš„æŠ¥æ–‡ï¼ˆCAN_Tx_Message2ï¼‰

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image61.png
   :width: 5.77153in
   :height: 0.74752in

å›¾ 5â€‘48éªŒè¯ç»“æœ-3

.. |image1| image:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image6.png
   :width: 5.76736in
   :height: 1.39792in
.. |image2| image:: ../../_static/é›†æˆæ‰‹å†Œ/CAN/image15.png
   :width: 5.77153in
   :height: 0.39306in
