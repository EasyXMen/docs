===================
UdpNm_é›†æˆæ‰‹å†Œ
===================





ç›®çš„
====

æœ¬é›†æˆæ‰‹å†Œç”¨äºæŒ‡å¯¼å®¢æˆ·è¿›è¡ŒUdpNmé›†æˆï¼Œæ–‡æ¡£ä¸»è¦åŒ…æ‹¬çš„å†…å®¹ä¸ºï¼šåè®®æ ˆé›†æˆæŒ‡å¯¼ã€åŸºäºæ™®é€šåº”ç”¨çš„é›†æˆç¤ºä¾‹è®²è§£ã€é¡¹ç›®é›†æˆç‰¹æ®Šè¯´æ˜ã€‚

ç”±äºå„é¡¹ç›®çš„éœ€æ±‚ä¸åŒï¼Œé›†æˆç¤ºä¾‹ä¸ä¼šé’ˆå¯¹äºç‰¹å®šçš„å•†ä¸šé¡¹ç›®åšè¯¦ç»†è®²è§£ã€‚

ç¼©å†™è¯å’Œæœ¯è¯­
============

.. table:: è¡¨ 2â€‘1 ç¼©å†™è¯å’Œæœ¯è¯­

   +------------+---------------------------------------------------------+
   | **ç¼©å†™     | **æè¿°**                                                |
   | è¯/æœ¯è¯­**  |                                                         |
   +------------+---------------------------------------------------------+
   | SoAd       | Socket Adapter å¥—æ¥å­—é€‚é…æ¨¡å—                           |
   +------------+---------------------------------------------------------+
   | UdpNm      | UDP Network Management ä»¥å¤ªç½‘ç½‘ç»œç®¡ç†æ¨¡å—               |
   +------------+---------------------------------------------------------+
   | EthSM      | Ethernet State Manager ä»¥å¤ªç½‘çŠ¶æ€æ§åˆ¶æ¨¡å—               |
   +------------+---------------------------------------------------------+
   | Nm         | Generic Network Management Interface                    |
   |            | é€šç”¨ç½‘ç»œç®¡ç†æ¥å£æ¨¡å—                                    |
   +------------+---------------------------------------------------------+
   | ComM       | Communication Manager é€šä¿¡ç®¡ç†æ¨¡å—                      |
   +------------+---------------------------------------------------------+
   | RTE        | Runtime Enviroment è™šæ‹Ÿè¿è¡Œç¯å¢ƒ                         |
   +------------+---------------------------------------------------------+
   | SWC        | Software Component è½¯ä»¶ç»„ä»¶                             |
   +------------+---------------------------------------------------------+

å‚è€ƒæ–‡æ¡£
========

[1] å‚è€ƒæ‰‹å†Œ_EthIf.pdf

[2] å‚è€ƒæ‰‹å†Œ_EthSM.pdf

[3] å‚è€ƒæ‰‹å†Œ_TcpIp.pdf

[4] å‚è€ƒæ‰‹å†Œ_SoAd.pdf

[5] å‚è€ƒæ‰‹å†Œ_NmIf.pdf

[6] å‚è€ƒæ‰‹å†Œ_UdpNm.pdf

[7] å‚è€ƒæ‰‹å†Œ_ComM.pdf

åè®®æ ˆé›†æˆ
==========

æ–°å»ºORIENTAISå·¥ç¨‹
-----------------

#. å®‰è£…ORIENTAIS Configuratorè½¯ä»¶åï¼ŒåŒå‡»è½¯ä»¶å›¾æ ‡æ‰“å¼€è½¯ä»¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image1.png
   :width: 4.92126in
   :height: 3.46042in

   å›¾ 4â€‘1 æ–°å»ºå·¥ç¨‹-1

2. èœå•æ FileğŸ¡ªNewğŸ¡ªProjectï¼Œæ–°å»ºå·¥ç¨‹ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image2.png
   :width: 4.92126in
   :height: 3.45486in

   å›¾ 4â€‘2 æ–°å»ºå·¥ç¨‹-2

3. åœ¨å¼¹å‡ºçš„æ–°å»ºçª—å£ä¸­é€‰æ‹©Autosarä¸‹çš„ [BSW Project]ï¼Œé€‰æ‹©Nextã€‚

å›¾ 4â€‘3 æ–°å»ºå·¥ç¨‹-3

4. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥å·¥ç¨‹åï¼Œé€‰æ‹©Finishã€‚

å›¾ 4â€‘4 æ–°å»ºå·¥ç¨‹-4

5. åœ¨å¼¹å‡ºçš„çª—å£ä¸­é€‰æ‹©Yesã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image5.png
   :width: 4.33071in
   :height: 2.02362in

   å›¾ 4â€‘5 æ–°å»ºå·¥ç¨‹-5

6. é€‰æ‹©[Bsw_Builder]ï¼Œå³é”®å•å‡»ï¼Œé€‰æ‹©New ECU Configurationã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image6.png
   :width: 4.33071in
   :height: 1.5in

   å›¾ 4â€‘6 æ–°å»ºå·¥ç¨‹-6

7. åœ¨å¼¹å‡ºçš„çª—å£ä¸­è¾“å…¥ECUåï¼Œç„¶åé€‰æ‹©Nextã€‚

|image1|

å›¾ 4â€‘7 æ–°å»ºå·¥ç¨‹-7

8. åœ¨å¼¹å‡ºçš„çª—å£ä¸­å‹¾é€‰éœ€æ·»åŠ çš„æ¨¡å—ï¼Œç‚¹å‡»Finishã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image8.png
   :width: 2.97638in
   :height: 5.90551in

   å›¾ 4â€‘8 æ–°å»ºå·¥ç¨‹-8

é…ç½®æ–‡ä»¶ç”Ÿæˆ
------------

æ¨¡å—é…ç½®
~~~~~~~~

æ¨¡å—çš„å…·ä½“é…ç½®ï¼Œå–å†³äºå…·ä½“çš„é¡¹ç›®éœ€æ±‚ã€‚UdpNmå„æ¨¡å—é…ç½®é¡¹çš„è¯¦ç»†ä»‹ç»ï¼Œå‚è§ã€Šå‚è€ƒæ‰‹å†Œ_UdpNm.pdfã€‹ã€‚

é…ç½®ä»£ç ç”Ÿæˆ
~~~~~~~~~~~~

#. åœ¨ORIENTAIS
   Configuratorä¸»ç•Œé¢å·¦æ–¹ï¼Œé€‰æ‹©å¯¹åº”çš„åè®®æ ˆï¼Œæˆ–è€…é€‰æ‹©æ•´ä¸ªECUï¼Œå•å‡»å³é”®å¼¹å‡ºValidate
   Allå’ŒGenerate Allèœå•ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image9.png
   :width: 5.58333in
   :height: 4.86458in

   å›¾ 4â€‘9 é…ç½®ä»£ç çš„ç”Ÿæˆ-1

2. é€‰æ‹©Validate
   Allå¯¹æœ¬åè®®æ ˆå„é…ç½®é€‰é¡¹è¿›è¡Œæ ¡éªŒï¼Œæ²¡æœ‰é”™è¯¯æç¤ºä¿¡æ¯å³æ ¡éªŒé€šè¿‡ã€‚è‹¥æœ‰é”™è¯¯ä¿¡æ¯ï¼Œè¯·æŒ‰ç…§é”™è¯¯æç¤ºä¿®æ”¹ã€‚

3. é€‰æ‹©Generate
   Allï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶ã€‚å³ä¸‹è§’çš„Consoleçª—å£è¾“å‡ºç”Ÿæˆçš„é…ç½®æ–‡ä»¶ä¿¡æ¯ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image10.png
   :width: 5.77153in
   :height: 2.20694in

   å›¾ 4â€‘10 é…ç½®ä»£ç çš„ç”Ÿæˆ-2

4. å°†ORIENTAIS Configuratoråˆ‡æ¢åˆ°Resourceæ¨¡å¼ï¼Œå³å¯æŸ¥çœ‹ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image11.png
   :width: 5.77153in
   :height: 4.17986in

   å›¾ 4â€‘11 é…ç½®ä»£ç çš„ç”Ÿæˆ-3

åŠŸèƒ½é›†æˆ
--------

ä»£ç é›†æˆ
~~~~~~~~

åè®®æ ˆä»£ç åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šé¡¹ç›®æä¾›çš„åè®®æ ˆæºç å’ŒORIENTAIS
Configuratoré…ç½®ç”Ÿæˆä»£ç ã€‚

ç”¨æˆ·é¡»å°†åè®®æ ˆæºç å’Œç« èŠ‚4.2.2ç”Ÿæˆçš„æºä»£ç æ·»åŠ åˆ°é›†æˆå¼€å‘å·¥å…·çš„å¯¹åº”æ–‡ä»¶å¤¹ã€‚åè®®æ ˆé›†æˆçš„æ–‡ä»¶ç»“æ„ï¼Œè§ç« èŠ‚5.3ã€‚

**æ³¨æ„ï¼šåè®®æ ˆé›†æˆä¹‹å‰ï¼Œç”¨æˆ·é¡»ç¡®ä¿å·²ç»æœ‰åŸºç¡€å·¥ç¨‹ï¼Œä¸”æœ¬åè®®æ ˆç›¸å…³çš„å…¶ä»–åè®®æ ˆèƒ½æ­£å¸¸å·¥ä½œã€‚**

é›†æˆæ³¨æ„äº‹é¡¹
~~~~~~~~~~~~

å¯¹äºé›†æˆè¿‡ç¨‹ä¸­ï¼Œåè®®æ ˆç‰¹æ®Šè¦æ±‚å’Œç”¨æˆ·ç»å¸¸å‡ºç°çš„é—®é¢˜ï¼Œå½’ç±»æ€»ç»“å½¢æˆä¸‹è¡¨4-1ã€‚ç”¨æˆ·éœ€é€ä¸€æ’æŸ¥è¡¨ä¸­çš„çº¦æŸé¡¹ï¼Œä»¥é¿å…é›†æˆé—®é¢˜å‡ºç°ã€‚

è¡¨4-1 UDPNMé›†æˆçº¦æŸæ¸…å•

+-----+---------+-----------------------------------------------------+
| *   | *       | **çº¦æŸé™åˆ¶**                                        |
| *ç¼– | *ç±»åˆ«** |                                                     |
| å·  |         |                                                     |
| **  |         |                                                     |
+-----+---------+-----------------------------------------------------+
| **  | å †æ ˆ    | ç”¨æˆ·éœ€ç¡®ä¿ä¸ºä»»åŠ¡å †æ ˆå’Œä¸­æ–­å †æ ˆåˆ†é…è¶³å¤Ÿçš„å †æ ˆç©ºé—´ã€‚  |
| 1** |         |                                                     |
+-----+---------+-----------------------------------------------------+
| **  | å¤´æ–‡ä»¶  | -  æ·»åŠ åè®®                                         |
| 2** |         | æ ˆä»£ç ä¹‹åï¼Œç”¨æˆ·éœ€æ›´æ–°é›†æˆå¼€å‘å·¥å…·ä¸­çš„å¤´æ–‡ä»¶è·¯å¾„ã€‚  |
|     |         |                                                     |
|     |         | -  è°ƒç”¨åè®®æ ˆAPIçš„æºæ–‡ä»¶ï¼Œéœ€è¦åŒ…å«åè®®æ ˆçš„å¤´æ–‡ä»¶ã€‚  |
+-----+---------+-----------------------------------------------------+
| **  | åˆå§‹åŒ–  | UdpNmè¯Šæ–­æ ˆ                                         |
| 3** |         | çš„åˆå§‹åŒ–é¡ºåºä¸ºï¼šEthIf_Initã€TcpIp_Initã€SoAd_Initã€ |
|     |         | EthSM_Initã€UdpNm_Initã€ Nm_Initå’ŒComM_Initã€‚       |
+-----+---------+-----------------------------------------------------+
| **  | å‘¨      | UdpNm_MainFunctionï¼ŒEthSM_MainFu                    |
| 4** | æœŸå‡½æ•°  | nctionå’ŒComM_MainFunctionéœ€è¦è¢«å‘¨æœŸæ€§ä»»åŠ¡å‡½æ•°è°ƒç”¨ã€‚ |
|     |         |                                                     |
|     |         | EthSMçš„è°ƒåº¦å‘¨æœŸå¿…é¡»å¤§äºComMçš„è°ƒåº¦å‘¨æœŸ               |
+-----+---------+-----------------------------------------------------+

é›†æˆç¤ºä¾‹
========

é›†æˆç›®æ ‡
--------

æœ¬æ‰‹å†Œä¼šä»¥ä»¥ä¸‹å‚æ•°ä½œä¸ºç¤ºä¾‹ï¼Œè¿›è¡Œé›†æˆæ¼”ç¤ºã€‚

è¡¨5-1 UDPNMé›†æˆå‚æ•°è¡¨

+-------------------------+--------------------------------------------+
| **å‚æ•°**                | **å€¼**                                     |
+-------------------------+--------------------------------------------+
| å¿«å‘å‘¨æœŸ                | 50ms                                       |
+-------------------------+--------------------------------------------+
| å¿«å‘æ¬¡æ•°                | 10                                         |
+-------------------------+--------------------------------------------+
| æ­£å¸¸å‘é€å‘¨æœŸ            | 500ms                                      |
+-------------------------+--------------------------------------------+
| èŠ‚ç‚¹Id                  | 50                                         |
+-------------------------+--------------------------------------------+
| RepeatStateæ—¶é—´         | 2s                                         |
+-------------------------+--------------------------------------------+
| Nm-Timeoutæ—¶é—´          | 5s                                         |
+-------------------------+--------------------------------------------+
| WaitBusSleepæ—¶é—´        | 1.5s                                       |
+-------------------------+--------------------------------------------+
| Socketä¿¡æ¯              | æœ¬åœ°ï¼š172.31.30.78/ UDP/30500              |
|                         |                                            |
|                         | è¿œç«¯ï¼š239.192.255.250/UDP/30500            |
+-------------------------+--------------------------------------------+

.. _æ¨¡å—é…ç½®-1:

æ¨¡å—é…ç½®
--------

EcuCæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. åŒå‡»EcuCæ¨¡å—ï¼Œæ‰“å¼€EcuCæ¨¡å—é…ç½®ç•Œé¢ã€‚

#. åœ¨EcucConfigSetsæ ç›®ä¸Šå³é”®ï¼Œé€‰æ‹©EcucConfigSetã€‚å†åœ¨EcucConfigSetä¸Šå³é”®ï¼Œé€‰æ‹©NewğŸ¡ª
   EcucConfigSetã€‚å†åœ¨EcucPduCollectionsä¸Šå³é”®ï¼Œé€‰æ‹©New
   EcucPduCollectionã€‚

   a) PduIdTypeEnum
      é€‰æ‹©UINT8ï¼ˆè¯¥å‚æ•°è¡¨ç¤ºPDUçš„æ ¼å¼ã€‚å› ä¸ºç¤ºä¾‹åªæœ‰ä¸€å¯¹æ”¶å‘æŠ¥æ–‡ï¼ŒPDUæ•°ä¸ä¼šè¶…è¿‡255ï¼ŒUINT8ç±»å‹çš„é•¿åº¦å°±å¤Ÿå­˜å‚¨äº†ï¼‰ã€‚

   b) PduLengthTypeEnum
      é€‰æ‹©UINT8ï¼ˆè¯¥å‚æ•°è¡¨ç¤ºæ•°æ®é•¿åº¦ï¼Œç¤ºä¾‹éœ€è¦é…ç½®çš„æŠ¥æ–‡é•¿åº¦éƒ½æ˜¯8ï¼Œä¸ä¼šè¶…è¿‡255ï¼Œæ‰€ä»¥é€‰æ‹©UINT8å³å¯ï¼‰ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image12.png
   :width: 5.52362in
   :height: 1.5748in

   å›¾ 5â€‘1 é…ç½®EcucPduCollection

3. åœ¨EcucPduCollectionä¸Šå³é”®ï¼Œé€‰æ‹©Pduï¼Œä¼šç”Ÿæˆä¸€ä¸ªPduçš„é…ç½®ç•Œé¢ã€‚

   a) å»ºè®®ä¸è¦ä½¿ç”¨é»˜è®¤ç”Ÿæˆçš„Pduåå­—ï¼ˆå¦‚ï¼šPdu_0ï¼‰ï¼Œå°†Pduåå­—æ”¹æˆæœ‰æ„ä¹‰çš„åå­—å¯¹åç»­çš„é…ç½®è¿‡ç¨‹å°†ä¼šæœ‰å¾ˆå¤§å¸®åŠ©ã€‚

   b) è¿™é‡ŒæŒ‰ç…§å‘é€å’Œæ¥æ”¶ï¼Œå¯ä»¥å°†Pduåå­—æ”¹ä¸ºæŠ¥æ–‡çš„åå­—ã€‚PduLengthï¼šPdué•¿åº¦ï¼Œæ ¹æ®å®é™…ä½¿ç”¨å¸§çš„é•¿åº¦è®¾ç½®ã€‚

   c) ç”±äºUdpNmçš„æ”¶å‘æŠ¥æ–‡ä¸éœ€è¦PduRæ¥è·¯ç”±ï¼Œå› æ­¤æ¯ä¸ªæ–¹å‘ï¼ˆå‘é€/æ¥æ”¶ï¼‰åªéœ€è¦é…ç½®ä¸€ä¸ªPduã€‚å¯¹äºéœ€è¦PduRè·¯ç”±çš„æŠ¥æ–‡ï¼Œæ¯ä¸ªæ–¹å‘éœ€è¦åˆ›å»º2ä¸ªPduã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image13.png
   :width: 5.77153in
   :height: 1.80069in

   å›¾ 5â€‘2 é…ç½®Pdu-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image14.png
   :width: 5.77153in
   :height: 1.88056in

   å›¾ 5â€‘3 é…ç½®Pdu-2

4. ECUCæ¨¡å—åˆ°æ­¤é…ç½®ç»“æŸã€‚å¯ä»¥åœ¨æ¨¡å—ä¸Šå³é”®ï¼Œç„¶åé€‰æ‹©æ ¡éªŒï¼ŒæŸ¥çœ‹æ˜¯å¦é…ç½®æœ‰é”™è¯¯ã€‚

5. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

SoAdæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. é…ç½®SoAdGeneralï¼Œä¸€èˆ¬é…ç½®è°ƒåº¦å‘¨æœŸï¼ŒSocketä¸ªæ•°å’ŒSocketGroupçš„ä¸ªæ•°ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image15.png
   :width: 5.51181in
   :height: 3.01575in

   å›¾ 5â€‘4 é…ç½®SoAdGeneral

2. é…ç½®SoAdBswModulesï¼Œè‹¥æ•°æ®æµéœ€è¦é€šè¿‡SoAdæ¨¡å—ï¼Œåˆ™éœ€è¦é…ç½®ã€‚æœ¬ä¾‹ä¸­åªæœ‰UdpNmã€‚æ‰€ä»¥åªéœ€è¦é…ç½®UdpNmã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image16.png
   :width: 5.77153in
   :height: 1.74306in

   å›¾ 5â€‘5 é…ç½®SoAdBswModules

3. é…ç½®SoAdConfigã€‚

   a) é…ç½®SoAdSocketGroupã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image17.png
   :width: 5.30261in
   :height: 1.80289in

   å›¾ 5â€‘6 é…ç½®SoAdSocketGroup

b) é…ç½®SoAdSocketConnectionGroupã€‚UdpNmé‡‡ç”¨å¤šæ’­æ”¶å‘ï¼Œéœ€è¦é…ç½®2ä¸ªSocketã€‚åˆ†åˆ«ç”¨äºå‘é€å’Œæ¥æ”¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image18.png
   :width: 5.90551in
   :height: 3.01575in

   å›¾ 5â€‘7 é…ç½®SoAdSocketConnectionGroup-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image19.png
   :width: 5.90551in
   :height: 2.12992in

   å›¾ 5â€‘8 é…ç½®SoAdSocketConnectionGroup-2

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image20.png
   :width: 5.90551in
   :height: 2.30709in

   å›¾ 5â€‘9 é…ç½®SoAdSocketConnectionGroup-3

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image21.png
   :width: 5.90551in
   :height: 2.9685in

   å›¾ 5â€‘10 é…ç½®SoAdSocketConnectionGroup-4

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image22.png
   :width: 5.90551in
   :height: 2.54724in

   å›¾ 5â€‘11 SoAdSocketConnectionGroup-5

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image23.png
   :width: 5.90551in
   :height: 2.53543in

   å›¾ 5â€‘12 é…ç½®SoAdSocketConnectionGroup-6

c) é…ç½®SoAdRouteï¼Œå³æŠ¥æ–‡å‘é€ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image24.png
   :width: 5.90551in
   :height: 2.58268in

   å›¾ 5â€‘13 é…ç½®SoAdRoute-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image25.png
   :width: 5.90551in
   :height: 2.49606in

   å›¾ 5â€‘14 é…ç½®SoAdRoute-2

d) é…ç½®SoAdSocketRouteï¼Œå³æŠ¥æ–‡æ¥æ”¶ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image26.png
   :width: 5.90551in
   :height: 2.38189in

   å›¾ 5â€‘15 é…ç½®SoAdSocketRoute-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image27.png
   :width: 5.11811in
   :height: 2.31102in

   å›¾ 5â€‘16 é…ç½®SoAdSocketRoute-2

4. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

ComMæ¨¡å—é…ç½®
~~~~~~~~~~~~

#. ComMGeneralé¡µé¢ä¸€èˆ¬ä¸éœ€è¦é…ç½®ï¼Œä¿æŒé»˜è®¤å³å¯ã€‚

#. é…ç½®ComMConfigSeté¡µé¢ã€‚

   a) é¦–å…ˆé…ç½®ä¸€ä¸ªComMUserï¼Œé»˜è®¤å°±åˆ›å»ºäº†ä¸€ä¸ªã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image28.png
   :width: 5.11811in
   :height: 1.5315in

   å›¾ 5â€‘17 é…ç½®ComMUser

b) é…ç½®ComMChannelï¼Œé»˜è®¤å°±åˆ›å»ºäº†ä¸€ä¸ªã€‚

c) é…ç½®ComMBusTypeï¼Œé€‰æ‹©æœ¬é€šé“çš„æ€»çº¿ç±»å‹ã€‚è¿˜éœ€è¦é…ç½®ComMMainFunctionPeriodï¼Œè¡¨ç¤ºæœ¬é€šé“çš„è°ƒåº¦å‘¨æœŸã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image29.png
   :width: 5.11811in
   :height: 2.01181in

   å›¾ 5â€‘18 é…ç½®ComMChannels

d) é…ç½®ComMNmVariantï¼Œè¡¨ç¤ºæœ¬é€šé“çš„ç±»å‹ã€‚FULLè¡¨ç¤ºé€šé“ç”±ç½‘ç»œç®¡ç†æ¥ç®¡ç†ã€‚LIGHTè¡¨ç¤ºæœ¬é€šé“æ²¡æœ‰ç½‘ç»œç®¡ç†ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image30.png
   :width: 5.07874in
   :height: 1.80709in

   å›¾ 5â€‘19 é…ç½®ComMNmVariant

e) æ¯ä¸ªChanneléœ€è¦å…³è”ä¸€ä¸ªUserï¼Œå¯¹äºå¤§å¤šæ•°å¸¸è§ï¼Œä¸€ä¸ªUserå°±ç­‰äºä¸€ä¸ªChannelã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image31.png
   :width: 5.07874in
   :height: 1.79528in

   å›¾ 5â€‘20 é…ç½®ComMUserPerChannel

3. ComMé…ç½®å®Œæˆï¼Œæ ¡éªŒã€‚

EthSMæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. é…ç½®EthSMGeneralã€‚è¿™é‡Œåªéœ€è¦é…ç½®ä¸€ä¸ªè°ƒåº¦å‘¨æœŸï¼Œå°½å¯èƒ½å¿«ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image32.png
   :width: 4.96063in
   :height: 2.47244in

   å›¾ 5â€‘21 é…ç½®EthSMGeneral

2. é…ç½®EthSMNetworkã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image33.png
   :width: 5.51181in
   :height: 1.80315in

   å›¾ 5â€‘22 é…ç½®EthSMNetwork

3. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

Nmæ¨¡å—é…ç½®
~~~~~~~~~~

#. é…ç½®NmChannelConfigï¼Œéœ€è¦é…ç½®2ä¸ªåœ°æ–¹ã€‚ç¬¬ä¸€ä¸ªæ˜¯NmChannelConfigï¼Œå…³è”åˆ°ComMçš„channelï¼Œç¬¬äºŒä¸ªéœ€è¦åˆ›å»ºNmStandardBusNmConfigï¼Œé€‰æ‹©ç½‘ç»œç®¡ç†ç±»å‹ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image34.png
   :width: 5.51181in
   :height: 1.86614in

   å›¾ 5â€‘23 é…ç½®NmChannelConfig-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image35.png
   :width: 5.51181in
   :height: 1.94882in

   å›¾ 5â€‘24 é…ç½®NmChannelConfig-2

2. é…ç½®NmGlobalConfigï¼Œéœ€è¦é…ç½®NmGlobalConstantså’ŒNmGlobalFeaturesã€‚é…ç½®çš„é‡ç‚¹åœ¨NmGlobalFeaturesã€‚è¿™é‡Œä¸»è¦æ˜¯å…¨å±€é€‰æ‹©ç½‘ç»œç®¡ç†çš„åŠŸèƒ½ã€‚éƒ¨åˆ†åŠŸèƒ½è¿˜éœ€è¦åœ¨OsekNmä¸­é…ç½®ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image36.png
   :width: 5.51181in
   :height: 2.69291in

   å›¾ 5â€‘25 é…ç½®NmGlobalConfig-1

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image37.png
   :width: 5.77153in
   :height: 2.43125in

   å›¾ 5â€‘26 é…ç½®NmGlobalConfig-2

3. Nmé…ç½®å®Œæˆï¼Œæ ¡éªŒã€‚

UdpNmæ¨¡å—é…ç½®
~~~~~~~~~~~~~

#. é…ç½®UdpNmGlobalConfigã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image38.png
   :width: 5.51181in
   :height: 2.98031in

   å›¾ 5â€‘27 é…ç½®UdpNmGlobalConfig

2. é…ç½®UdpNmChannelConfigï¼Œè¿™é‡Œä¸»è¦é…ç½®æ—¶é—´å‚æ•°ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image39.png
   :width: 5.51181in
   :height: 3.77953in

   å›¾ 5â€‘28 é…ç½®UdpNmChannleConfig

3. é…ç½®æŠ¥æ–‡çš„æ”¶å‘ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image40.png
   :width: 5.77153in
   :height: 1.91944in

   å›¾ 5â€‘29 é…ç½®UdpNmRxPdu

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image41.png
   :width: 5.77153in
   :height: 1.99653in

   å›¾ 5â€‘30 é…ç½®UdpNmTxPdu

4. æ ¡éªŒåæç¤ºçª—å£æ²¡æœ‰é”™è¯¯ä¿¡æ¯ï¼Œå³æ ¡éªŒé€šè¿‡ã€‚

æºç é›†æˆ
--------

é¡¹ç›®äº¤ä»˜ç»™ç”¨æˆ·çš„å·¥ç¨‹ç»“æ„å¦‚ä¸‹ï¼š

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image42.png
   :width: 2.38987in
   :height: 4.73824in

   å›¾ 5â€‘31 å·¥ç¨‹ç»“æ„ç›®å½•

-  BSW_Cfgç›®å½•ï¼Œè¿™ä¸ªç›®å½•ç”¨æ¥å­˜æ”¾é…ç½®å·¥å…·ç”Ÿæˆçš„é…ç½®æ–‡ä»¶ï¼Œç½‘ç»œç®¡ç†æœ‰å…³çš„é…ç½®æ–‡ä»¶æ”¾åœ¨NMå’ŒUdpNmæ–‡ä»¶å¤¹ä¸­ã€‚

-  srcç›®å½•ï¼Œå­˜æ”¾æ¨¡å—ç›¸å…³çš„æºä»£ç ã€‚å¯ä»¥çœ‹åˆ°Sourceç›®å½•ä¸‹å„ä¸ªæ–‡ä»¶å¤¹ä¸‹æ˜¯å„ä¸ªæ¨¡å—çš„æºä»£ç ã€‚

ç½‘ç»œç®¡ç†æºä»£ç é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. å°†5.2ç« èŠ‚ä¸­ORIENTAIS
   Configuratorç”Ÿæˆçš„é…ç½®æ–‡ä»¶å¤åˆ¶åˆ°Configæ–‡ä»¶å¤¹ä¸‹çš„å„ä¸ªæ¨¡å—çš„å¯¹åº”æ–‡ä»¶å¤¹ä¸­ã€ä¾‹å¦‚ï¼šConfig\\inc\\NMã€‘ã€‚

#. å°†é¡¹ç›®æä¾›çš„åè®®æ ˆæºä»£ç æ–‡ä»¶å¤åˆ¶åˆ°Sourceæ–‡ä»¶å¤¹ä¸‹çš„å¯¹åº”æ¨¡å—çš„æ–‡ä»¶å¤¹ä¸­ã€ä¾‹å¦‚ï¼šSourceS\\NMã€‘ã€‚

#. å°†æ‰€éœ€çš„å¤´æ–‡ä»¶åŒ…å«è¿›å·¥ç¨‹è®¾ç½®ä¸­ï¼Œå¦‚ä¸‹æ­¥éª¤ï¼š

   a) æ·»åŠ å¤´æ–‡ä»¶è·¯å¾„ã€‚

   b) æ·»åŠ æ‰€éœ€çš„å¤´æ–‡ä»¶ã€‚

   c) æ·»åŠ è°ƒåº¦æ–‡ä»¶ï¼Œç‚¹å‡»åº”ç”¨ä¿å­˜ã€‚

   d) ç¼–è¯‘å·¥ç¨‹ã€‚

è°ƒåº¦é›†æˆ
--------

è°ƒåº¦é›†æˆæ­¥éª¤å¦‚ä¸‹ï¼š

#. åè®®æ ˆè°ƒåº¦é›†æˆã€‚

#. ç¼–è¯‘é“¾æ¥ä»£ç ï¼Œå°†ç”Ÿæˆçš„elfæ–‡ä»¶çƒ§å†™è¿›èŠ¯ç‰‡ã€‚

UdpNmæœ‰å…³çš„ä»£ç ï¼Œåœ¨ä¸‹æ–¹çš„main.cæ–‡ä»¶ä¸­ç»™å‡ºé‡ç‚¹æ ‡æ³¨ã€‚

**æ³¨æ„ :
æœ¬ç¤ºä¾‹ä¸­ï¼ŒUdpNmç½‘ç»œç®¡ç†åˆå§‹åŒ–çš„ä»£ç å’Œå¯åŠ¨é€šä¿¡çš„ä»£ç ç½®äºmain.cæ–‡ä»¶ï¼Œå¹¶ä¸ä»£è¡¨å…¶ä»–é¡¹ç›®åŒæ ·é€‚ç”¨äºå°†å…¶ç½®äºmain.cæ–‡ä»¶ä¸­ã€‚**

*#include "Timer.h"*

*#include "Led.h"*

*#include "Mcal.h"*

*#include "UserTimer.h"*

*#include "EthIf.h"*

*#include "TcpIp.h"*

*#include "SoAd.h"*

*#include "EthSM.h"*

UdpNmåè®®æ ˆç›¸å…³æ¨¡å—å¤´æ–‡ä»¶

*#include "Nm.h"*

*#include "UdpNm.h"*

*#include "ComM.h"*

*#include "ComM_Internal.h"*

Com_IpduGroupVector g_ComIpduGroupVector;

**int** **main**\ (**void**)

{

McalUser_Init();

åˆå§‹åŒ–EthIfã€EthSMã€TcpIpã€SoAdã€Nmã€UdpNmã€ComMæ¨¡å—

Led_Init();

EthIf_Init(&EthIf_ConfigData);

EthSM_Init();

TcpIp_Init(&TcpIp_Config);

SoAd_Init(&SoAd_Config);

Nm_Init(&Nm_Config);

æ‰“å¼€é€šä¿¡

UdpNm_Init(&UdpNm_Config);

ComM_Init(&ComM_Config);

ComM_Channel[ComMChannel_Eth].CommunicationAllowed = TRUE;

ComM_RequestComMode(ComMUser_Eth, COMM_FULL_COMMUNICATION);

StartOS(OSDEFAULTAPPMODE);

**while** (1);

}

/\* OsTask_c0_1ms: Core0(CPU0), Type = BASIC, Priority = 8*/

**TASK**\ (OsTask_c0_1ms)

{

EthSMæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°

/\* please insert your code here ... \*/

EthSM_MainFunction();

**if** (E_OK != TerminateTask())

{

**while** (1)

{

/\* dead loop \*/

}

}

}

/\* OsTask_c0_5ms: Core0(CPU0), Type = BASIC, Priority = 6*/

**TASK**\ (OsTask_c0_5ms)

{

/\* please insert your code here ... \*/

ComMã€EthIfã€UdpNmæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°

ComM_MainFunction(ComMUser_Eth);

EthIf_MainFunctionState();

UdpNm_MainFunction(0);

**if** (E_OK != TerminateTask())

{

**while** (1)

{

/\* dead loop \*/

}

}

}

/\* OsTask_c0_5ms: Core0(CPU0), Type = BASIC, Priority = 6*/

**TASK**\ (OsTask_c0_20ms)

SoAdã€TcpIpæ¨¡å—å‘¨æœŸå¤„ç†å‡½æ•°

{

/\* please insert your code here ... \*/

SoAd_MainFunction();

TcpIp_MainFunction();

**if** (E_OK != TerminateTask())

{

**while** (1)

{

/\* dead loop \*/

}

}

}

éªŒè¯ç»“æœ
--------

æ ¹æ®é›†æˆç›®æ ‡ï¼Œä½¿ç”¨Wiresharkå·¥å…·æŸ¥çœ‹æŠ¥æ–‡å‘é€æ–¹å¼æ˜¯å¦æ­£ç¡®ã€‚å‰10ä¸ªæŠ¥æ–‡å‘é€é—´éš”50msï¼Œåé¢æŠ¥æ–‡çš„é—´éš”æ˜¯500msï¼Œç¬¦åˆé›†æˆç›®æ ‡ã€‚

.. figure:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image43.png
   :width: 5.43083in
   :height: 5.88367in

   å›¾ 5â€‘32 UdpNmæŠ¥æ–‡å‘é€ç¤ºä¾‹

.. |image1| image:: ../../_static/é›†æˆæ‰‹å†Œ/UdpNm/image7.png
   :width: 4.33071in
   :height: 4.12598in
