

<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CanSM产品参考手册 &mdash; EasyXMen_docs 1.0.0 documentation</title>
      <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../../_static/css/theme.css?v=e59714d7" />

  
      <script src="../../_static/jquery.js?v=5d32c60e"></script>
      <script src="../../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
      <script src="../../_static/documentation_options.js?v=8d563738"></script>
      <script src="../../_static/doctools.js?v=9bcbadda"></script>
      <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="CanTp产品参考手册" href="CanTp.html" />
    <link rel="prev" title="CanNm产品参考手册" href="CanNm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            EasyXMen_docs
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">参考手册:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="BswM.html">BswM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CanIf.html">CanIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CanNm.html">CanNm产品参考手册</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">CanSM产品参考手册</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id1">简介</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">参考资料</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id3">功能描述</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id4">状态管理功能</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#id5">状态管理功能介绍</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id6">状态管理功能序列图</a></li>
<li class="toctree-l4"><a class="reference internal" href="#id7">状态管理功能主状态机</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#bus-off">Bus-off恢复功能</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id8">源文件描述</a></li>
<li class="toctree-l2"><a class="reference internal" href="#api">API接口</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id9">类型定义</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cansm-statetype">CanSM_StateType类型定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-configtype">CanSM_ConfigType类型定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-bswmcurrentstatetype">CanSM_BswMCurrentStateType类型定义</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id10">输入函数描述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id11">静态接口函数定义</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cansm-init">CanSM_Init函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-deinit">CanSM_DeInit函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-requestcommode">CanSM_RequestComMode函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-getcurrentcommode">CanSM_GetCurrentComMode函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-startwakeupsource">CanSM_StartWakeupSource函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-stopwakeupsource">CanSM_StopWakeupSource函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-getversioninfo">CanSM_GetVersionInfo函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-setbaudrate">CanSM_SetBaudrate函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-setecupassive">CanSM_SetEcuPassive函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-controllerbusoff">CanSM_ControllerBusOff函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-controllermodeindication">CanSM_ControllerModeIndication函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-transceivermodeindication">CanSM_TransceiverModeIndication函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-txtimeoutexception">CanSM_TxTimeoutException函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-cleartrcvwufflagindication">CanSM_ClearTrcvWufFlagIndication函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-checktransceiverwakeflagindication">CanSM_CheckTransceiverWakeFlagIndication函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-confirmpnavailability">CanSM_ConfirmPnAvailability函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-currenticomconfiguration">CanSM_CurrentIcomConfiguration函数定义</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansm-mainfunction">CanSM_MainFunction函数定义</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id12">可配置函数定义</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#user-getbusoffdelay">&lt;User_GetBusOffDelay&gt;函数定义</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id13">配置</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#cansmgeneral">CanSMGeneral</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cansmconfiguration">CanSMConfiguration</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#cansmmanagernetwork">CanSMManagerNetwork</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansmcontroller">CanSMController</a></li>
<li class="toctree-l4"><a class="reference internal" href="#cansmdemeventparameterrefs">CanSMDemEventParameterRefs</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="CanTp.html">CanTp产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CanTrcv.html">CanTrcv产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CanTSyn.html">CanTSyn产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Com.html">Com产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="ComM.html">ComM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="ComXf.html">ComXf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CRC.html">CRC产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CryIf.html">CryIf 产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Crypto.html">Crypto驱动产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="CSM.html">CSM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="DCM.html">DCM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dem.html">Dem产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Det.html">DET产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Dlt.html">DLT产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="DoIP.html">DoIP产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="E2EL.html">E2EL产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="E2EXf.html">E2EXf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Ea.html">EA产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EcuC.html">EcuC产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EcuM.html">EcuM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EthIf.html">EthIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EthSM.html">EthSM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EthSwt.html">EthSwt产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EthTrcv.html">EthTrcv产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="EthTSyn.html">EthTSyn产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Fee.html">Fee产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="FiM.html">FiM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="FOTA_handler.html">FOTA_handler产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="IoHwAb.html">IoHwAb产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="IpduM.html">IpduM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="KeyM.html">KeyM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="LdCom.html">LdCom产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="LinIf.html">LinIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="LinSM.html">LinSM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="MemIf.html">MemIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="NmIf.html">NmIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="NvM.html">NvM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="OS.html">OS模块参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="PduR.html">PduR产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Sd.html">Sd产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="SecOC.html">SecOC产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="SoAd.html">SoAd产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="SomeIpTp.html">SomeIpTp产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="SomeIpXf.html">SomeIpXf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="StbM.html">StbM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="TcpIp.html">TcpIp产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="Tm.html">Tm产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="UdpNm.html">UdpNm产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="WdgIf.html">WdgIf产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="WdgM.html">WdgM产品参考手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="XCP.html">XCP产品参考手册</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">集成手册:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/BswM%26EcuM.html">BswM&amp;EcuM_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/CAN.html">CAN_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/CANNM.html">CANNM_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/CanTSyn.html">CanTSyn_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/DoIP.html">DoIP_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/E2E.html">E2E_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/Eth.html">Eth_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/EthTSyn.html">EthTSyn_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/FlashTest.html">FlashTest_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/LinMaster.html">LinMaster_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/LinSlave.html">LINSlave_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/NVM.html">NvM_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/OBD.html">OBD_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/OS.html">OS_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/OS_%E6%B7%BB%E5%8A%A0%E8%AE%A2%E9%98%85.html">OS添加订阅</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/RamTest.html">RamTest_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/SecOC.html">SecOC_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/SOMEIP.html">SOMEIP_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/UdpNm.html">UdpNm_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/UDSonCAN.html">UDSOnCan_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/UDSonLIN.html">UDSonLIN_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/WDG.html">WDG_集成手册</a></li>
<li class="toctree-l1"><a class="reference internal" href="../%E9%9B%86%E6%88%90%E6%89%8B%E5%86%8C/XCP.html">XCP_集成手册</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">工程说明:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../%E5%B7%A5%E7%A8%8B%E8%AF%B4%E6%98%8E/%E5%B0%8F%E6%BB%A1S32K148%E7%A4%BA%E4%BE%8B%E5%B7%A5%E7%A8%8B%E8%AF%B4%E6%98%8E.html">小满S32K148示例工程说明</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">EasyXMen_docs</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">CanSM产品参考手册</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/sub/参考手册/CanSM.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="cansm">
<h1>CanSM产品参考手册<a class="headerlink" href="#cansm" title="Link to this heading"></a></h1>
<p><strong>缩写词注解</strong></p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>缩写词</strong></p></td>
<td><p><strong>英文全称</strong></p></td>
<td><p><strong>中文解释</strong></p></td>
</tr>
<tr class="row-even"><td><p>CanSM</p></td>
<td><p>CAN State Manager</p></td>
<td><p>CAN状态管理</p></td>
</tr>
<tr class="row-odd"><td><p>BswM</p></td>
<td><p>BSW Mode Manager</p></td>
<td><p>基础软件模式管理</p></td>
</tr>
<tr class="row-even"><td><p>EcuM</p></td>
<td><p>Ecu State Manager</p></td>
<td><p>Ecu状态管理</p></td>
</tr>
<tr class="row-odd"><td><p>CanIf</p></td>
<td><p>Can Interface</p></td>
<td><p>CAN接口模块</p></td>
</tr>
<tr class="row-even"><td><p>DEM</p></td>
<td><p>Diagnostic Event Manager</p></td>
<td><p>诊断事件处理</p></td>
</tr>
<tr class="row-odd"><td><p>DET</p></td>
<td><p>Default Error Tracer</p></td>
<td><p>默认错误检测</p></td>
</tr>
<tr class="row-even"><td><p>EcuM</p></td>
<td><p>ECU State Manager</p></td>
<td><p>ECU状态管理模块</p></td>
</tr>
<tr class="row-odd"><td><p>PN</p></td>
<td><p>Partial Network</p></td>
<td><p>部分网络</p></td>
</tr>
<tr class="row-even"><td><p>ComM</p></td>
<td><p>Com Manager</p></td>
<td><p>通讯管理模块</p></td>
</tr>
</tbody>
</table>
<section id="id1">
<h2>简介<a class="headerlink" href="#id1" title="Link to this heading"></a></h2>
<p>CanSM模块负责CAN网络的控制流抽象，它使用CanIf模块的API，根据ComM模块的模式请求更改已配置的CAN网络的通信模式。CAN控制器模式和CAN收发器模式的任何更改将由CanIf模块通知CanSM模块。根据CanIf通知和CanSM状态机的状态，CanSM模块将通知ComM和BswM。</p>
<p><a class="reference internal" href="../../_images/image117.png"><img alt="image1" src="../../_images/image117.png" style="width: 5.76736in; height: 3.43056in;" /></a></p>
<p>图1-1 CanSM在AUTOSAR中的位置</p>
<section id="id2">
<h3>参考资料<a class="headerlink" href="#id2" title="Link to this heading"></a></h3>
<p>[1] AUTOSAR_SWS_ CANStateManager.pdf，R19-11</p>
<p>[2] AUTOSAR_SWS_COMManager.pdf，R19-11</p>
<p>[3] AUTOSAR_SWS_NetworkManagementInterface.pdf，R19-11</p>
<p>[4] AUTOSAR_SWS_BSWModeManager.pdf，R19-11</p>
<p>[5] AUTOSAR_SWS_ CANInterface.pdf，R19-11</p>
<p>[6] AUTOSAR_SWS_CANNetworkManagement.pdf，R19-11</p>
</section>
</section>
<section id="id3">
<h2>功能描述<a class="headerlink" href="#id3" title="Link to this heading"></a></h2>
<section id="id4">
<h3>状态管理功能<a class="headerlink" href="#id4" title="Link to this heading"></a></h3>
<section id="id5">
<h4>状态管理功能介绍<a class="headerlink" href="#id5" title="Link to this heading"></a></h4>
<p>CAN总线的状态管理器CanSM，负责实现CAN网络控制流程的抽象。CanSM提供API以便ComM来请求CAN网络进行通信模式的切换。ComM请求切换网络模式的时候，会传递一个参数（用来标识是哪个网络）。对应网络收到这个请求之后，会执行对应的通信模式切换。在网络通信模式切换的过程中，会执行对应的CAN外设控制和PDU处理。</p>
<p>不同网络请求对应的控制器和收发器状态如下：</p>
<p><a class="reference internal" href="../../_images/image214.png"><img alt="image2" src="../../_images/image214.png" style="width: 5.76736in; height: 2.55625in;" /></a></p>
<p>图2-1 不同网络请求对应的控制器和收发器状态</p>
<p>由于延迟等原因，网络的通信模式可能会和ComM请求的不一致。这就需要CanSM通过以下两种方式来提供接口向ComM反馈当前的通信模式：</p>
<p>1)
CanSM自己提供API，ComM可以通过这个API调用来得到CAN网络当前的通信模式。</p>
<ol class="arabic simple" start="2">
<li><p>CanSM使用ComM提供的回调函数来通知通信模式的改变。</p></li>
</ol>
</section>
<section id="id6">
<h4>状态管理功能序列图<a class="headerlink" href="#id6" title="Link to this heading"></a></h4>
<p>当CanSM接收到来自ComM的FULL_COMMUNICATION请求时，调用下层CanIf的接口来完成请求，请求完成后需要调用ComM回调进行通知。CanSM处理FULL_COMMUNICATION请求时序图如下。</p>
<p><a class="reference internal" href="../../_images/image37.png"><img alt="image3" src="../../_images/image37.png" style="width: 5.74167in; height: 6.22569in;" /></a></p>
<p>图2-2 CanSM处理FULL_COMMUNICATION请求时序图</p>
<p>当CanSM接收到来自ComM的SILENT_COMMUNICATION请求时，需要根据配置对该Can网络的多个控制器的状态进行分别处理，请求完成后需要调用ComM回调进行通知。CanSM处理SILENT_COMMUNICATION请求时序图如下。</p>
<p><a class="reference internal" href="../../_images/image43.png"><img alt="image4" src="../../_images/image43.png" style="width: 5.76736in; height: 5.0375in;" /></a></p>
<p>图2-3 CanSM处理SILENT_COMMUNICATION请求时序图</p>
<p>当CanSM接收到来自ComM的NO_COMMUNICATION请求时，调用下层CanIf的接口来完成请求，请求完成后需要调用ComM回调进行通知。CanSM处理NO_COMMUNICATION请求时序图如下。</p>
<p><a class="reference internal" href="../../_images/image54.png"><img alt="image5" src="../../_images/image54.png" style="width: 5.74792in; height: 7.86944in;" /></a>图2-4 CanSM处理NO_COMMUNICATION请求时序图</p>
</section>
<section id="id7">
<h4>状态管理功能主状态机<a class="headerlink" href="#id7" title="Link to this heading"></a></h4>
<p>上电后，CanSM会默认处于CANSM_BSM_S_NOT_INITIALIZED状态，在经过初始化后，状态将切换至CANSM_BSM_S_PRE_NOCOM。如果EcuM调用CanSM_StartWakeUpSource通知CanSM唤醒源被启动，那么状态机将切换至CANSM_BSM_WUVALIDATION状态。如果接收到ComM的FULL_COMMUNICATION请求，那么状态机将切换至CANSM_BSM_S_PRE_FULLCOM状态。在CanSM通知上层ComM和BSWM底层网络已经切换至FULL_COMMUNICATION，并且调用CanIf_SetPduMode更新PDU通道状态后，状态机将切换至CANSM_BSM_S_FULLCOM。</p>
<p>在CANSM_BSM_S_FULLCOM状态中如果接收到ComM的SILENT_COMMUNICATION请求，状态将切换至CANSM_BSM_S_SILENTCOM，或接收到ComM的NO_COMMUNICATION请求，状态将切换至CANSM_BSM_S_PRE_NOCOM。</p>
<p>在CANSM_BSM_S_FULLCOM状态中如果CanSM_SetBaudrate接口被上层调用，需要调用BswM_CanSM_CurrentState通知BSWM当前状态为CANSM_BSWM_CHANGE_BAUDRATE，状态机将切换至CANSM_BSM_S_CHANGE_BAUDRATE。</p>
<p>在CANSM_BSM_S_CHANGE_BAUDRATE中进行波特率修改的相关操作，操作结束后根据已有的ComM的网络请求状态来决定切换至哪个状态机。</p>
<p><a class="reference internal" href="../../_images/image64.png"><img alt="image6" src="../../_images/image64.png" style="width: 5.76736in; height: 7.71458in;" /></a></p>
<p>图2-5 CanSM主状态机</p>
</section>
</section>
<section id="bus-off">
<h3>Bus-off恢复功能<a class="headerlink" href="#bus-off" title="Link to this heading"></a></h3>
<p>CanSM可以配置快恢复时间CanSMBorTimeL1和慢恢复时CanSMBorTimeL2，以及经过多少次快恢复切换为慢恢复的次数CanSMBorCounterL1ToL2。当底层发生bus-off时，会调用CanSM的CanSM_ControllerBusOff函数进行通知。CanSM会调用CanIf的CanIf_SetControllerMode函数将控制器状态设置为CAN_CS_STARTED，当接收到底层调用的CanSM_ControllerModeIndication的设置成功的通知后，开始bus-off定时器的计时，当bus-off快恢复的时间超时后，调用CanIf_SetPduMode设置Pdu传输状态为CANIF_ONLINE，当快恢复的次数超过配置参数CanSMBorCounterL1ToL2时，将按照慢恢复的时间进行恢复。</p>
</section>
</section>
<section id="id8">
<h2>源文件描述<a class="headerlink" href="#id8" title="Link to this heading"></a></h2>
<p>表3-1 CanSM组件文件描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>文件</strong></p></td>
<td><p><strong>说明</strong></p></td>
</tr>
<tr class="row-even"><td><p>CanSM_Cfg.h</p></td>
<td><p>用于定义CanSM模块预编译时用到的宏。</p></td>
</tr>
<tr class="row-odd"><td><p>CanSM_Cfg.c</p></td>
<td><p>配置参数源文件，包含各个配置项的定义。</p></td>
</tr>
<tr class="row-even"><td><p>CanSM_BswM.h</p></td>
<td><p>CanSM模块提供给BswM模块使用的类型。</p></td>
</tr>
<tr class="row-odd"><td><p>CanSM_Cbk.h</p></td>
<td><p>CanSM模块提
供给CanIf,CanNm,BswM模块使用的Callback函数。</p></td>
</tr>
<tr class="row-even"><td><p>CanSM_ComM.h</p></td>
<td><p>CanSM模块提供给ComM模块使用的Callback函数。</p></td>
</tr>
<tr class="row-odd"><td><p>CanSM
_TxTimeoutException.h</p></td>
<td><p>提供给CanNm的头文件，用于调用Tx传输超时函数</p></td>
</tr>
<tr class="row-even"><td><p>CanSM_MemMap.h</p></td>
<td><p>CanSM模块函数和变量存储位置定义文件。</p></td>
</tr>
<tr class="row-odd"><td><p>CanSM.h</p></td>
<td><p>CanSM模块头文件，通
过加载该头文件访问CanSM公开的函数和数据类型</p></td>
</tr>
<tr class="row-even"><td><p>CanSM.c</p></td>
<td><p>CanSM 模块的功能实现。</p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="../../_images/image74.png"><img alt="image7" src="../../_images/image74.png" style="width: 5.76736in; height: 1.18819in;" /></a></p>
<p>图3-1 CanSM组件文件交互关系图</p>
</section>
<section id="api">
<h2>API接口<a class="headerlink" href="#api" title="Link to this heading"></a></h2>
<section id="id9">
<h3>类型定义<a class="headerlink" href="#id9" title="Link to this heading"></a></h3>
<section id="cansm-statetype">
<h4>CanSM_StateType类型定义<a class="headerlink" href="#cansm-statetype" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>名称</p></td>
<td><p>CanSM_StateType</p></td>
</tr>
<tr class="row-even"><td><p>类型</p></td>
<td><p>Enumeration</p></td>
</tr>
<tr class="row-odd"><td><p>范围</p></td>
<td><p>CANSM_UNINITED</p>
<p>CANSM_INITED</p>
</td>
</tr>
<tr class="row-even"><td><p>描述</p></td>
<td><p>定义 CanSM 模块初始化状态的值</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-configtype">
<h4>CanSM_ConfigType类型定义<a class="headerlink" href="#cansm-configtype" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>名称</p></td>
<td><p>CanSM_ConfigType</p></td>
</tr>
<tr class="row-even"><td><p>类型</p></td>
<td><p>Structure</p></td>
</tr>
<tr class="row-odd"><td><p>范围</p></td>
<td><p>–</p></td>
</tr>
<tr class="row-even"><td><p>描述</p></td>
<td><p>此类型为 CanSM 的初始化参数定义了数据结构。</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-bswmcurrentstatetype">
<h4>CanSM_BswMCurrentStateType类型定义<a class="headerlink" href="#cansm-bswmcurrentstatetype" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>名称</p></td>
<td><p>CanSM_BswMCurrentStateType</p></td>
</tr>
<tr class="row-even"><td><p>类型</p></td>
<td><p>Enumeration</p></td>
</tr>
<tr class="row-odd"><td><p>范围</p></td>
<td><p>CANSM_BSWM_NO_COMMUNICATION</p>
<p>CANSM_BSWM_SILENT_COMMUNICATION</p>
<p>CANSM_BSWM_FULL_COMMUNICATION</p>
<p>CANSM_BSWM_BUS_OFF</p>
<p>CANSM_BSWM_CHANGE_BAUDRATE</p>
</td>
</tr>
<tr class="row-even"><td><p>描述</p></td>
<td><p>定义 CanSM 模块通知给 BswM 模块通信状态的值</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="id10">
<h3>输入函数描述<a class="headerlink" href="#id10" title="Link to this heading"></a></h3>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>输入模块</strong></p></td>
<td><p><strong>API</strong></p></td>
</tr>
<tr class="row-even"><td><p>BswM</p></td>
<td><p>Bs
wM_CanSM_CurrentIcomConfiguration</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>BswM_CanSM_CurrentState</p></td>
</tr>
<tr class="row-even"><td><p>CanIf</p></td>
<td><p>CanIf_CheckTrcvWakeFlag</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>CanIf_ClearTrcvWufFlag</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>CanIf_GetPduMode</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>CanIf_GetTxConfirmationState</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>CanIf_SetControllerMode</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>CanIf_SetPduMode</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>CanIf_SetTrcvMode</p></td>
</tr>
<tr class="row-odd"><td><p>CanNm</p></td>
<td><p>CanNm_ConfirmPnAvailability</p></td>
</tr>
<tr class="row-even"><td><p>ComM</p></td>
<td><p>ComM_BusSM_ModeIndication</p></td>
</tr>
<tr class="row-odd"><td><p>Dem</p></td>
<td><p>Dem_SetEventStatus</p></td>
</tr>
<tr class="row-even"><td><p>Det</p></td>
<td><p>Det_ReportRuntimeError</p></td>
</tr>
</tbody>
</table>
</section>
<section id="id11">
<h3>静态接口函数定义<a class="headerlink" href="#id11" title="Link to this heading"></a></h3>
<section id="cansm-init">
<h4>CanSM_Init函数定义<a class="headerlink" href="#cansm-init" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_Init</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void CanSM_Init(</p>
<p>const
C
anSM_ConfigType*
ConfigPtr</p>
<p>)</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x00</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>不可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>ConfigPtr</p></td>
<td><p>值域：</p></td>
<td><p>指向初始化结构
的指针，用于CanSM的post
build参数</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>完成对CanS
M模块的初始化处理</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-deinit">
<h4>CanSM_DeInit函数定义<a class="headerlink" href="#cansm-deinit" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_DeInit</p></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void CanSM_DeInit (</p>
<p>void</p>
<p>)</p>
</td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x14</p></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>不可重入</p></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>反初始化CanSM模块</p></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-requestcommode">
<h4>CanSM_RequestComMode函数定义<a class="headerlink" href="#cansm-requestcommode" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>Can
SM_RequestComMode</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
Can
SM_RequestComMode
(
NetworkHandleType
network,
ComM_ModeType
ComM_Mode
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x02</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>非同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一网络不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>指定通信网络</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>ComM_Mode</p></td>
<td><p>值域：</p></td>
<td><p>请求的通信模式</p></td>
</tr>
<tr class="row-even"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>返回值：</p></td>
<td><p>E_OK: 服务被接受</p>
<p>E_NOT_OK:
服务被拒绝</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>功能概述：</p></td>
<td><p>将CAN网
络的通信模式更改
为请求的通信模式</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-getcurrentcommode">
<h4>CanSM_GetCurrentComMode函数定义<a class="headerlink" href="#cansm-getcurrentcommode" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p><a href="#id14"><span class="problematic" id="id15">CanSM_</span></a>
GetCurrentComMode</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
<a href="#id16"><span class="problematic" id="id17">CanSM_</span></a>
GetCurrentComMode
(
NetworkHandleType
network,
ComM_ModeType*
ComM_ModePtr
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x03</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>指定通信网络</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>ComM_ModePtr</p></td>
<td><p>值域：</p></td>
<td><p>指针，
保存当前通信模式的位置</p></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>E_OK: 服务被接受</p>
<p>E_NOT_OK:
服务被拒绝</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>获取当前
网络的通信模式。</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-startwakeupsource">
<h4>CanSM_StartWakeupSource函数定义<a class="headerlink" href="#cansm-startwakeupsource" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p><a href="#id18"><span class="problematic" id="id19">CanSM_</span></a>
StartWakeupSource</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
<a href="#id20"><span class="problematic" id="id21">CanSM_</span></a>
StartWakeupSource
(
NetworkHandleType
network
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x11</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>不可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>受影响网络</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>E_OK: 请求成功</p>
<p>E_NOT_OK:
请求被拒绝</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>当唤醒源启动时，E
cuM应该调用该函数</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-stopwakeupsource">
<h4>CanSM_StopWakeupSource函数定义<a class="headerlink" href="#cansm-stopwakeupsource" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM
_StopWakeupSource</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
CanSM
_StopWakeupSource
(
NetworkHandleType
network
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x12</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>不可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>受影响网络</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>E_OK: 请求成功</p>
<p>E_NOT_OK:
请求被拒绝</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>当唤醒源停止时，E
cuM应该调用该函数</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-getversioninfo">
<h4>CanSM_GetVersionInfo函数定义<a class="headerlink" href="#cansm-getversioninfo" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>Can
SM_GetVersionInfo</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
Can
SM_GetVersionInfo
(
<a href="#id22"><span class="problematic" id="id23">Std_</span></a>
VersionInfoType*
VersionInfo
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x01</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>versioninfo</p></td>
<td><p>值域：</p></td>
<td><p>指向存储版本信息的位置</p></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>获取版本信息</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-setbaudrate">
<h4>CanSM_SetBaudrate函数定义<a class="headerlink" href="#cansm-setbaudrate" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_SetBaudrate</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
CanSM_SetBaudrate
(
NetworkHandleType
Network,
uint16
BaudRateConfigID
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x0d</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一网络不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>需要更改波特率的网络</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>BaudRateConfigID</p></td>
<td><p>值域：</p></td>
<td><p>通过ID引用波特
率配置(见CanController
BaudRateConfigID)</p></td>
</tr>
<tr class="row-even"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>返回值：</p></td>
<td><p>E_OK:
接
受服务请求，启动
(新的)波特率设置</p>
<p>E_NOT_OK:
服务请求不被接受</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>功能概述：</p></td>
<td><p>该服务应
启动异步过程，以
更改某个CAN网络的
CAN控制器的波特率</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-setecupassive">
<h4>CanSM_SetEcuPassive函数定义<a class="headerlink" href="#cansm-setecupassive" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>Ca
nSM_SetEcuPassive</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>Std_ReturnType
Ca
nSM_SetEcuPassive
(
boolean
CanSM_Passive
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x13</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>不可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>CanSM_Passive</p></td>
<td><p>值域：</p></td>
<td><p>TRUE:将所有CanSM频
道设置为被动，即只接收</p>
<p>FALSE:将所
有CanSM通道设置为非被动</p>
</td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>E_OK: 请求被接受</p>
<p>E_NOT_OK:
请求被拒绝</p>
</td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>该功能可用于将ECU
的所有CanSM通道设
置为仅接收模式。
该模式将一直保持
，直到它被设置回
来，或者ECU被重置</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-controllerbusoff">
<h4>CanSM_ControllerBusOff函数定义<a class="headerlink" href="#cansm-controllerbusoff" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM
_ControllerBusOff</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM
_ControllerBusOff
(
uint8
ControllerId
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x04</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一网络不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>ControllerId</p></td>
<td><p>值域：</p></td>
<td><p>CAN控
制器，检测到bus-off事件</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>此
回调函数通知CanSM
有关某个CAN控制器
上的bus-off事件，
需要考虑对受影响
的CAN网络执行指定
的bus-off恢复处理</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-controllermodeindication">
<h4>CanSM_ControllerModeIndication函数定义<a class="headerlink" href="#cansm-controllermodeindication" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_Control
lerModeIndication</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_Control
lerModeIndication
(
uint8
ControllerId,
Can_Co
ntrollerStateType
ControllerMode
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x07</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同一
控制器不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>ControllerId</p></td>
<td><p>值域：</p></td>
<td><p>Can控制器Id</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>ControllerMode</p></td>
<td><p>值域：</p></td>
<td><p>通知CAN控制器模式</p></td>
</tr>
<tr class="row-even"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>功能概述：</p></td>
<td><p>该回
调应通知CanSM模块
CAN控制器模式改变</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-transceivermodeindication">
<h4>CanSM_TransceiverModeIndication函数定义<a class="headerlink" href="#cansm-transceivermodeindication" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_Transcei
verModeIndication</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_Transcei
verModeIndication
(
uint8
TransceiverId,
Can
Trcv_TrcvModeType
TransceiverMode
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x09</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一Trcv不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>TransceiverId</p></td>
<td><p>值域：</p></td>
<td><p>CAN收发器</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>TransceiverMode</p></td>
<td><p>值域：</p></td>
<td><p>收发器模式</p></td>
</tr>
<tr class="row-even"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>功能概述：</p></td>
<td><p>该回调应通
知CanSM模块CANTr
ansceiver模式改变</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-txtimeoutexception">
<h4>CanSM_TxTimeoutException函数定义<a class="headerlink" href="#cansm-txtimeoutexception" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_T
xTimeoutException</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_T
xTimeoutException
(
NetworkHandleType
Channel
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x0b</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>Channel</p></td>
<td><p>值域：</p></td>
<td><p>影响网络</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>该功能应通知
CanSM模块CanNm已
经为受影响的部分
CAN网络检测到tx超
时异常，该异常应
在CanSM模块的相应
网络状态机中恢复</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-cleartrcvwufflagindication">
<h4>CanSM_ClearTrcvWufFlagIndication函数定义<a class="headerlink" href="#cansm-cleartrcvwufflagindication" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_ClearTrcv
WufFlagIndication</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_ClearTrcv
WufFlagIndication
(
uint8 Transceiver
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x08</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一Trcv不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>Transceiver</p></td>
<td><p>值域：</p></td>
<td><p>请求的收发器</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>该回调函
数应指示所通知的
CAN收发器的CanIf
_ClearTrcvWufFlag
API进程结束。</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-checktransceiverwakeflagindication">
<h4>CanSM_CheckTransceiverWakeFlagIndication函数定义<a class="headerlink" href="#cansm-checktransceiverwakeflagindication" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p><a href="#id24"><span class="problematic" id="id25">CanSM_</span></a>
CheckTransceiverW
akeFlagIndication</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
<a href="#id26"><span class="problematic" id="id27">CanSM_</span></a>
CheckTransceiverW
akeFlagIndication
(
uint8 Transceiver
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x0a</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一Trcv不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>Transceiver</p></td>
<td><p>值域：</p></td>
<td><p>请求的收发器</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>该回调函
数应指示所通知的
<a href="#id28"><span class="problematic" id="id29">CAN收发器的CanIf_</span></a>
CheckTrcvWakeFlag
API进程结束。</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-confirmpnavailability">
<h4>CanSM_ConfirmPnAvailability函数定义<a class="headerlink" href="#cansm-confirmpnavailability" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_Conf
irmPnAvailability</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_Conf
irmPnAvailability
(
uint8
TransceiverId
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x06</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>TransceiverId</p></td>
<td><p>值域：</p></td>
<td><p>收发器Id</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>此回调函
数表明收发器正在
PN通信模式下运行</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-currenticomconfiguration">
<h4>CanSM_CurrentIcomConfiguration函数定义<a class="headerlink" href="#cansm-currenticomconfiguration" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_Current
IcomConfiguration</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
CanSM_Current
IcomConfiguration
(
uint8
ControllerId,
IcomConfigIdType
ConfigurationId,
Ico
mSwitch_ErrorType
Error
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x10</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（同
一网络不可重入）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>ControllerId</p></td>
<td><p>值域：</p></td>
<td><p>Can控制器ID</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>ConfigurationId</p></td>
<td><p>值域：</p></td>
<td><p>改变配置Id</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Error</p></td>
<td><p>值域：</p></td>
<td><p>ICOM_SWITC
H_E_OK：无错误ICOM_SWIT
CH_E_FAILED：切换到请求
的配置失败。严重错误。</p></td>
</tr>
<tr class="row-odd"><td><p>输
入输出参数:</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>该服务
将通知有关CAN网络
的Icom配置的更改</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansm-mainfunction">
<h4>CanSM_MainFunction函数定义<a class="headerlink" href="#cansm-mainfunction" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>CanSM_MainFunction</p></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void CanSM_MainFunction (
void
)</p></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>0x05</p></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>CanSM的周期功能</p></td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="id12">
<h3>可配置函数定义<a class="headerlink" href="#id12" title="Link to this heading"></a></h3>
<section id="user-getbusoffdelay">
<h4>&lt;User_GetBusOffDelay&gt;函数定义<a class="headerlink" href="#user-getbusoffdelay" title="Link to this heading"></a></h4>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p>函数名称：</p></td>
<td><p>&lt;Use
r_GetBusOffDelay&gt;</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>函数原型：</p></td>
<td><p>void
&lt;Use
r_GetBusOffDelay&gt;
(
NetworkHandleType
network,
uint8*
delayCyclesPtr
)</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>服务编号：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>同步/异步：</p></td>
<td><p>同步</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>是
否可重入：</p></td>
<td><p>可重入（仅
对于不同的网络）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输入参数：</p></td>
<td><p>network</p></td>
<td><p>值域：</p></td>
<td><p>发生 BusOff 的 CAN
网络。</p></td>
</tr>
<tr class="row-odd"><td><p>输入
输出参数：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>输出参数：</p></td>
<td><p>delayCyclesPtr</p></td>
<td><p>值域：</p></td>
<td><p>发生 BusOff 后，在
L1/L2 之外等待的 CanSM
基本周期数。</p></td>
</tr>
<tr class="row-odd"><td><p>返回值：</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>功能概述：</p></td>
<td><p>在发生 BusOff
后，此调用函
数返回要额外等待
L1/L2 的 CanSM
基本周期数。</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
<section id="id13">
<h2>配置<a class="headerlink" href="#id13" title="Link to this heading"></a></h2>
<section id="cansmgeneral">
<h3>CanSMGeneral<a class="headerlink" href="#cansmgeneral" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="../../_images/image84.png"><img alt="image8" src="../../_images/image84.png" style="width: 3.66667in; height: 2.725in;" /></a></p>
<p>图5-1 CanSMGeneral容器配置图</p>
<p>表5‑1 CanSMGeneral属性描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>UI
名称</strong></p></td>
<td><p><strong>描述</strong></p></td>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>C
anSMDe
vError
Detect</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td><p>F
A
L
S
E</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>打开
或关闭默认错误跟踪器
(Det) 检测和通知。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Can
SMGetB
usOffD
elayFu
nction</p></td>
<td><p>取值范围</p></td>
<td><p>FunctionName</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td colspan="2"><dl>
<dt>无 |</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>该参
数配置&lt;User_GetBusOf
fDelay&gt;调用函数的名称
，CanSM使用该函数获取
额外的L1/L2延迟时间。
此函数仅在C
anSMEnableBusOffDelay
已启用的通道中调用。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>C
anSMGe
tBusOf
fDelay
Header</p></td>
<td><p>取值范围</p></td>
<td><p>String</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td colspan="2"><dl>
<dt>无 |</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>此参数配置包含
&lt;User_GetBusOffDelay&gt;
call
out函数原型的头文件。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Can
SMMain
Functi
onTime
Period</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. INF</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td colspan="2"><dl>
<dt>无 |</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>该参
数以秒为单位定义函数
CanSM_MainFunction
的循环时间</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Can
SMPncS
upport</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td><p>F
A
L
S
E</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>启用或
禁用对PN网络的支持。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>只有在 ComM 中启用了
ComMPncSupport
时，此参数才可用</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>C
anSMSe
tBaudr
ateApi</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td><p>F
A
L
S
E</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>Can_SetBaudrate API
的支持是可选的。
如果此参数设置为
true，则应支持
Can_SetBaudrate API。
否则不支持 API。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Can
SMTxOf
flineA
ctiveS
upport</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td colspan="2"><dl>
<dt>无 |</dt><dd><div class="line-block">
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
<div class="line"><br /></div>
</div>
</dd>
</dl>
</td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>确定 CanSM 是否支持
ECU 被动功能。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖CanIfT
xOfflineActiveSupport</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>C
anSMVe
rsionI
nfoApi</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td colspan="2"><p>默 |
认 |
取 |
值 |</p>
<blockquote>
<div><div class="line-block">
<div class="line"><br /></div>
</div>
</div></blockquote>
</td>
<td><p>F
A
L
S
E</p></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>使能版本信息API
(Ca
nSM_GetVersionInfo)。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CanSMM
ultipl
eContr
ollerS
upport</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td></td>
<td><p>默认取值</p></td>
<td></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>开启/关闭网
络多控制器分配功能。</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansmconfiguration">
<h3>CanSMConfiguration<a class="headerlink" href="#cansmconfiguration" title="Link to this heading"></a></h3>
<p><a class="reference internal" href="../../_images/image94.png"><img alt="image9" src="../../_images/image94.png" style="width: 3.58333in; height: 0.67639in;" /></a></p>
<p>图5-2 CanSMConfiguration容器配置图</p>
<p>表5‑2 CanSMConfiguration属性描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>UI
名称</strong></p></td>
<td><p><strong>描述</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CanSM
ModeRe
questR
epetit
ionMax</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 255</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>没有来自 CanIf
模块的相应模
式指示，指定模式请求
重复的最大数量，直到
CanSM 模块向 Det
报告开发错误并
尝试返回无通信状态。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CanSMM
odeReq
uestRe
petiti
onTime</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 65.535</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>通过使用 CanIf 模块的
API，指定 CanSM
模块应在多长时间
内重复模式更改请求。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<section id="cansmmanagernetwork">
<h4>CanSMManagerNetwork<a class="headerlink" href="#cansmmanagernetwork" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="../../_images/image104.png"><img alt="image10" src="../../_images/image104.png" style="width: 3.79167in; height: 1.7125in;" /></a></p>
<p>图5-3 CanSMManagerNetwork容器配置图</p>
<p>表5‑3 CanSMManagerNetwork属性描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>UI
名称</strong></p></td>
<td><p><strong>描述</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Can
SMBorC
ounter
L1ToL2</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 255</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>该阈
值定义了bus-off计数，
直到bus-off恢复从级别
1（快
恢复时间）切换到级别
2（慢恢复时间）。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Ca
nSMBor
TimeL1</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 65.535</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>该时间参数
以秒为单位定义了级别
1
中bus-off恢复时间的持
续时间（快恢复时间）</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>Ca
nSMBor
TimeL2</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 65.535</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>该时间参数
以秒为单位定义了级别
2（
慢恢复时间）中bus-of
f恢复时间的持续时间。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>Can
SMBorT
imeTxE
nsured</p></td>
<td><p>取值范围</p></td>
<td><p>0 .. 65.535</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>该参数以秒为单
位定义bus-off事件检查
的持续时间。该检查评
估在恢复重新启用传输
路径后恢复是否成功。
如果在此时间段内发
生新的bus-off，CanSM
会将此bus-off评估为顺
序总线关闭，而没有成
功恢复。因为只能检测
到bus-off，所以在传输
PDU
时，时间必须
足够长以确保再次传输
PDU（例如，COM
模块的最快循环传输
PDU 的时间段 /
ComTxMod
eTimePeriodFactor）。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>CanSMBorTxConf
irmationPolling不使能</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CanSM
BorTxC
onfirm
ationP
olling</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>如果 CanSM 轮询
CanIf_G
etTxConfirmationState
API
来决
定要恢复的bus-off状态
，而不是为此决定使用
CanSMBorTimeTxEnsured
参数，
则该参数应进行配置。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CanS
MEnabl
eBusOf
fDelay</p></td>
<td><p>取值范围</p></td>
<td><p>TRUE,FALSE</p></td>
<td><p>默认取值</p></td>
<td><p>FALSE</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>此参数定
义是否应为此网络调用
&lt;U
ser_GetBusOffDelay&gt;。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>无</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>C
anSMCo
mMNetw
orkHan
dleRef</p></td>
<td><p>取值范围</p></td>
<td><p>reference to [
ComMChannel ]</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>唯一
的ID来识别一个特定的
CAN 网络。 引用为
ComM
配置的网络ID之一。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖ComMChannel</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CanSMT
ransce
iverId</p></td>
<td><p>取值范围</p></td>
<td><p>reference to [
CanIfTrcvCfg ]</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>分配给配置的网络的
CAN 收发器的
ID。引用CanIf
模
块管理的收发器之一。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖CanIfTrcvCfg</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansmcontroller">
<h4>CanSMController<a class="headerlink" href="#cansmcontroller" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="../../_images/image118.png"><img alt="image11" src="../../_images/image118.png" style="width: 4.77986in; height: 0.64653in;" /></a></p>
<p>图5-4 CanSMController容器配置图</p>
<p>表5‑4 CanSMController属性描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>UI
名称</strong></p></td>
<td><p><strong>描述</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CanSM
Contro
llerId</p></td>
<td><p>取值范围</p></td>
<td><p>reference to
[CanIfCtrlCfg]</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>分配给配置的网络的
CAN 控制器的
ID。引用CanIf
模
块管理的控制器之一。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖 CanIfCtrlCfg</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
<section id="cansmdemeventparameterrefs">
<h4>CanSMDemEventParameterRefs<a class="headerlink" href="#cansmdemeventparameterrefs" title="Link to this heading"></a></h4>
<p><a class="reference internal" href="../../_images/image124.png"><img alt="image12" src="../../_images/image124.png" style="width: 5.09514in; height: 0.76319in;" /></a></p>
<p>图5-4 3CanSMDemEventParameterRefs容器配置图</p>
<p>表5‑4 3CanSMDemEventParameterRefs属性描述</p>
<table class="docutils align-default">
<tbody>
<tr class="row-odd"><td><p><strong>UI
名称</strong></p></td>
<td><p><strong>描述</strong></p></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td><p>CAN
SM_E_B
US_OFF</p></td>
<td><p>取值范围</p></td>
<td><p>reference to
[DemEventParameter]</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>参数描述</p></td>
<td><p>引用已经配置的Dem事件
用来报告BUSOFF错误。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-even"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖
DemEventParameter</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td><p>CANS
M_E_MO
DE_REQ
UEST_T
IMEOUT</p></td>
<td><p>取值范围</p></td>
<td><p>reference to
[DemEventParameter]</p></td>
<td><p>默认取值</p></td>
<td><p>无</p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>参数描述</p></td>
<td><p>引用已经配置的Dem事件
用来报告对控制器或收
发器控制的超时错误。</p></td>
<td></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>依赖关系</p></td>
<td><p>依赖
DemEventParameter</p></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
</section>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="CanNm.html" class="btn btn-neutral float-left" title="CanNm产品参考手册" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="CanTp.html" class="btn btn-neutral float-right" title="CanTp产品参考手册" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, i-soft.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>